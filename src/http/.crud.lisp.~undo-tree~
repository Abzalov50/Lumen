(undo-tree-save-format-version . 1)
"ab83f71b22c8a979f6f9ffa36819e067b43f78ea"
[nil nil nil nil (26805 19171 263491 0) 0 nil]
([nil nil ((nil rear-nonsticky nil 12684 . 12685) (nil fontified nil 1 . 12685) (1 . 12685) (t . -1)) nil (26805 19171 263490 0) 0 nil])
([nil nil ((427 . 429) (#(" " 0 1 (fontified nil)) . 427) (426 . 427)) nil (26805 19171 263489 0) 0 nil])
([nil nil ((#("
                               " 0 1 (fontified t) 1 32 (fontified t)) . -460) (undo-tree-id0 . -32) 492) nil (26805 19171 263488 0) 0 nil])
([nil nil ((494 . 496) (#(" " 0 1 (fontified nil)) . 494) (493 . 494)) nil (26805 19171 263474 0) 0 nil])
([nil nil ((603 . 605) (601 . 602)) nil (26805 19171 263471 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 2193 . 2194) (nil fontified nil 1032 . 2194) (1032 . 2194) (t 26805 19171 0 0)) nil (26805 19649 117139 0) 0 nil])
([nil nil ((#("(respond-json ctx (first row))" 0 30 (fontified t)) . -10962) (undo-tree-id11 . -30) 10992) nil (26805 19649 117138 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 11340 . 11341) (nil fontified nil 10962 . 11341) (10962 . 11341)) nil (26805 19649 117137 0) 0 nil])
([nil nil ((11317 . 11326) (#("                   " 0 19 (fontified t)) . 11317) (11285 . 11294) (11199 . 11205) (#("    " 0 4 (fontified t)) . 11199) (11183 . 11187) (#("  " 0 2 (fontified t)) . 11183) (11121 . 11127) (#("    " 0 4 (fontified t)) . 11121) (11106 . 11110) (#("  " 0 2 (fontified t)) . 11106) (11017 . 11026) (#("       " 0 7 (fontified t)) . 11017) (10941 . 10950) (#("       " 0 7 (fontified t)) . 10941) (10907 . 10916) (#("                   " 0 19 (fontified t)) . 10907) (undo-tree-id10 . -19) (10876 . 10881) (#("               " 0 15 (fontified t)) . 10876) (10808 . 10818) (#("                    " 0 20 (fontified t)) . 10808) (10770 . 10773) (#("             " 0 13 (fontified t)) . 10770) (10743 . 10751) (#("           " 0 11 (fontified t)) . 10743) (10722 . 10730) (#("           " 0 11 (fontified t)) . 10722) 10703) nil (26805 19649 117135 0) 0 nil])
([nil nil ((#(")" 0 1 (fontified t)) . -10656) (undo-tree-id9 . -1) 10657) nil (26805 19649 117132 0) 0 nil])
([nil nil ((#("	      " 0 7 (fontified nil)) . -11311) (11311 . 11312) (#("	" 0 1 (fontified nil)) . 11311) (11308 . 11311) (#("	      " 0 7 (fontified nil)) . -11283) (11283 . 11284) (#("	" 0 1 (fontified nil)) . 11283) (11280 . 11283) (#("		  " 0 4 (fontified nil)) . -11198) (11198 . 11199) (#("	" 0 1 (fontified nil)) . 11198) (11191 . 11198) (#("		" 0 2 (fontified nil)) . -11177) (11177 . 11178) (#("	" 0 1 (fontified nil)) . 11177) (11172 . 11177) (#("		  " 0 4 (fontified nil)) . -11114) (11114 . 11115) (#("	" 0 1 (fontified nil)) . 11114) (11107 . 11114) (#("		" 0 2 (fontified nil)) . -11094) (11094 . 11095) (#("	" 0 1 (fontified nil)) . 11094) (11089 . 11094) (#("	     " 0 6 (fontified nil)) . -11007) (11007 . 11008) (#("	" 0 1 (fontified nil)) . 11007) (11005 . 11007) (#("	     " 0 6 (fontified nil)) . -10935) (10935 . 10936) (#("	" 0 1 (fontified nil)) . 10935) (10933 . 10935) (#("	      " 0 7 (fontified nil)) . -10905) (10905 . 10906) (#("	" 0 1 (fontified nil)) . 10905) (10902 . 10905) (#("		  " 0 4 (fontified nil)) . -10874) (10874 . 10875) (#("	" 0 1 (fontified nil)) . 10874) (10867 . 10874) (#("	       " 0 8 (fontified nil)) . -10808) (10808 . 10809) (#("	" 0 1 (fontified nil)) . 10808) (10804 . 10808) (#("		" 0 2 (fontified nil)) . -10767) (10767 . 10768) (#("	" 0 1 (fontified nil)) . 10767) (10762 . 10767) (#("	      " 0 7 (fontified nil)) . -10742) (10742 . 10743) (#("	" 0 1 (fontified nil)) . 10742) (10739 . 10742) (#("	      " 0 7 (fontified nil)) . -10725) (10725 . 10726) (#("	" 0 1 (fontified nil)) . 10725) (10722 . 10725) 10702) nil (26805 19649 117129 0) 0 nil])
([nil nil ((5709 . 5711)) nil (26805 19649 117124 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 6873 . 6874) (nil fontified nil 5711 . 6874) (5711 . 6874)) nil (26805 19649 117124 0) 0 nil])
([nil nil ((#("
" 0 1 (rear-nonsticky t fontified t)) . -6873) (undo-tree-id8 . -1) 6874) nil (26805 19649 117123 0) 0 nil])
([nil nil ((13478 . 13484)) nil (26805 19649 117122 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 13664 . 13665) (nil fontified nil 13484 . 13665) (13484 . 13665)) nil (26805 19649 117121 0) 0 nil])
([nil nil ((#("(first row)" 0 11 (fontified t)) . -13717) (undo-tree-id7 . -11) 13728) nil (26805 19649 117120 0) 0 nil])
([nil nil ((13717 . 13720)) nil (26805 19649 117119 0) 0 nil])
([nil nil ((#("(multiple-value-bind (n ent2)
                         (entity-update! ent :patch t :returning t)
                       (declare (ignore n))
                       (respond-json ctx ent2))" 0 1 (fontified t) 1 20 (face font-lock-keyword-face fontified t) 20 27 (fontified t) 27 30 (fontified t) 30 68 (fontified t) 68 75 (fontified t) 75 81 (face font-lock-builtin-face fontified t) 81 84 (fontified t) 84 94 (face font-lock-builtin-face fontified t) 94 98 (fontified t) 98 122 (fontified t) 122 129 (face font-lock-keyword-face fontified t) 129 189 (fontified t)) . -14108) (undo-tree-id6 . -189) 14297) nil (26805 19649 117119 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 14809 . 14810) (nil fontified nil 14108 . 14810) (14108 . 14810)) nil (26805 19649 117115 0) 0 nil])
([nil nil ((#(")" 0 1 (fontified t)) . -14814) (undo-tree-id5 . -1) 14815) nil (26805 19649 117114 0) 0 nil])
([nil nil ((14608 . 14612) (#("            " 0 12 (fontified t)) . 14608) (14510 . 14516) (#("              " 0 14 (fontified t)) . 14510) (14437 . 14443) (#("              " 0 14 (fontified t)) . 14437) (14352 . 14356) (#("                   " 0 19 (fontified t)) . 14352) (14280 . 14284) (#("                   " 0 19 (fontified t)) . 14280) (14175 . 14179) (#("            " 0 12 (fontified t)) . 14175) (14126 . 14130) (#("            " 0 12 (fontified t)) . 14126) (14101 . 14105) (#("            " 0 12 (fontified t)) . 14101) (14052 . 14058) (#("              " 0 14 (fontified t)) . 14052) (14020 . 14022) (13974 . 13976) (13916 . 13918) (13847 . 13851) (#("                              " 0 30 (fontified t)) . 13847) (13828 . 13832) (#("                              " 0 30 (fontified t)) . 13828) (13802 . 13806) (#("                       " 0 23 (fontified t)) . 13802) (13779 . 13781) (13720 . 13722) (13658 . 13660) (13579 . 13588) (#("                                   " 0 35 (fontified t)) . 13579) (13510 . 13517) (#("        " 0 8 (fontified t)) . 13510) 13173) nil (26805 19649 117111 0) 0 nil])
([nil nil ((13613 . 13622) (#(" " 0 1 (fontified nil)) . 13613) (13612 . 13613)) nil (26805 19649 117107 0) 0 nil])
([nil nil ((14322 . 14333) (#(" " 0 1 (fontified nil)) . 14321) (undo-tree-id4 . -1) (14322 . 14323)) nil (26805 19649 117205 0) 0 nil])
([nil nil ((14399 . 14404) (#(" " 0 1 (fontified nil)) . 14398) (undo-tree-id18 . -1) (14399 . 14400)) nil (26805 32724 286442 0) 0 nil] [nil nil ((14404 . 14417) (#(" " 0 1 (fontified nil)) . 14403) (undo-tree-id1 . -1) (undo-tree-id2 . -1) (undo-tree-id3 . -1) (14404 . 14405)) ((#("
" 0 1 (fontified nil)) . 14404) (undo-tree-id12 . -1) (undo-tree-id13 . -1) (14403 . 14404) (#("						       " 0 13 (fontified t)) . 14404) (undo-tree-id14 . -13)) (26805 19649 117102 0) 0 nil])
([nil nil ((14434 . 14444) (#(" " 0 1 (fontified nil)) . 14433) (undo-tree-id17 . -1) (14434 . 14435)) nil (26805 32724 286441 0) 0 nil])
nil
([nil nil ((14594 . 14606) (#(" " 0 1 (fontified nil)) . 14593) (undo-tree-id16 . -1) (14594 . 14595)) nil (26805 32724 286439 0) 0 nil])
([nil nil ((14633 . 14643) (#(" " 0 1 (fontified nil)) . 14633) (14632 . 14633)) nil (26805 32724 286437 0) 0 nil])
([nil nil ((12223 . 12234) (#(" " 0 1 (fontified nil)) . 12223) (12222 . 12223)) nil (26805 32724 286436 0) 0 nil])
([nil nil ((12150 . 12163) (#(" " 0 1 (fontified nil)) . 12150) (12149 . 12150)) nil (26805 32724 286435 0) 0 nil])
([nil nil ((13117 . 13123)) nil (26805 32724 286435 0) 0 nil])
([nil nil ((12444 . 12452) (#(" " 0 1 (fontified nil)) . 12444) (12443 . 12444)) nil (26805 32724 286434 0) 0 nil])
([nil nil ((14576 . 14585) (#(" " 0 1 (fontified nil)) . 14576) (14575 . 14576)) nil (26805 32724 286433 0) 0 nil])
([nil nil ((15232 . 15235)) nil (26805 32724 286433 0) 0 nil])
([nil nil ((#("(let* ((sid (path-param ctx \"id\"))
                    (row (select* table :filters (list '= pk sid) :limit 1)))
               (if (null row)
                   (respond-404 ctx)
                   (let ((ent (row->entity entity (first row))))
                     (entity-delete! ent)
                     (respond-json ctx (list :deleted t :id sid)))))" 0 1 (fontified t) 1 5 (face font-lock-keyword-face fontified t) 5 28 (fontified t) 28 32 (face font-lock-string-face fontified t) 32 75 (fontified t) 75 83 (face font-lock-builtin-face fontified t) 83 101 (fontified t) 101 107 (face font-lock-builtin-face fontified t) 107 129 (fontified t) 129 131 (face font-lock-keyword-face fontified t) 131 198 (fontified t) 198 200 (fontified t) 200 203 (face font-lock-keyword-face fontified t) 203 245 (fontified t) 245 287 (fontified t) 287 332 (fontified t) 332 340 (face font-lock-builtin-face fontified t) 340 343 (fontified t) 343 346 (face font-lock-builtin-face fontified t) 346 355 (fontified t)) . -14875) (undo-tree-id15 . -355) 15230) nil (26805 32724 286432 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 15328 . 15329) (nil fontified nil 14875 . 15329) (14875 . 15329)) nil (26805 32724 286422 0) 0 nil])
([nil nil ((15331 . 15334)) nil (26805 32724 286421 0) 0 nil])
([nil nil ((15249 . 15258) (#("          " 0 10 (fontified t)) . 15249) (15219 . 15228) (#("          " 0 10 (fontified t)) . 15219) (15174 . 15181) (#("        " 0 8 (fontified t)) . 15174) (15114 . 15123) (#("                                   " 0 35 (fontified t)) . 15114) (15045 . 15052) (#("        " 0 8 (fontified t)) . 15045) (15015 . 15020) (#("      " 0 6 (fontified t)) . 15015) (14974 . 14982) (#("  " 0 2 (fontified t)) . 14974) (14910 . 14916) (#("       " 0 7 (fontified t)) . 14910) 14794) nil (26805 32724 286419 0) 0 nil])
([nil nil ((15148 . 15157) (#(" " 0 1 (fontified nil)) . 15148) (15147 . 15148)) nil (26805 32724 286412 0) 0 nil])
([nil nil ((171 . 176) (t 26805 32724 0 0)) nil (26805 32925 2416 0) 0 nil])
([nil nil ((276 . 281)) nil (26805 32925 2415 0) 0 nil])
([nil nil ((#(" " 0 1 (fontified t)) . -313) (undo-tree-id23 . -1) (#(" " 0 1 (fontified t)) . -314) (undo-tree-id24 . -1) (#(" " 0 1 (fontified t)) . -315) (undo-tree-id25 . -1) (#(" " 0 1 (fontified t)) . -316) (undo-tree-id26 . -1) (#(" " 0 1 (fontified t)) . -317) (undo-tree-id27 . -1) (#(" " 0 1 (fontified t)) . -318) (undo-tree-id28 . -1) 319) nil (26805 32925 2414 0) 0 nil])
([nil nil ((#("user" 0 4 (face font-lock-builtin-face fontified t)) . -47) (undo-tree-id22 . -4) 51) nil (26805 32925 2407 0) 0 nil])
([nil nil ((#("-" 0 1 (face font-lock-builtin-face fontified t)) . -46) (undo-tree-id20 . -1) (undo-tree-id21 . -1) 47) nil (26805 32925 2406 0) 0 nil])
([nil nil ((47 . 48)) nil (26805 32925 2403 0) 0 nil])
([nil nil ((#("*" 0 1 (fontified t)) . -47) (undo-tree-id19 . -1) 48) nil (26805 32925 2402 0) 0 nil])
([nil nil ((47 . 48)) nil (26805 32925 2391 0) 0 nil])
([nil nil ((775 . 776)) nil (26805 32925 2388 0) 0 nil])
([nil nil ((#(":respond-400" 0 12 (face font-lock-builtin-face fontified t)) . -209) (undo-tree-id43 . -12) 221 (t 26805 32924 0 0)) nil (26805 33893 313482 0) 0 nil])
([nil nil ((#(" " 0 1 (fontified t)) . -208) (undo-tree-id41 . -1) (undo-tree-id42 . -1) 209) nil (26805 33893 313481 0) 0 nil])
([nil nil ((#(" " 0 1 (fontified t)) . -177) (undo-tree-id36 . -1) (#(" " 0 1 (fontified t)) . -178) (undo-tree-id37 . -1) (#(" " 0 1 (fontified t)) . -179) (undo-tree-id38 . -1) (#(" " 0 1 (fontified t)) . -180) (undo-tree-id39 . -1) (#(" " 0 1 (fontified t)) . -181) (undo-tree-id40 . -1) 182) nil (26805 33893 313478 0) 0 nil])
([nil nil ((177 . 178)) nil (26805 33893 313475 0) 0 nil])
([nil nil ((#(" " 0 1 (fontified t)) . -266) (undo-tree-id32 . -1) (#(" " 0 1 (fontified t)) . -267) (undo-tree-id33 . -1) (#(" " 0 1 (fontified t)) . -268) (undo-tree-id34 . -1) (#(" " 0 1 (fontified t)) . -269) (undo-tree-id35 . -1) 270) nil (26805 33893 313473 0) 0 nil])
([nil nil ((#("ctx" 0 3 (fontified t)) . -8178) (undo-tree-id31 . -3) 8181) nil (26805 33893 313469 0) 0 nil])
([nil nil ((#(" " 0 1 (fontified t)) . -8177) (undo-tree-id29 . -1) (undo-tree-id30 . -1) 8178) nil (26805 34440 193177 0) 0 nil])
([nil nil ((#("ctx" 0 3 (fontified t)) . -10722) (undo-tree-id53 . -3) 10725 (t 26805 33893 0 0)) nil (26805 34538 890632 0) 0 nil] [nil nil ((#("(respond-json ctx res)" 0 22 (fontified t)) . -10708) (undo-tree-id44 . -22) (undo-tree-id45 . -22) (undo-tree-id46 . -22) 10730 (t 26805 33893 0 0)) ((10708 . 10730)) (26805 34439 529664 0) 0 nil])
([nil nil ((#(" " 0 1 (fontified t)) . -10721) (undo-tree-id51 . -1) (undo-tree-id52 . -1) 10722) nil (26805 34538 890630 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 10878 . 10879) (nil fontified nil 10708 . 10879) (10708 . 10879)) ((#("(respond-json (list :items items
                               :total total :page page :page-size page-size
                               :order order :filters filters))" 0 20 (fontified nil) 20 26 (face font-lock-builtin-face fontified nil) 26 64 (fontified nil) 64 70 (face font-lock-builtin-face fontified nil) 70 77 (fontified nil) 77 82 (face font-lock-builtin-face fontified nil) 82 88 (fontified nil) 88 98 (face font-lock-builtin-face fontified nil) 98 109 (fontified nil) 109 140 (fontified nil) 140 146 (face font-lock-builtin-face fontified nil) 146 153 (fontified nil) 153 161 (face font-lock-builtin-face fontified nil) 161 170 (fontified nil) 170 171 (rear-nonsticky nil fontified nil)) . 10708) (undo-tree-id47 . -109) (nil fontified t 10806 . 10817) (nil fontified t 10796 . 10806) (nil fontified t 10790 . 10796) (nil fontified t 10785 . 10790) (nil fontified t 10778 . 10785) (nil fontified t 10772 . 10778) (nil fontified t 10734 . 10772) (nil fontified t 10728 . 10734) (nil fontified t 10708 . 10728) (nil rear-nonsticky t 10878 . 10879)) (26805 34439 529576 0) 0 nil])
([nil nil ((#("(respond-json ctx
                                  (list :items items
                                        :total total :page page :page-size page-size
                                        :order order :filters filters))" 0 58 (fontified t) 58 64 (face font-lock-builtin-face fontified t) 64 111 (fontified t) 111 117 (face font-lock-builtin-face fontified t) 117 124 (fontified t) 124 129 (face font-lock-builtin-face fontified t) 129 135 (fontified t) 135 145 (face font-lock-builtin-face fontified t) 145 156 (fontified t) 156 196 (fontified t) 196 202 (face font-lock-builtin-face fontified t) 202 209 (fontified t) 209 217 (face font-lock-builtin-face fontified t) 217 227 (fontified t)) . -11560) (undo-tree-id50 . -227) 11787) nil (26805 34538 890629 0) 0 nil])
nil
([nil nil ((nil rear-nonsticky nil 11730 . 11731) (nil fontified nil 11560 . 11731) (11560 . 11731)) nil (26805 34538 890627 0) 0 nil])
([nil nil ((#(")" 0 1 (fontified t)) . -11735) (undo-tree-id49 . -1) 11736) nil (26805 34538 890627 0) 0 nil])
([nil nil ((11735 . 11736)) nil (26805 34538 890625 0) 0 nil])
([nil nil ((#("(guard! ctx)
	   (with-params (ctx)
	     (let* ((sid (path-param ctx \"id\"))
		    (row (select* table :filters (list '= pk sid) :limit 1)))
	       (if (and row (first row))
		   (let* ((one (first row))
			  (etag (%strong-etag-from-row one :lock-version-col
						       :LOCK-VERSION))
			  (lm-ut (%row-timestamp one :updated-col :UPDATED-AT
						     :created-col :CREATED-AT)))
		     (when etag
		       (setf (gethash \"ETag\" (slot-value ctx 'headers)) etag))
		     (when lm-ut
		       (setf (gethash \"Last-Modified\" (slot-value ctx 'headers))
			     (%http-date lm-ut))))
		   (respond-json ctx one)
		   (respond-404 ctx))))" 0 13 (fontified t) 13 17 (fontified t) 17 18 (fontified t) 18 29 (face font-lock-keyword-face fontified t) 29 36 (fontified t) 36 42 (fontified t) 42 43 (fontified t) 43 47 (face font-lock-keyword-face fontified t) 47 70 (fontified t) 70 74 (face font-lock-string-face fontified t) 74 77 (fontified t) 77 83 (fontified t) 83 86 (fontified t) 86 103 (fontified t) 103 111 (face font-lock-builtin-face fontified t) 111 129 (fontified t) 129 135 (face font-lock-builtin-face fontified t) 135 141 (fontified t) 141 149 (fontified t) 149 150 (fontified t) 150 152 (face font-lock-keyword-face fontified t) 152 175 (fontified t) 175 180 (fontified t) 180 181 (fontified t) 181 185 (face font-lock-keyword-face fontified t) 185 205 (fontified t) 205 210 (fontified t) 210 243 (fontified t) 243 260 (face font-lock-builtin-face fontified t) 260 274 (fontified t) 274 287 (face font-lock-builtin-face fontified t) 287 290 (fontified t) 290 295 (fontified t) 295 322 (fontified t) 322 334 (face font-lock-builtin-face fontified t) 334 335 (fontified t) 335 346 (face font-lock-builtin-face fontified t) 346 358 (fontified t) 358 368 (face font-lock-builtin-face fontified t) 368 370 (face font-lock-builtin-face fontified t) 370 371 (fontified t) 371 382 (face font-lock-builtin-face fontified t) 382 386 (fontified t) 386 393 (fontified t) 393 394 (fontified t) 394 398 (face font-lock-keyword-face fontified t) 398 404 (fontified t) 404 413 (fontified t) 413 428 (fontified t) 428 434 (face font-lock-string-face fontified t) 434 469 (fontified t) 469 476 (fontified t) 476 477 (fontified t) 477 481 (face font-lock-keyword-face fontified t) 481 488 (fontified t) 488 497 (fontified t) 497 512 (fontified t) 512 527 (face font-lock-string-face fontified t) 527 585 (fontified t) 585 590 (fontified t) 590 611 (fontified t) 611 612 (fontified t rear-nonsticky t) 612 613 (fontified t) 613 615 (fontified t) 615 618 (fontified t) 618 638 (fontified t)) . -11805) (undo-tree-id48 . -638) 12443) nil (26805 34538 890625 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 12461 . 12462) (nil fontified nil 11805 . 12462) (11805 . 12462)) nil (26805 34538 890614 0) 0 nil])
([nil nil ((12463 . 12465)) nil (26805 34538 890614 0) 0 nil])
([nil nil ((12340 . 12345) (#("          " 0 10 (fontified t)) . 12340) (12299 . 12306) (#("            " 0 12 (fontified t)) . 12299) (12230 . 12241) (#("                                     " 0 37 (fontified t)) . 12230) (12189 . 12194) (#("                               " 0 31 (fontified t)) . 12189) (12166 . 12171) (#("                 " 0 17 (fontified t)) . 12166) (12082 . 12087) (#("                 " 0 17 (fontified t)) . 12082) (12010 . 12015) (#("                 " 0 17 (fontified t)) . 12010) (11980 . 11985) (#("          " 0 10 (fontified t)) . 11980) (11946 . 11954) (#("      " 0 6 (fontified t)) . 11946) (11882 . 11888) (#("           " 0 11 (fontified t)) . 11882) (11841 . 11847) (#("    " 0 4 (fontified t)) . 11841) (11818 . 11822) (#("  " 0 2 (fontified t)) . 11818) (#(" " 0 1 (fontified t)) . -11805) 11782) nil (26805 34538 890612 0) 0 nil])
([nil nil ((12139 . 12150) (#(" " 0 1 (fontified nil)) . 12139) (12138 . 12139)) nil (26805 34538 890610 0) 0 nil])
([nil nil ((12066 . 12079) (#(" " 0 1 (fontified nil)) . 12066) (12065 . 12066)) nil (26805 34538 890682 0) 0 nil])
([nil nil ((#("(guard! ctx)
           (let* ((payload (json-body ctx)))
             (handler-case
                 (with-tx ()
                   (let* ((ent (row->entity entity payload)))
                     (validate-entity! ent)
                     (multiple-value-bind (n ent2)
                         (entity-insert! ent :returning t)
                       (declare (ignore n))
                       (respond-201 ctx ent2))))
               (error (e)
                 (respond-422 ctx (list :error \"validation_failed\" :
					message (princ-to-string e))))))" 0 25 (fontified t) 25 29 (face font-lock-keyword-face fontified t) 29 72 (fontified t) 72 84 (face font-lock-keyword-face fontified t) 84 103 (fontified t) 103 110 (face font-lock-keyword-face fontified t) 110 134 (fontified t) 134 138 (face font-lock-keyword-face fontified t) 138 196 (fontified t) 196 220 (fontified t) 220 242 (fontified t) 242 261 (face font-lock-keyword-face fontified t) 261 316 (fontified t) 316 326 (face font-lock-builtin-face fontified t) 326 350 (fontified t) 350 354 (fontified t) 354 361 (face font-lock-keyword-face fontified t) 361 374 (fontified t) 374 439 (fontified t) 439 444 (face font-lock-warning-face fontified t) 444 449 (fontified t) 449 478 (fontified t) 478 489 (fontified t) 489 495 (face font-lock-builtin-face fontified t) 495 496 (fontified t) 496 515 (face font-lock-string-face fontified t) 515 516 (fontified t) 516 530 (fontified t) 530 555 (fontified t)) . -12466) (undo-tree-id68 . -478) (undo-tree-id69 . -478) (undo-tree-id70 . -398) (undo-tree-id71 . -467) (undo-tree-id72 . -475) (undo-tree-id73 . -555) (undo-tree-id74 . -448) (undo-tree-id75 . -448) (undo-tree-id76 . -448) (undo-tree-id77 . -448) (undo-tree-id78 . -448) (undo-tree-id79 . -448) (undo-tree-id80 . -448) (undo-tree-id81 . -448) (undo-tree-id82 . -448) (undo-tree-id83 . -448) (undo-tree-id84 . -448) (undo-tree-id85 . -448) (undo-tree-id86 . -448) (undo-tree-id87 . -448) (undo-tree-id88 . -554) (undo-tree-id89 . -554) (undo-tree-id90 . -554) (undo-tree-id91 . -554) (undo-tree-id92 . -555) (undo-tree-id93 . -555) (undo-tree-id94 . -555) (undo-tree-id95 . -555) (undo-tree-id96 . -518) (undo-tree-id97 . -555) (undo-tree-id98 . -555) 13021) nil (26805 34641 168746 0) 0 nil] [nil nil ((12297 . 12310) (#(" " 0 1 (fontified nil)) . 12297) (12296 . 12297)) ((#("
" 0 1 (fontified t)) . 12296) (undo-tree-id54 . -1) (undo-tree-id55 . -1) (12297 . 12298) (#("									    " 0 13 (fontified t)) . 12297) (undo-tree-id56 . -13)) (26805 34538 890604 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 13651 . 13652) (nil fontified nil 12466 . 13652) (12466 . 13652)) nil (26805 34641 168727 0) 0 nil])
nil
([nil nil ((13455 . 13458) (#("        " 0 8 (fontified t)) . 13455) (13431 . 13434) (#("        " 0 8 (fontified t)) . 13431) (13412 . 13420) (#("      " 0 6 (fontified t)) . 13412) (13370 . 13379) (#("                     " 0 21 (fontified t)) . 13370) (13322 . 13325) (#("        " 0 8 (fontified t)) . 13322) (13292 . 13300) (#("      " 0 6 (fontified t)) . 13292) (13236 . 13244) (#("      " 0 6 (fontified t)) . 13236) (13181 . 13185) (#("                " 0 16 (fontified t)) . 13181) (13115 . 13123) (#("                                         " 0 41 (fontified t)) . 13115) (13070 . 13079) (#("                                   " 0 35 (fontified t)) . 13070) (13043 . 13052) (#("                     " 0 21 (fontified t)) . 13043) (12978 . 12987) (#("                     " 0 21 (fontified t)) . 12978) (12889 . 12898) (#("                     " 0 21 (fontified t)) . 12889) (12812 . 12821) (#("                     " 0 21 (fontified t)) . 12812) (12735 . 12744) (#("              " 0 14 (fontified t)) . 12735) (12705 . 12714) (#("              " 0 14 (fontified t)) . 12705) (12667 . 12671) (#("                " 0 16 (fontified t)) . 12667) (12630 . 12637) (#("            " 0 12 (fontified t)) . 12630) (12600 . 12607) (#("            " 0 12 (fontified t)) . 12600) (12552 . 12557) (#("          " 0 10 (fontified t)) . 12552) (12537 . 12540) (#("        " 0 8 (fontified t)) . 12537) (12517 . 12523) (#("    " 0 4 (fontified t)) . 12517) (12479 . 12483) (#("  " 0 2 (fontified t)) . 12479) 12434) nil (26805 34641 168817 0) 0 nil])
([nil nil ((12850 . 12859) (#(" " 0 1 (fontified nil)) . 12849) (undo-tree-id107 . -1) (12850 . 12851)) nil (26805 36014 597292 0) 0 nil] [nil nil ((12855 . 12865) (#(" " 0 1 (fontified nil)) . 12854) (undo-tree-id57 . -1) (undo-tree-id58 . -1) (undo-tree-id59 . -1) (undo-tree-id60 . -1) (undo-tree-id61 . -1) (undo-tree-id62 . -1) (undo-tree-id63 . -1) (undo-tree-id64 . -1) (undo-tree-id65 . -1) (undo-tree-id66 . -1) (undo-tree-id67 . -1) (12855 . 12856)) ((#("
" 0 1 (fontified nil)) . 12855) (undo-tree-id99 . -1) (undo-tree-id100 . -1) (12854 . 12855) (#("							   " 0 10 (fontified t)) . 12855) (undo-tree-id101 . -10)) (26805 34641 168719 0) 0 nil])
([nil nil ((12960 . 12969) (#(" " 0 1 (fontified nil)) . 12960) (12959 . 12960)) nil (26805 36014 597291 0) 0 nil])
nil
([nil nil ((#("(guard! ctx)
           (with-tx ()
             (let* ((sid (path-param ctx \"id\"))
                    (payload (json-body ctx))
                    (row (select* table :filters (list '= pk sid) :limit 1)))
               (if (null row)
                   (respond-404 ctx)
		   (let* ((cur (first row)))
		     (%precondition-check! ctx cur :lock-version-col :LOCK-VERSION
						   :updated-col :UPDATED-AT
						   :created-col :CREATED-AT)
                     (let* ((ent (row->entity entity cur)))
                       ;; appliquer patch (slots présents)
                       (dolist (kv payload)
			 (let* ((col (car kv))
				(val (cdr kv))
				(slot (entity-slot-symbol entity col)))
                           (setf (slot-value ent slot) val)))
                       (validate-entity! ent)
                       (multiple-value-bind (n ent2)
			   (entity-update! ent :patch t :returning t)
			 (declare (ignore n))
			 ;; ETag/Last-Modified de la nouvelle version
			 (let* ((row2 (lumen.data.dao:entity->row-alist ent2)) ; si tu as un helper ; sinon (select* …) again
				(etag (%strong-etag-from-row
				       row2 :lock-version-col :LOCK-VERSION))
				(lm-ut (%row-timestamp
					row2 :updated-col :UPDATED-AT
					     :created-col :CREATED-AT)))
			   (when etag (setf (gethash \"ETag\" (slot-value ctx 'headers))
					    etag))
			   (when lm-ut (setf (gethash \"Last-Modified\"
						      (slot-value ctx 'headers))
					     (%http-date lm-ut))))
			 (respond-json ctx ent2)))))))" 0 25 (fontified t) 25 32 (face font-lock-keyword-face fontified t) 32 50 (fontified t) 50 54 (face font-lock-keyword-face fontified t) 54 77 (fontified t) 77 79 (face font-lock-string-face fontified t) 79 81 (face font-lock-string-face fontified t) 81 84 (fontified t) 84 103 (fontified t) 103 130 (fontified t) 130 170 (fontified t) 170 178 (face font-lock-builtin-face fontified t) 178 181 (fontified t) 181 196 (fontified t) 196 202 (face font-lock-builtin-face fontified t) 202 208 (fontified t) 208 224 (fontified t) 224 226 (face font-lock-keyword-face fontified t) 226 238 (fontified t) 238 275 (fontified t) 275 280 (fontified t) 280 281 (fontified t) 281 285 (face font-lock-keyword-face fontified t) 285 306 (fontified t) 306 313 (fontified t) 313 343 (fontified t) 343 360 (face font-lock-builtin-face fontified t) 360 361 (fontified t) 361 374 (face font-lock-builtin-face fontified t) 374 375 (fontified t) 375 384 (fontified t) 384 396 (face font-lock-builtin-face fontified t) 396 397 (fontified t) 397 408 (face font-lock-builtin-face fontified t) 408 418 (fontified t) 418 430 (face font-lock-builtin-face fontified t) 430 431 (fontified t) 431 442 (face font-lock-builtin-face fontified t) 442 443 (fontified t rear-nonsticky t) 443 444 (fontified t) 444 451 (fontified t) 451 466 (fontified t) 466 470 (face font-lock-keyword-face fontified t) 470 495 (fontified t) 495 504 (fontified t) 504 527 (fontified t) 527 530 (face font-lock-comment-delimiter-face fontified t) 530 533 (face font-lock-comment-face fontified t) 533 547 (face font-lock-comment-face fontified t) 547 563 (face font-lock-comment-face fontified t) 563 587 (fontified t) 587 590 (face font-lock-keyword-face fontified t) 590 593 (face font-lock-keyword-face fontified t) 593 607 (fontified t) 607 611 (fontified t) 611 612 (fontified t) 612 616 (face font-lock-keyword-face fontified t) 616 619 (fontified t) 619 637 (fontified t) 637 641 (fontified t) 641 652 (fontified t) 652 654 (fontified t) 654 656 (fontified t) 656 696 (fontified t) 696 732 (fontified t) 732 758 (fontified t) 758 759 (fontified t) 759 781 (fontified t) 781 787 (fontified t) 787 804 (fontified t) 804 827 (fontified t) 827 828 (fontified t) 828 836 (face font-lock-keyword-face fontified t) 836 847 (face font-lock-keyword-face fontified t) 847 857 (fontified t) 857 863 (fontified t) 863 883 (fontified t) 883 889 (face font-lock-builtin-face fontified t) 889 892 (fontified t) 892 902 (face font-lock-builtin-face fontified t) 902 910 (fontified t) 910 911 (fontified t) 911 918 (face font-lock-keyword-face fontified t) 918 925 (fontified t) 925 931 (fontified t) 931 935 (fontified t) 935 938 (face font-lock-comment-delimiter-face fontified t) 938 980 (face font-lock-comment-face fontified t) 980 984 (fontified t) 984 985 (fontified t) 985 989 (face font-lock-keyword-face fontified t) 989 1038 (fontified t) 1038 1085 (face font-lock-comment-face fontified t) 1085 1086 (fontified t) 1086 1089 (fontified t) 1089 1118 (fontified t) 1118 1134 (fontified t) 1134 1151 (face font-lock-builtin-face fontified t) 1151 1152 (fontified t) 1152 1165 (face font-lock-builtin-face fontified t) 1165 1168 (fontified t) 1168 1172 (fontified t) 1172 1195 (fontified t) 1195 1204 (fontified t) 1204 1205 (fontified t) 1205 1217 (face font-lock-builtin-face fontified t) 1217 1218 (fontified t) 1218 1229 (face font-lock-builtin-face fontified t) 1229 1240 (fontified t) 1240 1252 (face font-lock-builtin-face fontified t) 1252 1253 (fontified t) 1253 1264 (face font-lock-builtin-face fontified t) 1264 1268 (fontified t) 1268 1274 (fontified t) 1274 1275 (fontified t) 1275 1279 (face font-lock-keyword-face fontified t) 1279 1300 (fontified t) 1300 1306 (face font-lock-string-face fontified t) 1306 1344 (fontified t) 1344 1350 (fontified t) 1350 1356 (fontified t) 1356 1357 (fontified t) 1357 1361 (face font-lock-keyword-face fontified t) 1361 1383 (fontified t) 1383 1398 (face font-lock-string-face fontified t) 1398 1399 (fontified t) 1399 1410 (fontified t) 1410 1423 (fontified t) 1423 1432 (fontified t) 1432 1438 (fontified t) 1438 1448 (fontified t) 1448 1469 (fontified t) 1469 1470 (fontified t) 1470 1474 (fontified t) 1474 1499 (fontified t) 1499 1500 (fontified t rear-nonsticky t) 1500 1503 (fontified t)) . -13571) (undo-tree-id106 . -1503) 15074) nil (26805 36014 597290 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 15548 . 15549) (nil fontified nil 13571 . 15549) (13571 . 15549)) nil (26805 36014 597289 0) 0 nil])
([nil nil ((15137 . 15145) (#("      " 0 6 (fontified t)) . 15137) (15108 . 15116) (#("      " 0 6 (fontified t)) . 15108) (15091 . 15097) (#("    " 0 4 (fontified t)) . 15091) (15051 . 15058) (#("                   " 0 19 (fontified t)) . 15051) (14998 . 15006) (#("      " 0 6 (fontified t)) . 14998) (14970 . 14976) (#("    " 0 4 (fontified t)) . 14970) (14948 . 14956) (#("                    " 0 20 (fontified t)) . 14948) (14878 . 14886) (#("      " 0 6 (fontified t)) . 14878) (14849 . 14857) (#("      " 0 6 (fontified t)) . 14849) (14815 . 14817) (#(" " 0 1 (fontified nil)) . 14815) (14785 . 14791) (#("    " 0 4 (fontified t)) . 14785) (14734 . 14744) (#("                      " 0 22 (fontified t)) . 14734) (14669 . 14676) (#("                                               " 0 47 (fontified t)) . 14669) (14625 . 14633) (#("                                         " 0 41 (fontified t)) . 14625) (14599 . 14607) (#("                           " 0 27 (fontified t)) . 14599) (14511 . 14519) (#("                           " 0 27 (fontified t)) . 14511) (14435 . 14443) (#("                           " 0 27 (fontified t)) . 14435) (14373 . 14381) (#("                    " 0 20 (fontified t)) . 14373) (14344 . 14352) (#("                    " 0 20 (fontified t)) . 14344) (14291 . 14301) (#("                      " 0 22 (fontified t)) . 14291) (14255 . 14261) (#("                  " 0 18 (fontified t)) . 14255) (14226 . 14232) (#("                  " 0 18 (fontified t)) . 14226) (14181 . 14191) (#("                      " 0 22 (fontified t)) . 14181) (14133 . 14141) (#("                           " 0 27 (fontified t)) . 14133) (14110 . 14118) (#("                           " 0 27 (fontified t)) . 14110) (14080 . 14088) (#("                    " 0 20 (fontified t)) . 14080) (14053 . 14059) (#("                  " 0 18 (fontified t)) . 14053) (14001 . 14007) (#("                  " 0 18 (fontified t)) . 14001) (13958 . 13962) (#("                " 0 16 (fontified t)) . 13958) (13894 . 13907) (#("                                           " 0 43 (fontified t)) . 13894) (13828 . 13832) (#("                " 0 16 (fontified t)) . 13828) (13793 . 13802) (#("              " 0 14 (fontified t)) . 13793) (13770 . 13779) (#("              " 0 14 (fontified t)) . 13770) (13750 . 13755) (#("          " 0 10 (fontified t)) . 13750) (13689 . 13692) (#("               " 0 15 (fontified t)) . 13689) (13660 . 13663) (#("               " 0 15 (fontified t)) . 13660) (13622 . 13625) (#("        " 0 8 (fontified t)) . 13622) (13602 . 13610) (#("      " 0 6 (fontified t)) . 13602) (13584 . 13588) (#("  " 0 2 (fontified t)) . 13584) 13540) nil (26805 36014 597286 0) 0 nil])
([nil nil ((13932 . 13945) (#(" " 0 1 (fontified nil)) . 13932) (13931 . 13932)) nil (26805 36014 597280 0) 0 nil])
([nil nil ((14485 . 14493) (#(" " 0 1 (fontified nil)) . 14484) (undo-tree-id105 . -1) (14485 . 14486)) nil (26805 36014 597280 0) 0 nil])
([nil nil ((14563 . 14572) (#(" " 0 1 (fontified nil)) . 14562) (undo-tree-id104 . -1) (14563 . 14564)) nil (26805 36014 597279 0) 0 nil])
([nil nil ((14602 . 14609) (#(" " 0 1 (fontified nil)) . 14601) (undo-tree-id103 . -1) (14602 . 14603)) nil (26805 36014 597277 0) 0 nil])
([nil nil ((#("(guard! ctx)
           (with-tx ()
             (let* ((sid (path-param ctx \"id\"))
		    (row (select* table :filters (list '= pk sid) :limit 1)))
	       (if (null row) (respond-404 ctx)
		   (let ((cur (first row)))
		     (%precondition-check! ctx cur :lock-version-col :LOCK-VERSION
						   :updated-col :UPDATED-AT
						   :created-col :CREATED-AT)
		     (let ((ent (row->entity entity cur)))
		       (entity-delete! ent)
		       (respond-json ctx (list :deleted t :id sid)))))))" 0 25 (fontified t) 25 32 (face font-lock-keyword-face fontified t) 32 36 (fontified t) 36 49 (fontified t) 49 50 (fontified t) 50 54 (face font-lock-keyword-face fontified t) 54 77 (fontified t) 77 81 (face font-lock-string-face fontified t) 81 84 (fontified t) 84 90 (fontified t) 90 110 (fontified t) 110 118 (face font-lock-builtin-face fontified t) 118 136 (fontified t) 136 142 (face font-lock-builtin-face fontified t) 142 156 (fontified t) 156 157 (fontified t) 157 159 (face font-lock-keyword-face fontified t) 159 194 (fontified t) 194 195 (fontified t) 195 198 (face font-lock-keyword-face fontified t) 198 217 (fontified t) 217 219 (fontified t) 219 226 (fontified t) 226 256 (fontified t) 256 273 (face font-lock-builtin-face fontified t) 273 274 (fontified t) 274 287 (face font-lock-builtin-face fontified t) 287 288 (fontified t) 288 297 (fontified t) 297 309 (face font-lock-builtin-face fontified t) 309 310 (fontified t) 310 321 (face font-lock-builtin-face fontified t) 321 331 (fontified t) 331 343 (face font-lock-builtin-face fontified t) 343 344 (fontified t) 344 355 (face font-lock-builtin-face fontified t) 355 357 (fontified t) 357 364 (fontified t) 364 365 (fontified t) 365 368 (face font-lock-keyword-face fontified t) 368 411 (fontified t) 411 441 (fontified t) 441 465 (fontified t) 465 473 (face font-lock-builtin-face fontified t) 473 476 (fontified t) 476 479 (face font-lock-builtin-face fontified t) 479 485 (fontified t) 485 486 (fontified t rear-nonsticky t) 486 490 (fontified t)) . -15278) (undo-tree-id102 . -490) 15768) nil (26805 36014 597275 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 16082 . 16083) (nil fontified nil 15278 . 16083) (15278 . 16083)) nil (26805 36014 597265 0) 0 nil])
([nil nil ((15954 . 15962) (#("      " 0 6 (fontified t)) . 15954) (15925 . 15933) (#("      " 0 6 (fontified t)) . 15925) (15908 . 15914) (#("    " 0 4 (fontified t)) . 15908) (15886 . 15894) (#("                    " 0 20 (fontified t)) . 15886) (15816 . 15824) (#("      " 0 6 (fontified t)) . 15816) (15787 . 15795) (#("      " 0 6 (fontified t)) . 15787) (15756 . 15762) (#("    " 0 4 (fontified t)) . 15756) (15704 . 15710) (#("                  " 0 18 (fontified t)) . 15704) (15677 . 15683) (#("                  " 0 18 (fontified t)) . 15677) (15635 . 15639) (#("                " 0 16 (fontified t)) . 15635) (15571 . 15584) (#("                                           " 0 43 (fontified t)) . 15571) (15505 . 15509) (#("                " 0 16 (fontified t)) . 15505) (15471 . 15480) (#("              " 0 14 (fontified t)) . 15471) (15448 . 15457) (#("              " 0 14 (fontified t)) . 15448) (15428 . 15433) (#("          " 0 10 (fontified t)) . 15428) (15367 . 15370) (#("               " 0 15 (fontified t)) . 15367) (15329 . 15332) (#("        " 0 8 (fontified t)) . 15329) (15309 . 15317) (#("      " 0 6 (fontified t)) . 15309) (15291 . 15295) (#("  " 0 2 (fontified t)) . 15291) 15246) nil (26805 36014 597262 0) 0 nil])
([nil nil ((15609 . 15622) (#(" " 0 1 (fontified nil)) . 15609) (15608 . 15609)) nil (26805 36014 597256 0) 0 nil])
([nil nil ((#("http" 0 4 (face font-lock-builtin-face fontified t)) . -260) (undo-tree-id139 . -4) (undo-tree-id140 . -4) 264 (t 26805 36014 0 0)) nil (26805 36954 772777 0) 0 nil])
([nil nil ((260 . 266)) nil (26805 36954 772776 0) 0 nil])
([nil nil ((#("ctx" 0 3 (fontified nil)) . -16583) (16586 . 16589) (#("ctx" 0 3 (fontified t)) . -16563) (16566 . 16569) (#("ctx" 0 3 (fontified nil)) . -16474) (16477 . 16480) (#("ctx" 0 3 (fontified t)) . -16455) (16458 . 16461) (#("ctx" 0 3 (fontified nil)) . -16368) (16371 . 16374) (#("ctx" 0 1 (fontified t) 1 3 (fontified t)) . -16348) (16351 . 16354) (#("ctx" 0 3 (fontified nil)) . -16267) (16270 . 16273) (#("ctx" 0 3 (fontified t)) . -16249) (16252 . 16255) (#("ctx" 0 3 (fontified nil)) . -16165) (16168 . 16171) (#("ctx" 0 3 (fontified t)) . -16146) (16149 . 16152) (#("ctx" 0 3 (fontified t)) . -15533) (15536 . 15539) (#("ctx" 0 3 (fontified t)) . -15358) (15361 . 15364) (#("ctx" 0 3 (fontified t)) . -15288) (15291 . 15294) (#("ctx" 0 3 (fontified t)) . -15264) (15267 . 15270) (#("ctx" 0 3 (fontified t)) . -13856) (13859 . 13862) (#("ctx" 0 3 (fontified t)) . -13685) (13688 . 13691) (#("ctx" 0 3 (fontified t)) . -13651) (13654 . 13657) (#("ctx" 0 3 (fontified t)) . -13581) (13584 . 13587) (#("ctx" 0 3 (fontified t)) . -13557) (13560 . 13563) (#("ctx" 0 3 (fontified t)) . -12512) (12515 . 12518) (#("ctx" 0 3 (fontified t)) . -12476) (12479 . 12482) (#("ctx" 0 3 (fontified t)) . -12452) (12455 . 12458) (#("ctx" 0 3 (fontified t)) . -11873) (11876 . 11879) (#("ctx" 0 3 (fontified t)) . -11838) (11841 . 11844) (#("ctx" 0 3 (fontified t)) . -11815) (11818 . 11821) (#("ctx" 0 3 (fontified t)) . -11798) (11801 . 11804) (#("ctx" 0 3 (fontified t)) . -8395) (8398 . 8401) (#("ctx" 0 3 (fontified t)) . -8353) (8356 . 8359) (#("ctx" 0 3 (fontified t)) . -8323) (8326 . 8329) (#("ctx" 0 3 (fontified t)) . -8299) (8302 . 8305) (#("ctx" 0 3 (fontified t)) . -8127) (8130 . 8133) (#("ctx" 0 3 (fontified t)) . -8064) (8067 . 8070) (#("ctx" 0 3 (face font-lock-doc-face fontified t)) . -7567) (7570 . 7573) (#("ctx" 0 3 (face font-lock-comment-face fontified t)) . -7294) (7297 . 7300) (#("ctx" 0 3 (fontified t)) . -5909) (5912 . 5915) (#("ctx" 0 3 (fontified t)) . -5722) (5725 . 5728)) nil (26805 36954 772774 0) 0 nil])
([nil nil ((#("slot-value" 0 10 (fontified t)) . -5898) (undo-tree-id138 . -10) 5908) nil (26805 36954 772769 0) 0 nil])
([nil nil ((5898 . 5900)) nil (26805 36954 772768 0) 0 nil])
([nil nil ((5900 . 5909)) nil (26805 36954 772768 0) 0 nil])
([nil nil ((#(" 'headers" 0 9 (fontified t)) . 5913)) nil (26805 36954 772767 0) 0 nil])
([nil nil ((#("-in" 0 3 (fontified t)) . 5913)) nil (26805 36954 772767 0) 0 nil])
([nil nil ((143 . 146)) nil (26805 36954 772767 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 510 . 511) (nil fontified nil 510 . 511) (nil fontified nil 494 . 510) (nil fontified nil 493 . 494) (nil fontified nil 480 . 493) (nil fontified nil 479 . 480) (nil fontified nil 467 . 479) (nil fontified nil 466 . 467) (nil fontified nil 452 . 466) (nil fontified nil 451 . 452) (nil fontified nil 432 . 451) (nil fontified nil 428 . 432) (nil fontified nil 419 . 428) (nil fontified nil 418 . 419) (nil fontified nil 410 . 418) (nil fontified nil 406 . 410) (nil fontified nil 391 . 406) (nil fontified nil 390 . 391) (nil fontified nil 372 . 390) (nil fontified nil 371 . 372) (nil fontified nil 351 . 371) (nil fontified nil 348 . 351) (nil fontified nil 336 . 348) (nil fontified nil 335 . 336) (nil fontified nil 318 . 335) (nil fontified nil 317 . 318) (nil fontified nil 305 . 317) (nil fontified nil 304 . 305) (nil fontified nil 292 . 304) (nil fontified nil 291 . 292) (nil fontified nil 280 . 291) (nil fontified nil 279 . 280) (nil fontified nil 267 . 279) (nil fontified nil 266 . 267) (nil fontified nil 255 . 266) (nil fontified nil 254 . 255) (nil fontified nil 244 . 254) (nil fontified nil 243 . 244) (nil fontified nil 231 . 243) (nil fontified nil 230 . 231) (nil fontified nil 221 . 230) (nil fontified nil 220 . 221) (nil fontified nil 208 . 220) (nil fontified nil 207 . 208) (nil fontified nil 194 . 207) (nil fontified nil 193 . 194) (nil fontified nil 180 . 193) (nil fontified nil 176 . 180) (nil fontified nil 160 . 176) (nil fontified nil 159 . 160) (nil fontified nil 147 . 159) (nil fontified nil 146 . 147) (146 . 511)) nil (26805 36954 772765 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 316 . 317) (nil fontified nil 305 . 317) (305 . 317)) nil (26805 36954 772761 0) 0 nil])
([nil nil ((317 . 318)) nil (26805 36954 772761 0) 0 nil])
([nil nil ((330 . 331)) nil (26805 36954 772761 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 342 . 343) (nil fontified nil 331 . 343) (331 . 343)) nil (26805 36954 772760 0) 0 nil])
([nil nil ((343 . 344)) nil (26805 36954 772760 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 355 . 356) (nil fontified nil 344 . 356) (344 . 356)) nil (26805 36954 772759 0) 0 nil])
([nil nil ((#("1" 0 1 (face font-lock-builtin-face rear-nonsticky t fontified t)) . -355) (undo-tree-id137 . -1) 356) nil (26805 36954 772759 0) 0 nil])
([nil nil ((355 . 356)) nil (26805 36954 772758 0) 0 nil])
([nil nil ((#("
  (:import-from :lumen.core.http  :respond-json :respond-404 :respond-422 :respond-201)" 0 1 (fontified t) 1 4 (fontified t) 4 16 (face font-lock-builtin-face fontified t) 16 17 (fontified t) 17 33 (face font-lock-builtin-face fontified t) 33 35 (fontified t) 35 48 (face font-lock-builtin-face fontified t) 48 49 (fontified t) 49 61 (face font-lock-builtin-face fontified t) 61 62 (fontified t) 62 74 (face font-lock-builtin-face fontified t) 74 75 (fontified t) 75 87 (face font-lock-builtin-face fontified t) 87 88 (fontified t)) . -550) (undo-tree-id136 . -88) 638) nil (26805 36954 772757 0) 0 nil])
([nil nil ((332 . 334) (330 . 331)) nil (26805 36954 772756 0) 0 nil])
([nil nil ((256 . 258) (254 . 255)) nil (26805 36954 772756 0) 0 nil])
([nil nil ((#("
" 0 1 (fontified t)) . 393)) nil (26805 36954 772755 0) 0 nil])
([nil nil ((#("		" 0 1 (face font-lock-builtin-face fontified nil) 1 2 (fontified nil)) . -397) (397 . 398) (#("	" 0 1 (fontified nil)) . 397) (393 . 397)) nil (26805 36954 772755 0) 0 nil])
([nil nil ((#("
  " 0 1 (fontified t) 1 3 (fontified t)) . -474) (undo-tree-id135 . -3) 477) nil (26805 36954 772754 0) 0 nil])
([nil nil ((#(":cache-control :current-jwt :current-role :current-user-id" 0 14 (face font-lock-builtin-face fontified t) 14 15 (fontified t) 15 27 (face font-lock-builtin-face fontified t) 27 28 (fontified t) 28 41 (face font-lock-builtin-face fontified t) 41 42 (fontified t) 42 58 (face font-lock-builtin-face fontified t)) . -495) (undo-tree-id134 . -58) 553) nil (26805 36954 772753 0) 0 nil])
([nil nil ((#(" " 0 1 (fontified t)) . -494) (undo-tree-id132 . -1) (undo-tree-id133 . -1) 495) nil (26805 36954 772752 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 6176 . 6177) (nil fontified nil 6162 . 6177) (6162 . 6177)) nil (26805 36954 772749 0) 0 nil])
([nil nil ((6177 . 6178)) nil (26805 36954 772748 0) 0 nil])
([nil nil ((#("param" 0 5 (fontified t)) . -8658) (undo-tree-id131 . -5) 8663) nil (26805 36954 772748 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 8672 . 8673) (nil fontified nil 8658 . 8673) (8658 . 8673)) nil (26805 36954 772746 0) 0 nil])
([nil nil ((8673 . 8681)) nil (26805 36954 772746 0) 0 nil])
([nil nil ((8658 . 8684) (#("lumen.core.http:req-par" 0 14 (fontified t) 14 15 (rear-nonsticky t fontified t) 15 23 (fontified t)) . -8658) (undo-tree-id130 . -23) 8681) nil (26805 36954 772745 0) 0 nil])
([nil nil ((#("y" 0 1 (fontified t)) . 8688) (#("r" 0 1 (fontified t)) . 8688) (#("e" 0 1 (fontified t)) . 8688) (#("u" 0 1 (fontified t)) . 8688) (#("q" 0 1 (fontified t)) . 8688) (#(":" 0 1 (fontified t)) . 8688) (#(" " 0 1 (fontified t)) . 8688)) nil (26805 36954 772744 0) 0 nil])
([nil nil ((#("getf" 0 4 (fontified t)) . -8779) (undo-tree-id129 . -4) 8783) nil (26805 36954 772743 0) 0 nil])
([nil nil ((8779 . 8782)) nil (26805 36954 772742 0) 0 nil])
([nil nil ((#("a" 0 1 (fontified t)) . -8779) (undo-tree-id126 . -1) (#("l" 0 1 (fontified t)) . -8780) (undo-tree-id127 . -1) (#("i" 0 1 (fontified t)) . -8781) (undo-tree-id128 . -1) 8782) nil (26805 36954 772741 0) 0 nil])
([nil nil ((8779 . 8799)) nil (26805 36954 772739 0) 0 nil])
([nil nil ((#("t" 0 1 (fontified t)) . -8798) (undo-tree-id125 . -1) 8799) nil (26805 36954 772739 0) 0 nil])
([nil nil ((#("e" 0 1 (fontified t)) . -8797) (undo-tree-id124 . -1) 8798) nil (26805 36954 772738 0) 0 nil])
([nil nil ((8797 . 8800)) nil (26805 36954 772737 0) 0 nil])
([nil nil ((90 . 93)) nil (26805 36954 772737 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 132 . 133) (nil fontified nil 132 . 133) (nil fontified nil 124 . 132) (nil fontified nil 121 . 124) (nil fontified nil 107 . 121) (nil fontified nil 106 . 107) (nil fontified nil 94 . 106) (nil fontified nil 93 . 94) (93 . 133)) nil (26805 36954 772736 0) 0 nil])
([nil nil ((#("data.db" 0 7 (face font-lock-builtin-face fontified t)) . -114) (undo-tree-id123 . -7) 121) nil (26805 36954 772735 0) 0 nil])
([nil nil ((114 . 119)) nil (26805 36954 772734 0) 0 nil])
([nil nil ((#("with" 0 4 (face font-lock-builtin-face fontified t)) . 123)) nil (26805 36954 772734 0) 0 nil])
([nil nil ((#("-tx" 0 3 (face font-lock-builtin-face fontified t)) . 123)) nil (26805 36954 772733 0) 0 nil])
([nil nil ((123 . 128)) nil (26805 36954 772733 0) 0 nil])
([nil nil ((128 . 132)) nil (26805 36954 772733 0) 0 nil])
([nil nil ((#(":q" 0 2 (face font-lock-builtin-face fontified t)) . 8847) (undo-tree-id122 . -2) 8849) nil (26805 36954 772732 0) 0 nil])
([nil nil ((#(" " 0 1 (fontified t)) . -8846) (undo-tree-id120 . -1) (undo-tree-id121 . -1) 8847) nil (26805 36954 772731 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 8845 . 8846) (nil fontified nil 8844 . 8846) (8844 . 8846)) nil (26805 36954 772729 0) 0 nil])
([nil nil ((8846 . 8847)) nil (26805 36954 772729 0) 0 nil])
([nil nil ((8851 . 8857) (#(" " 0 1 (fontified nil)) . 8850) (undo-tree-id119 . -1) (8851 . 8852)) nil (26805 36954 772728 0) 0 nil])
([nil nil ((#(":q" 0 1 (face font-lock-builtin-face fontified t) 1 2 (face font-lock-builtin-face rear-nonsticky t fontified t)) . 8844) (undo-tree-id118 . -2) 8846) nil (26805 36954 772727 0) 0 nil])
([nil nil ((#(" " 0 1 (fontified t)) . 8844)) nil (26805 36954 772726 0) 0 nil])
([nil nil ((8846 . 8847)) nil (26805 36954 772726 0) 0 nil])
([nil nil ((nil fontified nil 8848 . 8849) (nil fontified nil 8847 . 8848) (8847 . 8849)) nil (26805 36954 772725 0) 0 nil])
([nil nil ((#("getf" 0 4 (fontified t)) . -8941) (undo-tree-id117 . -4) 8945) nil (26805 36954 772725 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 8961 . 8962) (nil fontified nil 8941 . 8962) (8941 . 8962)) nil (26805 36954 772724 0) 0 nil])
([nil nil ((8962 . 8963)) nil (26805 36954 772723 0) 0 nil])
([nil nil ((#(" " 0 1 (fontified t)) . -8962) (undo-tree-id116 . -1) 8963) nil (26805 36954 772723 0) 0 nil])
([nil nil ((#("getf" 0 4 (fontified t)) . -9007) (undo-tree-id115 . -4) 9011) nil (26805 36954 772722 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 9027 . 9028) (nil fontified nil 9007 . 9028) (9007 . 9028)) nil (26805 36954 772721 0) 0 nil])
([nil nil ((#("getf" 0 4 (fontified t)) . -9072) (9076 . 9097)) nil (26805 36954 772720 0) 0 nil])
([nil nil ((#("getf" 0 4 (fontified t)) . -9136) (9140 . 9161)) nil (26805 36954 772720 0) 0 nil])
([nil nil ((#("getf" 0 4 (fontified t)) . -9205) (9209 . 9230)) nil (26805 36954 772719 0) 0 nil])
([nil nil ((#("getf" 0 4 (fontified t)) . -9270) (9274 . 9295)) nil (26805 36954 772719 0) 0 nil])
([nil nil ((#("getf" 0 4 (fontified t)) . -9333) (9337 . 9358)) nil (26805 36954 772718 0) 0 nil])
([nil nil ((#("getf" 0 4 (fontified t)) . -9398) (9402 . 9423)) nil (26805 36954 772718 0) 0 nil])
([nil nil ((#("req" 0 3 (fontified t)) . -12323) (undo-tree-id114 . -3) 12326) nil (26805 36954 772717 0) 0 nil])
([nil nil ((12323 . 12325)) nil (26805 36954 772716 0) 0 nil])
([nil nil ((#("(path-param req \"id\")" 0 11 (fontified t) 11 12 (fontified t) 12 15 (fontified t) 15 16 (fontified t) 16 20 (face font-lock-string-face fontified t) 20 21 (fontified t)) . -12345) (undo-tree-id113 . -21) 12366) nil (26805 36954 772716 0) 0 nil])
([nil nil ((12345 . 12347)) nil (26805 36954 772715 0) 0 nil])
([nil nil ((#("json-body req" 0 10 (fontified t) 10 13 (fontified t)) . -12967) (undo-tree-id111 . -9) (undo-tree-id112 . -13) 12980) nil (26805 36954 772714 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 12999 . 13000) (nil fontified nil 12995 . 13000) (nil fontified nil 12967 . 12995) (12967 . 13000)) nil (26805 36954 772713 0) 0 nil])
([nil nil ((#("json-body req" 0 10 (fontified t) 10 13 (fontified t)) . -14160) (undo-tree-id110 . -13) 14173) nil (26805 36954 772712 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 14192 . 14193) (nil fontified nil 14188 . 14193) (nil fontified nil 14160 . 14188) (14160 . 14193)) nil (26805 36954 772711 0) 0 nil])
([nil nil ((14088 . 14097)) nil (26805 36954 772710 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 14113 . 14114) (nil fontified nil 14113 . 14114) (nil fontified nil 14109 . 14113) (nil fontified nil 14098 . 14109) (nil fontified nil 14097 . 14098) (14097 . 14114)) nil (26805 36954 772710 0) 0 nil])
([nil nil ((#("(path-param req \"id\")" 0 12 (fontified t) 12 15 (fontified t) 15 16 (fontified t) 16 20 (face font-lock-string-face fontified t) 20 21 (fontified t)) . -14150) (undo-tree-id109 . -21) 14171) nil (26805 36954 772709 0) 0 nil])
([nil nil ((14150 . 14152)) nil (26805 36954 772707 0) 0 nil])
([nil nil ((15822 . 15831)) nil (26805 36954 772706 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 15847 . 15848) (nil fontified nil 15847 . 15848) (nil fontified nil 15843 . 15847) (nil fontified nil 15832 . 15843) (nil fontified nil 15831 . 15832) (15831 . 15848)) nil (26805 36954 772706 0) 0 nil])
([nil nil ((#("(path-param req \"id\")" 0 12 (fontified t) 12 15 (fontified t) 15 16 (fontified t) 16 20 (face font-lock-string-face fontified t) 20 21 (fontified t)) . -15884) (undo-tree-id108 . -21) 15905) nil (26805 36954 772704 0) 0 nil])
([nil nil ((15884 . 15886)) nil (26805 36954 772696 0) 0 nil])
([nil nil ((15712 . 15713)) nil (26805 36954 772695 0) 0 nil])
([nil nil ((16513 . 16514)) nil (26805 36954 772691 0) 0 nil])
([nil nil ((#("  :path-param :json-body" 0 2 (fontified t) 2 13 (face font-lock-builtin-face fontified t) 13 14 (fontified t) 14 24 (face font-lock-builtin-face fontified t)) . -595) (undo-tree-id141 . -24) (undo-tree-id142 . -1) (undo-tree-id143 . -1) (undo-tree-id144 . -23) (undo-tree-id145 . -23) (undo-tree-id146 . -6) (undo-tree-id147 . -6) (undo-tree-id148 . -6) (undo-tree-id149 . -6) (undo-tree-id150 . -6) (undo-tree-id151 . -6) (undo-tree-id152 . -6) (undo-tree-id153 . -6) (undo-tree-id154 . -6) (undo-tree-id155 . -3) (undo-tree-id156 . -3) (undo-tree-id157 . -3) (undo-tree-id158 . -1) (undo-tree-id159 . -3) (undo-tree-id160 . -13) (undo-tree-id161 . -13) (undo-tree-id162 . -13) (undo-tree-id163 . -13) (undo-tree-id164 . -13) (undo-tree-id165 . -13) (undo-tree-id166 . -13) (undo-tree-id167 . -13) (undo-tree-id168 . -13) (undo-tree-id169 . -13) (undo-tree-id170 . -13) (undo-tree-id171 . -13) (undo-tree-id172 . -13) (undo-tree-id173 . -13) (undo-tree-id174 . -2) (undo-tree-id175 . -2) (undo-tree-id176 . -2) (undo-tree-id177 . -2) (undo-tree-id178 . -2) (undo-tree-id179 . -3) (undo-tree-id180 . -24) (undo-tree-id181 . -24) (undo-tree-id182 . -24) (undo-tree-id183 . -24) (undo-tree-id184 . -24) (undo-tree-id185 . -24) 619 (t 26805 36954 0 0)) nil (26805 36976 802967 0) 0 nil])
([nil nil ((3832 . 3839) (t 26805 36976 0 0)) nil (26805 37358 613698 0) 0 nil])
([nil nil ((133 . 136)) nil (26805 37358 613697 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 189 . 190) (nil fontified nil 189 . 190) (nil fontified nil 177 . 189) (nil fontified nil 176 . 177) (nil fontified nil 167 . 176) (nil fontified nil 161 . 167) (nil fontified nil 150 . 161) (nil fontified nil 149 . 150) (nil fontified nil 137 . 149) (nil fontified nil 136 . 137) (136 . 190)) nil (26805 37358 613696 0) 0 nil])
([nil nil ((#("alexandria" 0 10 (face font-lock-builtin-face fontified t)) . -151) (undo-tree-id218 . -10) 161) nil (26805 37358 613695 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 160 . 161) (nil fontified nil 151 . 161) (151 . 161)) nil (26805 37358 613694 0) 0 nil])
([nil nil ((#("util" 0 3 (face font-lock-builtin-face fontified t) 3 4 (face font-lock-builtin-face rear-nonsticky t fontified t)) . 157)) nil (26805 37358 613693 0) 0 nil])
([nil nil ((157 . 164)) nil (26805 37358 613692 0) 0 nil])
([nil nil ((164 . 168)) nil (26805 37358 613692 0) 0 nil])
([nil nil ((#("when-let :alist-plist" 0 8 (face font-lock-builtin-face fontified t) 8 9 (fontified t) 9 21 (face font-lock-builtin-face fontified t)) . -175) (undo-tree-id211 . -21) (undo-tree-id212 . -21) (undo-tree-id213 . -21) (undo-tree-id214 . -21) (undo-tree-id215 . -21) (undo-tree-id216 . -21) (undo-tree-id217 . -21) 196) nil (26805 37358 613691 0) 0 nil])
([nil nil ((175 . 180)) nil (26805 37358 613685 0) 0 nil])
([nil nil ((#(" " 0 1 (fontified t)) . -169) (undo-tree-id186 . -1) (undo-tree-id187 . -1) (undo-tree-id188 . -1) (undo-tree-id189 . -1) (undo-tree-id190 . -1) (#(" " 0 1 (fontified t)) . -170) (undo-tree-id191 . -1) (undo-tree-id192 . -1) (undo-tree-id193 . -1) (undo-tree-id194 . -1) (undo-tree-id195 . -1) (#(" " 0 1 (fontified t)) . -171) (undo-tree-id196 . -1) (undo-tree-id197 . -1) (undo-tree-id198 . -1) (undo-tree-id199 . -1) (undo-tree-id200 . -1) (#(" " 0 1 (fontified t)) . -172) (undo-tree-id201 . -1) (undo-tree-id202 . -1) (undo-tree-id203 . -1) (undo-tree-id204 . -1) (undo-tree-id205 . -1) (#(" " 0 1 (fontified t)) . -173) (undo-tree-id206 . -1) (undo-tree-id207 . -1) (undo-tree-id208 . -1) (undo-tree-id209 . -1) (undo-tree-id210 . -1) 174) nil (26805 37358 613681 0) 0 nil])
([nil nil ((822 . 823) (t 26805 37358 0 0)) nil (26805 40389 341353 0) 0 nil])
([nil nil ((nil fontified nil 840 . 841) (nil fontified nil 824 . 840) (nil fontified nil 823 . 824) (823 . 841)) nil (26805 40389 341348 0) 0 nil])
([nil nil ((15453 . 15455) (t 26805 40389 0 0)) nil (26805 40576 537255 0) 0 nil])
([nil nil ((15714 . 15716)) nil (26805 40576 537255 0) 0 nil])
([nil nil ((16517 . 16519)) nil (26805 40576 537254 0) 0 nil])
([nil nil ((16379 . 16381)) nil (26805 40576 537249 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 8148 . 8149) (nil fontified nil 7393 . 8149) (7393 . 8149) (t 26805 40576 0 0)) nil (26805 42367 256792 0) 0 nil])
([nil nil ((8149 . 8150)) nil (26805 42367 256791 0) 0 nil])
([nil nil ((#(";; --- Transition propre : si MOUNT-CRUD! est une fonction ordinaire, on la délie avant de créer le generic
(eval-when (:compile-toplevel :load-toplevel :execute)
  (when (and (fboundp 'mount-crud!)
             (not (typep (symbol-function 'mount-crud!) 'standard-generic-function)))
    (fmakunbound 'mount-crud!)))" 0 3 (face font-lock-comment-delimiter-face fontified t) 3 108 (face font-lock-comment-face fontified t) 108 109 (fontified t) 109 118 (face font-lock-keyword-face fontified t) 118 120 (fontified t) 120 137 (face font-lock-builtin-face fontified t) 137 138 (fontified t) 138 152 (face font-lock-builtin-face fontified t) 152 153 (fontified t) 153 161 (face font-lock-builtin-face fontified t) 161 166 (fontified t) 166 170 (face font-lock-keyword-face fontified t) 170 317 (fontified t)) . 7393) (undo-tree-id264 . -317) 7710) nil (26805 42367 256791 0) 0 nil])
([nil nil ((#("
" 0 1 (fontified t)) . 7393) (#("
" 0 1 (fontified t)) . 7393)) nil (26805 42367 256789 0) 0 nil])
([nil nil ((1133 . 1134)) nil (26805 42367 256789 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 1450 . 1451) (nil fontified nil 1304 . 1451) (nil fontified nil 1300 . 1304) (nil fontified nil 1295 . 1300) (nil fontified nil 1287 . 1295) (nil fontified nil 1286 . 1287) (nil fontified nil 1272 . 1286) (nil fontified nil 1271 . 1272) (nil fontified nil 1254 . 1271) (nil fontified nil 1252 . 1254) (nil fontified nil 1243 . 1252) (nil fontified nil 1242 . 1243) (nil fontified nil 1137 . 1242) (nil fontified nil 1134 . 1137) (1134 . 1451)) nil (26805 42367 256788 0) 0 nil])
([nil nil ((1451 . 1452)) nil (26805 42367 256787 0) 0 nil])
([nil nil ((#("defun" 0 5 (face font-lock-keyword-face fontified t)) . -8152) (undo-tree-id263 . -5) 8157) nil (26805 42367 256786 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 8161 . 8162) (nil fontified nil 8152 . 8162) (8152 . 8162)) nil (26805 42367 256785 0) 0 nil])
([nil nil ((#("router" 0 6 (fontified t)) . -7819) (undo-tree-id262 . -6) 7825) nil (26805 42367 256784 0) 0 nil])
([nil nil ((#(" " 0 1 (fontified t)) . 7819)) nil (26805 42367 256783 0) 0 nil])
([nil nil ((#("  :base-path   chemin base (string)
  :allowed     whitelist d'order
  :auth-guard  fonction (ctx) -> bool
  :oapi?       si T, permet à une méthode :after d’enregistrer l’OpenAPI." 0 107 (face font-lock-doc-face fontified t) 107 180 (face font-lock-doc-face fontified t)) . -7959) (undo-tree-id261 . -180) 8139) nil (26805 42367 256782 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 8194 . 8195) (nil fontified nil 8154 . 8195) (nil fontified nil 8151 . 8154) (nil fontified nil 8118 . 8151) (nil fontified nil 8059 . 8118) (nil fontified nil 8039 . 8059) (nil fontified nil 8030 . 8039) (nil fontified nil 7959 . 8030) (7959 . 8195)) nil (26805 42367 256781 0) 0 nil])
([nil nil ((#("defgeneric" 0 9 (face font-lock-keyword-face fontified t) 9 10 (face font-lock-keyword-face fontified t rear-nonsticky t)) . -8201) (undo-tree-id260 . -10) 8211) nil (26805 42367 256780 0) 0 nil])
([nil nil ((8201 . 8207)) nil (26805 42367 256778 0) 0 nil])
([nil nil ((8201 . 8210) (#("defmet" 0 6 (fontified t)) . -8201) (undo-tree-id259 . -6) 8207) nil (26805 42367 256778 0) 0 nil])
([nil nil ((8224 . 8225)) nil (26805 42367 256777 0) 0 nil])
([nil nil ((8231 . 8232)) nil (26805 42367 256776 0) 0 nil])
([nil nil ((8232 . 8239)) nil (26805 42367 256776 0) 0 nil])
([nil nil ((#("l" 0 1 (fontified t)) . -8234) (undo-tree-id258 . -1) 8235) nil (26805 42367 256775 0) 0 nil])
([nil nil ((8234 . 8235)) nil (26805 42367 256774 0) 0 nil])
([nil nil ((#("path" 0 4 (fontified t)) . -7836) (undo-tree-id257 . -4) 7840) nil (26805 42367 256774 0) 0 nil])
([nil nil ((#("-" 0 1 (fontified t)) . -7835) (undo-tree-id255 . -1) (undo-tree-id256 . -1) 7836) nil (26805 42367 256772 0) 0 nil])
([nil nil ((7835 . 7836)) nil (26805 42367 256771 0) 0 nil])
([nil nil ((7836 . 7840)) nil (26805 42367 256770 0) 0 nil])
([nil nil ((#("allowed" 0 7 (fontified t)) . -7841) (undo-tree-id252 . -7) (undo-tree-id253 . -7) (undo-tree-id254 . -7) 7848) nil (26805 42367 256770 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 7855 . 7856) (nil fontified nil 7841 . 7856) (7841 . 7856)) nil (26805 42367 256767 0) 0 nil])
([nil nil ((#("oapi" 0 4 (fontified t)) . -7868) (undo-tree-id238 . -4) (undo-tree-id239 . -1) (undo-tree-id240 . -1) (undo-tree-id241 . -1) (undo-tree-id242 . -1) (undo-tree-id243 . -1) (undo-tree-id244 . -4) (undo-tree-id245 . -4) (undo-tree-id246 . -4) (undo-tree-id247 . -4) (undo-tree-id248 . -4) (undo-tree-id249 . -4) (undo-tree-id250 . -4) (undo-tree-id251 . -4) 7872) nil (26805 42367 256766 0) 0 nil])
([nil nil ((#(" " 0 1 (fontified t)) . -7867) (undo-tree-id219 . -1) (undo-tree-id220 . -1) (undo-tree-id221 . -1) (undo-tree-id222 . -1) (undo-tree-id223 . -1) (undo-tree-id224 . -1) (undo-tree-id225 . -1) (undo-tree-id226 . -1) (undo-tree-id227 . -1) (undo-tree-id228 . -1) (undo-tree-id229 . -1) (undo-tree-id230 . -1) (undo-tree-id231 . -1) (undo-tree-id232 . -1) (undo-tree-id233 . -1) (undo-tree-id234 . -1) (undo-tree-id235 . -1) (undo-tree-id236 . -1) (undo-tree-id237 . -1) 7868) nil (26805 42367 256754 0) 0 nil])
([nil nil ((#("?" 0 1 (fontified t)) . 7867)) nil (26805 42367 256729 0) 0 nil])
([nil nil ((638 . 639) (t 26805 42367 0 0)) nil (26805 52516 89823 0) 0 nil])
([nil nil ((639 . 648)) nil (26805 52516 89819 0) 0 nil])
([nil nil ((8210 . 8212) (t 26805 52516 0 0)) nil (26806 3836 69154 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 19118 . 19119) (nil fontified nil 8212 . 19119) (8212 . 19119)) nil (26806 3836 69153 0) 0 nil])
([nil nil ((#("

(defmethod mount-crud! ((entity symbol) &key (base \"/api\")
                           (name nil)             ; ex. \"users\" (par défaut table)
                           (order-whitelist '())  ; sécuriser sort
                           (auth-guard nil))      ; (lambda (req) ...) ⇒ t/NIL
  \"Monter des routes CRUD standardisées pour ENTITY.
Options :
- BASE             : préfixe (\\\"/api\\\")
- NAME             : segment de chemin (par défaut = table)
- ORDER-WHITELIST  : colonnes autorisées au tri (keywords)
- AUTH-GUARD       : fn (lambda (req) (boolean)) – si fourni, doit renvoyer T
Retourne la liste des routes montées.\"
  (let* ((md (entity-metadata entity))
         (table (getf md :table))
         (seg   (or name table))
         (pk    (or (getf md :primary-key) :id))
         (allowed (or order-whitelist (mapcar (lambda (f) (getf f :col)) (entity-fields entity))))
         (base-list (concatenate 'string base \"/\" seg))
         (base-item (concatenate 'string base \"/\" seg \"/(?<id>[^/]+)\")))
    (labels
        ((guard! (req)
           (when (and auth-guard (not (funcall auth-guard req)))
             (return-from guard! (respond-404)))) ; 404 > 401/403 selon ta politique

         ;; -------- LISTE (offset ou keyset) --------
         (handle-index (req)
           (guard! req)
           (with-params (req)
             (let* ((qp       (lumen.core.http:req-params req))   ; alist des query params, selon ton implémentation
                    (qf       (or (lumen.utils:alist-get qp :q)
				  (make-hash-table :test 'equal))) ; sous-objet q[...]
                    (select-s (lumen.utils:alist-get qp :select))
                    (order-s  (lumen.utils:alist-get qp :order))
                    (page-s   (lumen.utils:alist-get qp :page))
                    (psize-s  (lumen.utils:alist-get qp :page_size))
                    (limit-s  (lumen.utils:alist-get qp :limit))
                    (key-s    (lumen.utils:alist-get qp :key))
                    (after-s  (lumen.utils:alist-get qp :after))
                    (before-s (lumen.utils:alist-get qp :before))
                    ;; build params
                    (filters   (%filters-from-query qf))
                    (select    (%parse-select select-s))
                    (order     (or (%ensure-order-whitelist (%parse-order order-s) allowed)
                                   (%derive-default-order entity)))
                    (key       (%parse-key key-s))
                    (after     (%parse-after/before after-s))
                    (before    (%parse-after/before before-s)))
               (cond
                 ;; keyset NEXT
                 ((or after before)
                  (%ensure-key-matches-order key order)
                  (let ((res (if after
                                 (select-page-keyset* table
                                                      :filters filters
                                                      :order order
                                                      :key key
                                                      :after after
                                                      :limit (or (and limit-s (%maybe-number limit-s)) 20)
                                                      :order-whitelist allowed)
                                 (select-page-keyset-prev* table
                                                           :filters filters
                                                           :order order
                                                           :key key
                                                           :before before
                                                           :limit (or (and limit-s (%maybe-number limit-s)) 20)
                                                           :order-whitelist allowed)))))
                    (respond-json res)))
                 ;; offset pagination
                 (t
                  (let* ((page      (max 1 (or (and page-s (%maybe-number page-s)) 1)))
                         (page-size (max 1 (min 200 (or (and psize-s (%maybe-number psize-s)) 20))))
                         (offset    (* (1- page) page-size))
                         (items     (select* table
                                             :filters filters
                                             :order order
                                             :select (or select :*)
                                             :limit page-size
                                             :offset offset
                                             :order-whitelist allowed))
                         (total     (count* table :filters filters)))
                    (respond-json (list :items items
                               :total total :page page :page-size page-size
                               :order order :filters filters)))))))

         ;; -------- SHOW --------
         (handle-show (req)
	   (guard! req)
	   (with-params (id)
	     (let* ((sid id)
		    (row (select* table :filters (list '= pk sid) :limit 1)))
	       (if (and row (first row))
		   (let* ((one (first row))
			  (etag (%strong-etag-from-row one :lock-version-col
						       :LOCK-VERSION))
			  (lm-ut (%row-timestamp one :updated-col :UPDATED-AT
						     :created-col :CREATED-AT))
			  (hdrs (remove nil
					(list (when etag `(\"ETag\" . ,etag))
					      (when lm-ut `(\"Last-Modified\" . ,(%http-date lm-ut)))))))
		     (respond-json one :headers hdrs))
		   (respond-404)))))

         ;; -------- CREATE --------
         (handle-create (req)
           (guard! req)
	   (let* ((payload (lumen.core.http:ctx-get req :json)))
	     (handler-case
		 (with-tx ()
		   (let* ((ent (row->entity entity payload)))
		     (validate-entity! ent)
		     (multiple-value-bind (n ent2)
			 (entity-insert! ent :returning t)
		       (declare (ignore n))
		       (let* ((row2 (lumen.data.dao:entity->row-alist ent2)) ; ou reselect
			      (etag (%strong-etag-from-row
				     row2 :lock-version-col :LOCK-VERSION))
			      (lm-ut (%row-timestamp row2 :updated-col :UPDATED-AT
							  :created-col :CREATED-AT))
			      (loc  (format nil \"~a/~a\" base (cdr (assoc :ID row2))))
			      (hdrs (remove nil
					    (list (when etag `(\"ETag\" . ,etag))
						  (when lm-ut `(\"Last-Modified\" . ,(%http-date lm-ut)))))))
			 (respond-201 ent2 :location loc :headers hdrs)))))
	       ;; tu peux spécialiser tes conditions si besoin
	       (validation-error (e)
		 (respond-422 :message (validation-message e)
			      :errors  (validation-errors e)))
	       (error (e)
		 (declare (ignore e))
		 (respond-500)))))

         ;; -------- PATCH --------
         (handle-patch (req)
           (guard! req)
	   (handler-case
	       (with-params (id)
	       (with-tx ()
		 (let* ((sid id)
			(payload (lumen.core.http:ctx-get req :json))
			(row (select* table :filters (list '= pk sid) :limit 1)))
		   (if (null row)
		       (respond-404)
		       (let* ((cur (first row)))
			 (%precondition-check! req cur :lock-version-col :LOCK-VERSION
						       :updated-col :UPDATED-AT
						       :created-col :CREATED-AT)
			 (let* ((ent (row->entity entity cur)))
			   ;; appliquer patch (slots présents seulement)
			   (dolist (kv payload)
			     (let* ((col (car kv))
				    (val (cdr kv))
				    (slot (entity-slot-symbol entity col)))
			       (setf (slot-value ent slot) val)))
			   (validate-entity! ent)
			   (multiple-value-bind (n ent2)
			       (entity-update! ent :patch t :returning t)
			     (declare (ignore n))
			     (let* ((row2 (lumen.data.dao:entity->row-alist ent2))
				    (etag (%strong-etag-from-row
					   row2 :lock-version-col :LOCK-VERSION))
				    (lm-ut (%row-timestamp
					    row2 :updated-col :UPDATED-AT
						 :created-col :CREATED-AT))
				    (hdrs (remove nil
						  (list (when etag `(\"ETag\" . ,etag))
							(when lm-ut `(\"Last-Modified\" . ,(%http-date lm-ut)))))))
			       (respond-json ent2 :headers hdrs))))))))
	     (precondition-failed (e)  ; si tu as une condition dédiée
	       ;;(declare (ignore e))
	       (respond-json '((:error . ((:type . \"precondition_failed\"))))
			     :status 412))
	     (validation-error (e)
	       (respond-422 :message (validation-message e)
			    :errors  (validation-errors e)))
	     (error (e)
	       ;;(declare (ignore e))
	       (respond-500)))))

         ;; -------- DELETE --------
         (handle-delete (req)
           (guard! req)
	   (handler-case
	       (with-params (id)
	       (with-tx ()
		 (let* ((sid id)
			(row (select* table :filters (list '= pk sid) :limit 1)))
		   (if (null row)
		       (respond-404)
		       (let ((cur (first row)))
			 (%precondition-check! req cur :lock-version-col :LOCK-VERSION
						       :updated-col :UPDATED-AT
						       :created-col :CREATED-AT)
			 (let ((ent (row->entity entity cur)))
			   (entity-delete! ent)
			   (respond-json (list :deleted t :id sid)))))))
	     (precondition-failed (e)
	       ;;(declare (ignore e))
	       (respond-json '((:error . ((:type . \"precondition_failed\"))))
			     :status 412))
	     (error (e)
	       ;;(declare (ignore e))
	       (respond-500)))))
	 )
      ;; Déclaration des routes (adapte selon ton routeur : defroute ...)
      ;; GET /api/<seg>
      (defroute GET  (format nil \"~a\" base-list) (req) (handle-index req))
      ;; GET /api/<seg>/:id
      (defroute GET  (format nil \"~a\" base-item) (req) (handle-show req))
      ;; POST /api/<seg>
      (defroute POST (format nil \"~a\" base-list) (req) (handle-create req))
      ;; PATCH /api/<seg>/:id
      (defroute PATCH (format nil \"~a\" base-item) (req) (handle-patch req))
      ;; DELETE /api/<seg>/:id
      (defroute DELETE (format nil \"~a\" base-item) (req) (handle-delete req))
      ;; retourne la liste des patterns montés
      (list base-list base-item))))" 0 1 (fontified t) 1 2 (fontified t) 2 3 (fontified t) 3 12 (face font-lock-keyword-face fontified t) 12 13 (fontified t) 13 24 (face font-lock-function-name-face fontified t) 24 41 (fontified t) 41 42 (fontified t) 42 46 (face font-lock-type-face fontified t) 46 53 (fontified t) 53 59 (face font-lock-string-face fontified t) 59 61 (fontified t) 61 106 (fontified t) 106 111 (fontified t) 111 144 (face font-lock-comment-face fontified t) 144 149 (fontified t) 149 194 (fontified t) 194 211 (face font-lock-comment-face fontified t) 211 261 (fontified t) 261 272 (face font-lock-comment-face fontified t) 272 275 (face font-lock-comment-face fontified t) 275 290 (face font-lock-comment-face fontified t) 290 292 (fontified t) 292 424 (face font-lock-doc-face fontified t) 424 433 (face font-lock-doc-face fontified t) 433 453 (face font-lock-doc-face fontified t) 453 512 (face font-lock-doc-face fontified t) 512 545 (face font-lock-doc-face fontified t) 545 548 (face font-lock-doc-face fontified t) 548 590 (face font-lock-doc-face fontified t) 590 628 (face font-lock-doc-face fontified t) 628 632 (fontified t) 632 636 (face font-lock-keyword-face fontified t) 636 693 (fontified t) 693 699 (face font-lock-builtin-face fontified t) 699 709 (fontified t) 709 735 (fontified t) 735 764 (fontified t) 764 776 (face font-lock-builtin-face fontified t) 776 778 (fontified t) 778 781 (face font-lock-builtin-face fontified t) 781 831 (fontified t) 831 837 (face font-lock-keyword-face fontified t) 837 850 (fontified t) 850 854 (face font-lock-builtin-face fontified t) 854 875 (fontified t) 875 883 (fontified t) 883 929 (fontified t) 929 932 (face font-lock-string-face fontified t) 932 978 (fontified t) 978 985 (fontified t) 985 988 (face font-lock-string-face fontified t) 988 993 (fontified t) 993 1002 (face font-lock-string-face fontified t) 1002 1003 (face (font-lock-negation-char-face font-lock-string-face) fontified t) 1003 1008 (face font-lock-string-face fontified t) 1008 1012 (fontified t) 1012 1017 (fontified t) 1017 1023 (face font-lock-keyword-face fontified t) 1023 1024 (fontified t) 1024 1042 (fontified t) 1042 1045 (fontified t) 1045 1047 (fontified t) 1047 1059 (fontified t) 1059 1063 (face font-lock-keyword-face fontified t) 1063 1075 (fontified t) 1075 1105 (fontified t) 1105 1108 (fontified t) 1108 1112 (fontified t) 1112 1126 (fontified t) 1126 1137 (face font-lock-keyword-face fontified t) 1137 1162 (fontified t) 1162 1187 (face font-lock-comment-face fontified t) 1187 1197 (face font-lock-comment-face fontified t) 1197 1207 (fontified t) 1207 1210 (face font-lock-comment-delimiter-face fontified t) 1210 1251 (face font-lock-comment-face fontified t) 1251 1253 (face font-lock-comment-face fontified t) 1253 1270 (fontified t) 1270 1277 (fontified t) 1277 1280 (fontified t) 1280 1282 (fontified t) 1282 1301 (fontified t) 1301 1304 (fontified t) 1304 1306 (fontified t) 1306 1318 (fontified t) 1318 1329 (face font-lock-keyword-face fontified t) 1329 1330 (fontified t) 1330 1331 (fontified t) 1331 1334 (fontified t) 1334 1336 (fontified t) 1336 1350 (fontified t) 1350 1354 (face font-lock-keyword-face fontified t) 1354 1367 (fontified t) 1367 1393 (fontified t) 1393 1394 (fontified t) 1394 1397 (fontified t) 1397 1402 (fontified t) 1402 1426 (face font-lock-comment-face fontified t) 1426 1453 (face font-lock-comment-face fontified t) 1453 1501 (fontified t) 1501 1509 (fontified t) 1509 1510 (fontified t) 1510 1513 (fontified t) 1513 1514 (face font-lock-builtin-face fontified t) 1514 1515 (face font-lock-builtin-face fontified t rear-nonsticky t) 1515 1517 (fontified t) 1517 1540 (fontified t) 1540 1541 (face font-lock-builtin-face fontified t) 1541 1545 (face font-lock-builtin-face fontified t) 1545 1556 (fontified t) 1556 1561 (face font-lock-comment-face fontified t) 1561 1576 (face font-lock-comment-face fontified t) 1576 1607 (fontified t) 1607 1627 (fontified t) 1627 1628 (fontified t rear-nonsticky t) 1628 1632 (fontified t) 1632 1639 (face font-lock-builtin-face fontified t) 1639 1642 (fontified t) 1642 1644 (fontified t) 1644 1673 (fontified t) 1673 1693 (fontified t) 1693 1694 (fontified t rear-nonsticky t) 1694 1698 (fontified t) 1698 1704 (face font-lock-builtin-face fontified t) 1704 1707 (fontified t) 1707 1738 (fontified t) 1738 1759 (fontified t) 1759 1763 (fontified t) 1763 1768 (face font-lock-builtin-face fontified t) 1768 1771 (fontified t) 1771 1799 (fontified t) 1799 1802 (fontified t) 1802 1823 (fontified t) 1823 1827 (fontified t) 1827 1837 (face font-lock-builtin-face fontified t) 1837 1840 (fontified t) 1840 1871 (fontified t) 1871 1892 (fontified t) 1892 1896 (fontified t) 1896 1902 (face font-lock-builtin-face fontified t) 1902 1905 (fontified t) 1905 1936 (fontified t) 1936 1957 (fontified t) 1957 1961 (fontified t) 1961 1965 (face font-lock-builtin-face fontified t) 1965 1968 (fontified t) 1968 1999 (fontified t) 1999 2020 (fontified t) 2020 2024 (fontified t) 2024 2030 (face font-lock-builtin-face fontified t) 2030 2033 (fontified t) 2033 2064 (fontified t) 2064 2085 (fontified t) 2085 2089 (fontified t) 2089 2096 (face font-lock-builtin-face fontified t) 2096 2099 (fontified t) 2099 2119 (fontified t) 2119 2122 (face font-lock-comment-delimiter-face fontified t) 2122 2126 (face font-lock-comment-face fontified t) 2126 2135 (face font-lock-comment-face fontified t) 2135 2377 (fontified t) 2377 2409 (fontified t) 2409 2511 (fontified t) 2511 2512 (fontified t) 2512 2522 (fontified t) 2522 2552 (fontified t) 2552 2586 (fontified t) 2586 2602 (fontified t) 2602 2606 (face font-lock-keyword-face fontified t) 2606 2612 (fontified t) 2612 2624 (fontified t) 2624 2627 (face font-lock-comment-delimiter-face fontified t) 2627 2639 (face font-lock-comment-face fontified t) 2639 2697 (fontified t) 2697 2731 (fontified t) 2731 2750 (fontified t) 2750 2753 (face font-lock-keyword-face fontified t) 2753 2761 (fontified t) 2761 2763 (face font-lock-keyword-face fontified t) 2763 2770 (fontified t) 2770 2870 (fontified t) 2870 2884 (fontified t) 2884 2892 (face font-lock-builtin-face fontified t) 2892 2901 (fontified t) 2901 2943 (fontified t) 2943 2955 (fontified t) 2955 2961 (face font-lock-builtin-face fontified t) 2961 2968 (fontified t) 2968 3009 (fontified t) 3009 3017 (fontified t) 3017 3022 (fontified t) 3022 3026 (face font-lock-builtin-face fontified t) 3026 3031 (fontified t) 3031 3076 (fontified t) 3076 3085 (fontified t) 3085 3091 (face font-lock-builtin-face fontified t) 3091 3098 (fontified t) 3098 3112 (fontified t) 3112 3152 (fontified t) 3152 3153 (face font-lock-builtin-face fontified t) 3153 3158 (face font-lock-builtin-face fontified t) 3158 3205 (fontified t) 3205 3207 (fontified t) 3207 3212 (fontified t) 3212 3216 (fontified t) 3216 3259 (fontified t) 3259 3261 (face font-lock-builtin-face fontified t) 3261 3275 (face font-lock-builtin-face fontified t) 3275 3285 (fontified t) 3285 3309 (fontified t) 3309 3350 (fontified t) 3350 3356 (fontified t) 3356 3408 (fontified t) 3408 3409 (fontified t) 3409 3417 (face font-lock-builtin-face fontified t) 3417 3426 (fontified t) 3426 3456 (fontified t) 3456 3485 (fontified t) 3485 3491 (face font-lock-builtin-face fontified t) 3491 3498 (fontified t) 3498 3550 (fontified t) 3550 3557 (fontified t) 3557 3561 (face font-lock-builtin-face fontified t) 3561 3566 (fontified t) 3566 3599 (fontified t) 3599 3625 (fontified t) 3625 3632 (face font-lock-builtin-face fontified t) 3632 3635 (fontified t) 3635 3640 (fontified t) 3640 3699 (fontified t) 3699 3705 (face font-lock-builtin-face fontified t) 3705 3811 (fontified t) 3811 3827 (face font-lock-builtin-face fontified t) 3827 3841 (fontified t) 3841 3861 (fontified t) 3861 3879 (fontified t) 3879 3882 (fontified t) 3882 3899 (fontified t) 3899 3902 (face font-lock-comment-delimiter-face fontified t) 3902 3909 (face font-lock-comment-face fontified t) 3909 3920 (face font-lock-comment-face fontified t) 3920 3959 (fontified t) 3959 3963 (face font-lock-keyword-face fontified t) 3963 4011 (fontified t) 4011 4028 (fontified t) 4028 4082 (fontified t) 4082 4129 (fontified t) 4129 4286 (fontified t) 4286 4294 (face font-lock-builtin-face fontified t) 4294 4348 (fontified t) 4348 4354 (face font-lock-builtin-face fontified t) 4354 4397 (fontified t) 4397 4406 (fontified t) 4406 4413 (face font-lock-builtin-face fontified t) 4413 4425 (fontified t) 4425 4427 (face font-lock-builtin-face fontified t) 4427 4429 (fontified t) 4429 4464 (fontified t) 4464 4474 (fontified t) 4474 4480 (face font-lock-builtin-face fontified t) 4480 4491 (fontified t) 4491 4527 (fontified t) 4527 4531 (fontified t) 4531 4536 (fontified t) 4536 4543 (face font-lock-builtin-face fontified t) 4543 4551 (fontified t) 4551 4596 (fontified t) 4596 4598 (face font-lock-builtin-face fontified t) 4598 4612 (face font-lock-builtin-face fontified t) 4612 4623 (fontified t) 4623 4673 (fontified t) 4673 4681 (face font-lock-builtin-face fontified t) 4681 4693 (fontified t) 4693 4713 (fontified t) 4713 4733 (fontified t) 4733 4739 (face font-lock-builtin-face fontified t) 4739 4777 (fontified t) 4777 4783 (face font-lock-builtin-face fontified t) 4783 4785 (fontified t) 4785 4790 (fontified t) 4790 4795 (face font-lock-builtin-face fontified t) 4795 4801 (fontified t) 4801 4811 (face font-lock-builtin-face fontified t) 4811 4822 (fontified t) 4822 4853 (fontified t) 4853 4859 (face font-lock-builtin-face fontified t) 4859 4866 (fontified t) 4866 4874 (face font-lock-builtin-face fontified t) 4874 4883 (fontified t) 4883 4884 (fontified t rear-nonsticky t) 4884 4890 (fontified t) 4890 4900 (fontified t) 4900 4903 (face font-lock-comment-delimiter-face fontified t) 4903 4926 (face font-lock-comment-face fontified t) 4926 4944 (fontified t) 4944 4949 (fontified t) 4949 4952 (fontified t) 4952 4954 (fontified t) 4954 4958 (fontified t) 4958 4966 (fontified t) 4966 4969 (fontified t) 4969 4971 (fontified t) 4971 4975 (fontified t) 4975 4976 (fontified t) 4976 4987 (face font-lock-keyword-face fontified t) 4987 4991 (fontified t) 4991 4993 (fontified t) 4993 4999 (fontified t) 4999 5000 (fontified t) 5000 5004 (face font-lock-keyword-face fontified t) 5004 5013 (fontified t) 5013 5015 (fontified t) 5015 5021 (fontified t) 5021 5041 (fontified t) 5041 5049 (face font-lock-builtin-face fontified t) 5049 5067 (fontified t) 5067 5073 (face font-lock-builtin-face fontified t) 5073 5087 (fontified t) 5087 5088 (fontified t) 5088 5090 (face font-lock-keyword-face fontified t) 5090 5118 (fontified t) 5118 5119 (fontified t) 5119 5120 (face font-lock-keyword-face fontified t) 5120 5123 (face font-lock-keyword-face fontified t) 5123 5143 (fontified t) 5143 5148 (fontified t) 5148 5181 (fontified t) 5181 5198 (face font-lock-builtin-face fontified t) 5198 5212 (fontified t) 5212 5225 (face font-lock-builtin-face fontified t) 5225 5228 (fontified t) 5228 5233 (fontified t) 5233 5260 (fontified t) 5260 5272 (face font-lock-builtin-face fontified t) 5272 5273 (fontified t) 5273 5284 (face font-lock-builtin-face fontified t) 5284 5296 (fontified t) 5296 5308 (face font-lock-builtin-face fontified t) 5308 5309 (fontified t) 5309 5320 (face font-lock-builtin-face fontified t) 5320 5323 (fontified t) 5323 5328 (fontified t) 5328 5351 (fontified t) 5351 5358 (fontified t) 5358 5362 (face font-lock-keyword-face fontified t) 5362 5370 (fontified t) 5370 5376 (face font-lock-string-face fontified t) 5376 5387 (fontified t) 5387 5398 (fontified t) 5398 5399 (fontified t) 5399 5403 (face font-lock-keyword-face fontified t) 5403 5412 (fontified t) 5412 5427 (face font-lock-string-face fontified t) 5427 5429 (fontified t) 5429 5430 (fontified t) 5430 5456 (fontified t) 5456 5463 (fontified t) 5463 5481 (fontified t) 5481 5489 (face font-lock-builtin-face fontified t) 5489 5502 (fontified t) 5502 5515 (fontified t) 5515 5516 (fontified t rear-nonsticky t) 5516 5520 (fontified t) 5520 5528 (fontified t) 5528 5530 (fontified t) 5530 5533 (face font-lock-comment-delimiter-face fontified t) 5533 5558 (face font-lock-comment-face fontified t) 5558 5583 (fontified t) 5583 5586 (fontified t) 5586 5588 (fontified t) 5588 5599 (fontified t) 5599 5607 (fontified t) 5607 5610 (fontified t) 5610 5612 (fontified t) 5612 5616 (fontified t) 5616 5617 (fontified t) 5617 5621 (face font-lock-keyword-face fontified t) 5621 5633 (fontified t) 5633 5661 (fontified t) 5661 5665 (face font-lock-builtin-face fontified t) 5665 5666 (face font-lock-builtin-face fontified t rear-nonsticky t) 5666 5670 (fontified t) 5670 5676 (fontified t) 5676 5677 (fontified t) 5677 5689 (face font-lock-keyword-face fontified t) 5689 5693 (fontified t) 5693 5694 (fontified t) 5694 5701 (face font-lock-keyword-face fontified t) 5701 5710 (fontified t) 5710 5711 (fontified t) 5711 5715 (face font-lock-keyword-face fontified t) 5715 5734 (fontified t) 5734 5760 (fontified t) 5760 5790 (fontified t) 5790 5791 (fontified t) 5791 5810 (face font-lock-keyword-face fontified t) 5810 5824 (fontified t) 5824 5844 (fontified t) 5844 5854 (face font-lock-builtin-face fontified t) 5854 5867 (fontified t) 5867 5868 (fontified t) 5868 5875 (face font-lock-keyword-face fontified t) 5875 5897 (fontified t) 5897 5898 (fontified t) 5898 5902 (face font-lock-keyword-face fontified t) 5902 5951 (fontified t) 5951 5965 (face font-lock-comment-face fontified t) 5965 5974 (fontified t) 5974 6016 (fontified t) 6016 6017 (fontified t) 6017 6034 (face font-lock-builtin-face fontified t) 6034 6035 (fontified t) 6035 6048 (face font-lock-builtin-face fontified t) 6048 6051 (fontified t) 6051 6060 (fontified t) 6060 6088 (fontified t) 6088 6100 (face font-lock-builtin-face fontified t) 6100 6101 (fontified t) 6101 6112 (face font-lock-builtin-face fontified t) 6112 6122 (fontified t) 6122 6134 (face font-lock-builtin-face fontified t) 6134 6135 (fontified t) 6135 6146 (face font-lock-builtin-face fontified t) 6146 6149 (fontified t) 6149 6158 (fontified t) 6158 6176 (fontified t) 6176 6183 (face font-lock-string-face fontified t) 6183 6201 (fontified t) 6201 6204 (face font-lock-builtin-face fontified t) 6204 6223 (fontified t) 6223 6250 (fontified t) 6250 6257 (fontified t) 6257 6261 (face font-lock-keyword-face fontified t) 6261 6269 (fontified t) 6269 6275 (face font-lock-string-face fontified t) 6275 6294 (fontified t) 6294 6295 (fontified t) 6295 6299 (face font-lock-keyword-face fontified t) 6299 6308 (fontified t) 6308 6322 (face font-lock-string-face fontified t) 6322 6323 (face font-lock-string-face fontified t) 6323 6352 (fontified t) 6352 6356 (fontified t) 6356 6374 (fontified t) 6374 6383 (face font-lock-builtin-face fontified t) 6383 6388 (fontified t) 6388 6396 (face font-lock-builtin-face fontified t) 6396 6415 (fontified t) 6415 6418 (face font-lock-comment-delimiter-face fontified t) 6418 6463 (face font-lock-comment-face fontified t) 6463 6471 (fontified t) 6471 6494 (fontified t) 6494 6496 (fontified t) 6496 6509 (fontified t) 6509 6517 (face font-lock-builtin-face fontified t) 6517 6523 (fontified t) 6523 6535 (fontified t) 6535 6541 (fontified t) 6541 6550 (fontified t) 6550 6557 (face font-lock-builtin-face fontified t) 6557 6591 (fontified t) 6591 6592 (fontified t) 6592 6597 (face font-lock-warning-face fontified t) 6597 6605 (fontified t) 6605 6606 (fontified t) 6606 6613 (face font-lock-keyword-face fontified t) 6613 6629 (fontified t) 6629 6644 (fontified t) 6644 6645 (fontified t rear-nonsticky t) 6645 6647 (fontified t) 6647 6657 (fontified t) 6657 6660 (face font-lock-comment-delimiter-face fontified t) 6660 6663 (face font-lock-comment-face fontified t) 6663 6684 (face font-lock-comment-face fontified t) 6684 6708 (fontified t) 6708 6711 (fontified t) 6711 6713 (fontified t) 6713 6724 (fontified t) 6724 6732 (fontified t) 6732 6735 (fontified t) 6735 6737 (fontified t) 6737 6741 (fontified t) 6741 6742 (fontified t) 6742 6754 (face font-lock-keyword-face fontified t) 6754 6755 (fontified t) 6755 6763 (fontified t) 6763 6764 (fontified t) 6764 6775 (face font-lock-keyword-face fontified t) 6775 6779 (fontified t) 6779 6780 (fontified t rear-nonsticky t) 6780 6781 (fontified t) 6781 6789 (fontified t) 6789 6790 (fontified t) 6790 6797 (face font-lock-keyword-face fontified t) 6797 6801 (fontified t) 6801 6804 (fontified t) 6804 6805 (fontified t) 6805 6809 (face font-lock-keyword-face fontified t) 6809 6818 (fontified t) 6818 6820 (fontified t) 6820 6823 (fontified t) 6823 6833 (fontified t) 6833 6861 (fontified t) 6861 6865 (face font-lock-builtin-face fontified t) 6865 6866 (face font-lock-builtin-face fontified t rear-nonsticky t) 6866 6869 (fontified t) 6869 6872 (fontified t) 6872 6892 (fontified t) 6892 6900 (face font-lock-builtin-face fontified t) 6900 6918 (fontified t) 6918 6924 (face font-lock-builtin-face fontified t) 6924 6935 (fontified t) 6935 6936 (fontified t) 6936 6938 (face font-lock-keyword-face fontified t) 6938 6959 (fontified t) 6959 6982 (fontified t) 6982 6983 (fontified t) 6983 6987 (face font-lock-keyword-face fontified t) 6987 7008 (fontified t) 7008 7012 (fontified t) 7012 7034 (fontified t) 7034 7037 (fontified t) 7037 7042 (fontified t) 7042 7059 (face font-lock-builtin-face fontified t) 7059 7060 (fontified t) 7060 7073 (face font-lock-builtin-face fontified t) 7073 7074 (fontified t) 7074 7087 (fontified t) 7087 7099 (face font-lock-builtin-face fontified t) 7099 7100 (fontified t) 7100 7111 (face font-lock-builtin-face fontified t) 7111 7125 (fontified t) 7125 7137 (face font-lock-builtin-face fontified t) 7137 7138 (fontified t) 7138 7149 (face font-lock-builtin-face fontified t) 7149 7151 (fontified t) 7151 7155 (fontified t) 7155 7156 (fontified t) 7156 7160 (face font-lock-keyword-face fontified t) 7160 7197 (fontified t) 7197 7200 (fontified t) 7200 7203 (face font-lock-comment-delimiter-face fontified t) 7203 7234 (face font-lock-comment-face fontified t) 7234 7246 (face font-lock-comment-face fontified t) 7246 7252 (fontified t) 7252 7253 (fontified t) 7253 7259 (face font-lock-keyword-face fontified t) 7259 7281 (fontified t) 7281 7282 (fontified t) 7282 7286 (face font-lock-keyword-face fontified t) 7286 7311 (fontified t) 7311 7334 (fontified t) 7334 7375 (fontified t) 7375 7384 (fontified t) 7384 7419 (fontified t) 7419 7425 (fontified t) 7425 7454 (fontified t) 7454 7455 (fontified t) 7455 7474 (face font-lock-keyword-face fontified t) 7474 7494 (fontified t) 7494 7514 (fontified t) 7514 7520 (face font-lock-builtin-face fontified t) 7520 7523 (fontified t) 7523 7533 (face font-lock-builtin-face fontified t) 7533 7545 (fontified t) 7545 7546 (fontified t) 7546 7551 (face font-lock-keyword-face fontified t) 7551 7553 (face font-lock-keyword-face fontified t) 7553 7566 (fontified t) 7566 7574 (fontified t) 7574 7575 (fontified t) 7575 7579 (face font-lock-keyword-face fontified t) 7579 7628 (fontified t) 7628 7636 (fontified t) 7636 7678 (fontified t) 7678 7695 (face font-lock-builtin-face fontified t) 7695 7696 (fontified t) 7696 7709 (face font-lock-builtin-face fontified t) 7709 7712 (fontified t) 7712 7720 (fontified t) 7720 7743 (fontified t) 7743 7757 (fontified t) 7757 7769 (face font-lock-builtin-face fontified t) 7769 7770 (fontified t) 7770 7781 (face font-lock-builtin-face fontified t) 7781 7789 (fontified t) 7789 7801 (face font-lock-builtin-face fontified t) 7801 7802 (fontified t) 7802 7813 (face font-lock-builtin-face fontified t) 7813 7816 (fontified t) 7816 7824 (fontified t) 7824 7850 (fontified t) 7850 7852 (fontified t) 7852 7857 (fontified t) 7857 7861 (face font-lock-keyword-face fontified t) 7861 7869 (fontified t) 7869 7875 (face font-lock-string-face fontified t) 7875 7886 (fontified t) 7886 7893 (fontified t) 7893 7894 (fontified t) 7894 7898 (face font-lock-keyword-face fontified t) 7898 7907 (fontified t) 7907 7922 (face font-lock-string-face fontified t) 7922 7961 (fontified t) 7961 7980 (fontified t) 7980 7988 (face font-lock-builtin-face fontified t) 7988 8008 (fontified t) 8008 8034 (fontified t) 8034 8066 (face font-lock-comment-face fontified t) 8066 8068 (fontified t) 8068 8074 (fontified t) 8074 8076 (face font-lock-comment-delimiter-face fontified t) 8076 8077 (face font-lock-comment-face fontified t) 8077 8084 (face font-lock-comment-face fontified t) 8084 8097 (face font-lock-comment-face fontified t) 8097 8105 (fontified t) 8105 8122 (fontified t) 8122 8128 (face font-lock-builtin-face fontified t) 8128 8133 (fontified t) 8133 8138 (face font-lock-builtin-face fontified t) 8138 8141 (fontified t) 8141 8162 (face font-lock-string-face fontified t) 8162 8175 (fontified t) 8175 8182 (face font-lock-builtin-face fontified t) 8182 8195 (fontified t) 8195 8225 (fontified t) 8225 8238 (fontified t) 8238 8246 (face font-lock-builtin-face fontified t) 8246 8264 (fontified t) 8264 8270 (fontified t) 8270 8277 (fontified t) 8277 8284 (face font-lock-builtin-face fontified t) 8284 8303 (fontified t) 8303 8305 (fontified t) 8305 8310 (fontified t) 8310 8316 (fontified t) 8316 8317 (fontified t) 8317 8320 (face font-lock-warning-face fontified t) 8320 8322 (face font-lock-warning-face fontified t) 8322 8327 (fontified t) 8327 8335 (fontified t) 8335 8337 (face font-lock-comment-delimiter-face fontified t) 8337 8338 (face font-lock-comment-face fontified t) 8338 8345 (face font-lock-comment-face fontified t) 8345 8357 (face font-lock-comment-face fontified t) 8357 8358 (face font-lock-comment-face fontified t) 8358 8366 (fontified t) 8366 8373 (fontified t) 8373 8380 (fontified t) 8380 8381 (fontified t rear-nonsticky t) 8381 8384 (fontified t) 8384 8394 (fontified t) 8394 8397 (face font-lock-comment-delimiter-face fontified t) 8397 8422 (face font-lock-comment-face fontified t) 8422 8447 (fontified t) 8447 8450 (fontified t) 8450 8452 (fontified t) 8452 8463 (fontified t) 8463 8471 (fontified t) 8471 8474 (fontified t) 8474 8476 (fontified t) 8476 8480 (fontified t) 8480 8481 (fontified t) 8481 8493 (face font-lock-keyword-face fontified t) 8493 8494 (fontified t) 8494 8502 (fontified t) 8502 8503 (fontified t) 8503 8514 (face font-lock-keyword-face fontified t) 8514 8518 (fontified t) 8518 8519 (fontified t rear-nonsticky t) 8519 8520 (fontified t) 8520 8528 (fontified t) 8528 8529 (fontified t) 8529 8536 (face font-lock-keyword-face fontified t) 8536 8540 (fontified t) 8540 8543 (fontified t) 8543 8544 (fontified t) 8544 8548 (face font-lock-keyword-face fontified t) 8548 8557 (fontified t) 8557 8559 (fontified t) 8559 8562 (fontified t) 8562 8582 (fontified t) 8582 8590 (face font-lock-builtin-face fontified t) 8590 8608 (fontified t) 8608 8614 (face font-lock-builtin-face fontified t) 8614 8625 (fontified t) 8625 8626 (fontified t) 8626 8628 (face font-lock-keyword-face fontified t) 8628 8649 (fontified t) 8649 8672 (fontified t) 8672 8673 (fontified t) 8673 8676 (face font-lock-keyword-face fontified t) 8676 8697 (fontified t) 8697 8701 (fontified t) 8701 8723 (fontified t) 8723 8726 (fontified t) 8726 8731 (fontified t) 8731 8748 (face font-lock-builtin-face fontified t) 8748 8749 (fontified t) 8749 8762 (face font-lock-builtin-face fontified t) 8762 8763 (fontified t) 8763 8776 (fontified t) 8776 8788 (face font-lock-builtin-face fontified t) 8788 8789 (fontified t) 8789 8800 (face font-lock-builtin-face fontified t) 8800 8814 (fontified t) 8814 8826 (face font-lock-builtin-face fontified t) 8826 8827 (fontified t) 8827 8838 (face font-lock-builtin-face fontified t) 8838 8840 (fontified t) 8840 8844 (fontified t) 8844 8845 (fontified t) 8845 8848 (face font-lock-keyword-face fontified t) 8848 8888 (fontified t) 8888 8915 (fontified t) 8915 8935 (fontified t) 8935 8943 (face font-lock-builtin-face fontified t) 8943 8946 (fontified t) 8946 8949 (face font-lock-builtin-face fontified t) 8949 8967 (fontified t) 8967 8992 (fontified t) 8992 9000 (fontified t) 9000 9002 (face font-lock-comment-delimiter-face fontified t) 9002 9003 (face font-lock-comment-face fontified t) 9003 9010 (face font-lock-comment-face fontified t) 9010 9023 (face font-lock-comment-face fontified t) 9023 9031 (fontified t) 9031 9048 (fontified t) 9048 9054 (face font-lock-builtin-face fontified t) 9054 9059 (fontified t) 9059 9064 (face font-lock-builtin-face fontified t) 9064 9066 (fontified t) 9066 9067 (fontified t) 9067 9088 (face font-lock-string-face fontified t) 9088 9093 (fontified t) 9093 9101 (fontified t) 9101 9108 (face font-lock-builtin-face fontified t) 9108 9121 (fontified t) 9121 9122 (fontified t) 9122 9127 (face font-lock-warning-face fontified t) 9127 9132 (fontified t) 9132 9140 (fontified t) 9140 9142 (face font-lock-comment-delimiter-face fontified t) 9142 9143 (face font-lock-comment-face fontified t) 9143 9150 (face font-lock-comment-face fontified t) 9150 9163 (face font-lock-comment-face fontified t) 9163 9171 (fontified t) 9171 9185 (fontified t) 9185 9186 (fontified t rear-nonsticky t) 9186 9189 (fontified t) 9189 9193 (fontified t) 9193 9199 (fontified t) 9199 9202 (face font-lock-comment-delimiter-face fontified t) 9202 9214 (face font-lock-comment-face fontified t) 9214 9267 (face font-lock-comment-face fontified t) 9267 9273 (fontified t) 9273 9276 (face font-lock-comment-delimiter-face fontified t) 9276 9291 (face font-lock-comment-face fontified t) 9291 9324 (fontified t) 9324 9328 (face font-lock-string-face fontified t) 9328 9341 (fontified t) 9341 9344 (fontified t) 9344 9360 (fontified t) 9360 9363 (fontified t) 9363 9366 (fontified t) 9366 9372 (fontified t) 9372 9375 (face font-lock-comment-delimiter-face fontified t) 9375 9383 (face font-lock-comment-face fontified t) 9383 9386 (face font-lock-comment-face fontified t) 9386 9394 (face font-lock-comment-face fontified t) 9394 9417 (fontified t) 9417 9427 (fontified t) 9427 9431 (face font-lock-string-face fontified t) 9431 9444 (fontified t) 9444 9447 (fontified t) 9447 9458 (fontified t) 9458 9462 (fontified t) 9462 9465 (fontified t) 9465 9468 (fontified t) 9468 9470 (fontified t) 9470 9474 (fontified t) 9474 9477 (face font-lock-comment-delimiter-face fontified t) 9477 9482 (face font-lock-comment-face fontified t) 9482 9493 (face font-lock-comment-face fontified t) 9493 9494 (fontified t) 9494 9526 (fontified t) 9526 9530 (face font-lock-string-face fontified t) 9530 9543 (fontified t) 9543 9546 (fontified t) 9546 9561 (fontified t) 9561 9563 (fontified t) 9563 9566 (fontified t) 9566 9569 (fontified t) 9569 9575 (fontified t) 9575 9578 (face font-lock-comment-delimiter-face fontified t) 9578 9599 (face font-lock-comment-face fontified t) 9599 9603 (fontified t) 9603 9612 (fontified t) 9612 9627 (fontified t) 9627 9633 (fontified t) 9633 9637 (face font-lock-string-face fontified t) 9637 9650 (fontified t) 9650 9653 (fontified t) 9653 9669 (fontified t) 9669 9672 (fontified t) 9672 9675 (fontified t) 9675 9681 (fontified t) 9681 9684 (face font-lock-comment-delimiter-face fontified t) 9684 9706 (face font-lock-comment-face fontified t) 9706 9731 (fontified t) 9731 9741 (fontified t) 9741 9745 (face font-lock-string-face fontified t) 9745 9758 (fontified t) 9758 9761 (fontified t) 9761 9771 (fontified t) 9771 9778 (fontified t) 9778 9781 (fontified t) 9781 9784 (fontified t) 9784 9785 (fontified t) 9785 9790 (fontified t) 9790 9793 (face font-lock-comment-delimiter-face fontified t) 9793 9827 (face font-lock-comment-face fontified t) 9827 9831 (face font-lock-comment-face fontified t) 9831 9832 (fontified t) 9832 9862 (fontified t) 9862 9866 (fontified t)) . -19119) (undo-tree-id266 . -1011) (undo-tree-id267 . -1011) (undo-tree-id268 . -9866) (undo-tree-id269 . -8476) 28985) nil (26806 3836 69152 0) 0 nil])
([nil nil ((19119 . 19120)) nil (26806 3836 69146 0) 0 nil])
([nil nil ((#(")" 0 1 (fontified t)) . -19119) (undo-tree-id265 . -1) 19120) nil (26806 3836 69142 0) 0 nil])
([nil nil ((885 . 891) (t 26806 3836 0 0)) nil (26806 46357 609596 0) 0 nil])
([nil nil ((923 . 925) (#(" " 0 1 (fontified nil)) . 923) (922 . 923)) nil (26806 46357 609595 0) 0 nil])
([nil nil ((#("
  " 0 1 (fontified t) 1 3 (fontified t)) . -945) (undo-tree-id2 . -3) 948) nil (26806 46357 609594 0) 0 nil])
([nil nil ((13765 . 13772) (#(" " 0 1 (fontified nil)) . 13765) (13764 . 13765)) nil (26806 46357 609592 0) 0 nil])
([nil nil ((16309 . 16316) (#(" " 0 1 (fontified nil)) . 16308) (undo-tree-id0 . -1) (undo-tree-id1 . -1) (16309 . 16310)) nil (26806 46357 609589 0) 0 nil])
([nil nil ((19139 . 19140) (t 26806 46357 0 0)) nil (26806 47201 695122 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 23250 . 23251) (nil fontified nil 19140 . 23251) (19140 . 23251)) nil (26806 47201 695121 0) 0 nil])
([nil nil ((19820 . 19825)) nil (26806 47201 695121 0) 0 nil])
([nil nil ((20480 . 20488) (#(" " 0 1 (fontified nil)) . 20479) (undo-tree-id51 . -1) (20480 . 20481)) nil (26806 47201 695120 0) 0 nil])
([nil nil ((20652 . 20661) (#(" " 0 1 (fontified nil)) . 20651) (undo-tree-id50 . -1) (20652 . 20653)) nil (26806 47201 695119 0) 0 nil])
([nil nil ((#("
" 0 1 (fontified t)) . 20709)) nil (26806 47201 695118 0) 0 nil])
([nil nil ((#("                        " 0 24 (fontified nil)) . -20740) (20709 . 20710)) nil (26806 47201 695118 0) 0 nil])
([nil nil ((#("
                                                         " 0 1 (fontified t) 1 58 (fontified t)) . -20759) (undo-tree-id49 . -58) 20817) nil (26806 47201 695117 0) 0 nil])
([nil nil ((20794 . 20804)) nil (26806 47201 695116 0) 0 nil])
([nil nil ((20760 . 20766) (#(" " 0 1 (fontified nil)) . 20759) (undo-tree-id48 . -1) (20760 . 20761)) nil (26806 47201 695116 0) 0 nil])
([nil nil ((#("
							  
                                                                 " 0 1 (fontified t) 1 11 (fontified t) 11 76 (fontified t)) . -20800) (undo-tree-id47 . -76) 20876) nil (26806 47201 695115 0) 0 nil])
([nil nil ((#(" " 0 1 (fontified t)) . 20800)) nil (26806 47201 695114 0) 0 nil])
([nil nil ((20800 . 20808)) nil (26806 47201 695114 0) 0 nil])
([nil nil ((21446 . 21447)) nil (26806 47201 695113 0) 0 nil])
([nil nil ((21447 . 21451)) nil (26806 47201 695113 0) 0 nil])
([nil nil ((22249 . 22254)) nil (26806 47201 695113 0) 0 nil])
([nil nil ((22642 . 22645)) nil (26806 47201 695112 0) 0 nil])
([nil nil ((#("r" 0 1 (fontified t)) . -22644) (undo-tree-id46 . -1) 22645) nil (26806 47201 695112 0) 0 nil])
([nil nil ((22644 . 22647)) nil (26806 47201 695111 0) 0 nil])
([nil nil ((22966 . 22971)) nil (26806 47201 695111 0) 0 nil])
([nil nil ((20237 . 20244)) nil (26806 47201 695111 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 20684 . 20685) (nil fontified nil 20624 . 20685) (nil fontified nil 20602 . 20624) (nil fontified nil 20599 . 20602) (nil fontified nil 20531 . 20599) (nil fontified nil 20510 . 20531) (nil fontified nil 20507 . 20510) (nil fontified nil 20438 . 20507) (nil fontified nil 20422 . 20438) (nil fontified nil 20419 . 20422) (nil fontified nil 20352 . 20419) (nil fontified nil 20333 . 20352) (nil fontified nil 20330 . 20333) (nil fontified nil 20262 . 20330) (nil fontified nil 20247 . 20262) (nil fontified nil 20244 . 20247) (20244 . 20685)) nil (26806 47201 695110 0) 0 nil])
([nil nil ((#("(defroute GET   list-spec (req) (handle-index req))
        ;; GET /api/<seg>/:id
        (defroute GET   item-spec (req) (handle-show req))
        ;; POST /api/<seg>
        (defroute POST  list-spec (req) (handle-create req))
        ;; PATCH /api/<seg>/:id
        (defroute PATCH item-spec (req) (handle-patch req))
        ;; DELETE /api/<seg>/:id
        (defroute DELETE item-spec (req) (handle-delete req))" 0 60 (fontified t) 60 63 (face font-lock-comment-delimiter-face fontified t) 63 82 (face font-lock-comment-face fontified t) 82 149 (fontified t) 149 152 (face font-lock-comment-delimiter-face fontified t) 152 168 (face font-lock-comment-face fontified t) 168 237 (fontified t) 237 240 (face font-lock-comment-delimiter-face fontified t) 240 261 (face font-lock-comment-face fontified t) 261 329 (fontified t) 329 332 (face font-lock-comment-delimiter-face fontified t) 332 354 (face font-lock-comment-face fontified t) 354 414 (fontified t) 414 415 (rear-nonsticky t fontified t)) . 20270) (undo-tree-id45 . -415) 20685) nil (26806 47201 695108 0) 0 nil])
([nil nil ((#("
" 0 1 (face font-lock-comment-face fontified t)) . 20261)) nil (26806 47201 695107 0) 0 nil])
([nil nil ((20251 . 20256)) nil (26806 47201 695107 0) 0 nil])
([nil nil ((#("i" 0 1 (face font-lock-comment-face fontified t)) . -20254) (undo-tree-id43 . -1) (#("s" 0 1 (face font-lock-comment-face fontified t)) . -20255) (undo-tree-id44 . -1) 20256) nil (26806 47201 695106 0) 0 nil])
([nil nil ((20254 . 20257)) nil (26806 47201 695105 0) 0 nil])
([nil nil ((20257 . 20258)) nil (26806 47201 695104 0) 0 nil])
([nil nil ((20258 . 20261)) nil (26806 47201 695104 0) 0 nil])
([nil nil ((20261 . 20262)) nil (26806 47201 695104 0) 0 nil])
([nil nil ((20262 . 20266)) nil (26806 47201 695103 0) 0 nil])
([nil nil ((20266 . 20267)) nil (26806 47201 695103 0) 0 nil])
([nil nil ((20267 . 20268)) nil (26806 47201 695103 0) 0 nil])
([nil nil ((20286 . 20287)) nil (26806 47201 695102 0) 0 nil])
([nil nil ((#(" " 0 1 (face font-lock-comment-face fontified t)) . -20278) (undo-tree-id26 . -1) (undo-tree-id27 . -1) (#(" " 0 1 (face font-lock-comment-face fontified t)) . -20279) (undo-tree-id28 . -1) (undo-tree-id29 . -1) (#(" " 0 1 (face font-lock-comment-face fontified t)) . -20280) (undo-tree-id30 . -1) (undo-tree-id31 . -1) (#(" " 0 1 (face font-lock-comment-face fontified t)) . -20281) (undo-tree-id32 . -1) (undo-tree-id33 . -1) (#(" " 0 1 (face font-lock-comment-face fontified t)) . -20282) (undo-tree-id34 . -1) (undo-tree-id35 . -1) (#(" " 0 1 (face font-lock-comment-face fontified t)) . -20283) (undo-tree-id36 . -1) (undo-tree-id37 . -1) (#(" " 0 1 (face font-lock-comment-face fontified t)) . -20284) (undo-tree-id38 . -1) (undo-tree-id39 . -1) (#(" " 0 1 (face font-lock-comment-face fontified t)) . -20285) (undo-tree-id40 . -1) (undo-tree-id41 . -1) (#(")" 0 1 (face font-lock-comment-face fontified t)) . -20286) (undo-tree-id42 . -1) 20287) nil (26806 47201 695101 0) 0 nil])
([nil nil ((20278 . 20279)) nil (26806 47201 695095 0) 0 nil])
([nil nil ((21696 . 21703)) nil (26806 47201 695094 0) 0 nil])
([nil nil ((nil fontified nil 22117 . 22118) (nil fontified nil 22057 . 22117) (nil fontified nil 22035 . 22057) (nil fontified nil 22032 . 22035) (nil fontified nil 21964 . 22032) (nil fontified nil 21943 . 21964) (nil fontified nil 21940 . 21943) (nil fontified nil 21871 . 21940) (nil fontified nil 21855 . 21871) (nil fontified nil 21852 . 21855) (nil fontified nil 21785 . 21852) (nil fontified nil 21766 . 21785) (nil fontified nil 21763 . 21766) (nil fontified nil 21703 . 21763) (21703 . 22118)) nil (26806 47201 695093 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 21786 . 21787) (nil fontified nil 21770 . 21787) (21770 . 21787)) nil (26806 47201 695092 0) 0 nil])
([nil nil ((21801 . 21802)) nil (26806 47201 695091 0) 0 nil])
([nil nil ((#("(defroute GET   list-spec (req) (handle-index req))
       " 0 52 (fontified t) 52 59 (fontified t)) . -21703) (undo-tree-id25 . -59) 21762) nil (26806 47201 695091 0) 0 nil])
([nil nil ((#(" " 0 1 (fontified t)) . 21703)) nil (26806 47201 695089 0) 0 nil])
([nil nil ((#("(defroute GET   item-spec (req) (handle-show req))
        ;; POST /api/<seg>
        (defroute POST  list-spec (req) (handle-create req))
        ;; PATCH /api/<seg>/:id
        (defroute PATCH item-spec (req) (handle-patch req))
        ;; DELETE /api/<seg>/:id
        (defroute DELETE item-spec (req) (handle-delete req))" 0 59 (fontified t) 59 62 (face font-lock-comment-delimiter-face fontified t) 62 78 (face font-lock-comment-face fontified t) 78 147 (fontified t) 147 150 (face font-lock-comment-delimiter-face fontified t) 150 171 (face font-lock-comment-face fontified t) 171 239 (fontified t) 239 242 (face font-lock-comment-delimiter-face fontified t) 242 264 (face font-lock-comment-face fontified t) 264 324 (fontified t) 324 325 (fontified t rear-nonsticky t)) . 21751) (undo-tree-id23 . -325) (undo-tree-id24 . -325) 22076) nil (26806 47201 695089 0) 0 nil])
([nil nil ((#("
" 0 1 (face font-lock-comment-face fontified t)) . 21742)) nil (26806 47201 695087 0) 0 nil])
([nil nil ((22117 . 22124)) nil (26806 47201 695087 0) 0 nil])
([nil nil ((nil fontified nil 22448 . 22449) (nil fontified nil 22388 . 22448) (nil fontified nil 22366 . 22388) (nil fontified nil 22363 . 22366) (nil fontified nil 22295 . 22363) (nil fontified nil 22274 . 22295) (nil fontified nil 22271 . 22274) (nil fontified nil 22202 . 22271) (nil fontified nil 22186 . 22202) (nil fontified nil 22183 . 22186) (nil fontified nil 22124 . 22183) (22124 . 22449)) nil (26806 47201 695086 0) 0 nil])
([nil nil ((#("(defroute GET   item-spec (req) (handle-show req))
        " 0 59 (fontified t)) . -22124) (undo-tree-id22 . -59) 22183) nil (26806 47201 695085 0) 0 nil])
([nil nil ((nil fontified nil 22148 . 22149) (nil fontified nil 22132 . 22148) (22132 . 22149)) nil (26806 47201 695082 0) 0 nil])
([nil nil ((22159 . 22160)) nil (26806 47201 695081 0) 0 nil])
([nil nil ((#("
        (defroute POST  list-spec (req) (handle-create req))
        ;; PATCH /api/<seg>/:id
        (defroute PATCH item-spec (req) (handle-patch req))
        ;; DELETE /api/<seg>/:id
        (defroute DELETE item-spec (req) (handle-delete req))" 0 1 (face font-lock-comment-face fontified t) 1 70 (fontified t) 70 73 (face font-lock-comment-delimiter-face fontified t) 73 94 (face font-lock-comment-face fontified t) 94 162 (fontified t) 162 165 (face font-lock-comment-delimiter-face fontified t) 165 187 (face font-lock-comment-face fontified t) 187 247 (fontified t) 247 248 (fontified t rear-nonsticky t)) . 22160) (undo-tree-id21 . -248) 22408) nil (26806 47201 695081 0) 0 nil])
([nil nil ((nil fontified nil 22749 . 22750) (nil fontified nil 22689 . 22749) (nil fontified nil 22667 . 22689) (nil fontified nil 22664 . 22667) (nil fontified nil 22596 . 22664) (nil fontified nil 22575 . 22596) (nil fontified nil 22572 . 22575) (nil fontified nil 22503 . 22572) (nil fontified nil 22502 . 22503) (22502 . 22750)) nil (26806 47201 695080 0) 0 nil])
([nil nil ((#("(defroute POST  list-spec (req) (handle-create req))
        " 0 61 (fontified t)) . -22511) (undo-tree-id20 . -61) 22572) nil (26806 47201 695079 0) 0 nil])
([nil nil ((#(" " 0 1 (fontified t)) . -22509) (undo-tree-id16 . -1) (undo-tree-id17 . -1) (#(" " 0 1 (fontified t)) . -22510) (undo-tree-id18 . -1) (undo-tree-id19 . -1) 22511) nil (26806 47201 695077 0) 0 nil])
([nil nil ((nil fontified nil 22534 . 22535) (nil fontified nil 22518 . 22534) (22518 . 22535)) nil (26806 47201 695075 0) 0 nil])
([nil nil ((22549 . 22550)) nil (26806 47201 695075 0) 0 nil])
([nil nil ((#("(defroute PATCH item-spec (req) (handle-patch req))
        ;; DELETE /api/<seg>/:id
        (defroute DELETE item-spec (req) (handle-delete req))" 0 60 (fontified t) 60 63 (face font-lock-comment-delimiter-face fontified t) 63 85 (face font-lock-comment-face fontified t) 85 145 (fontified t) 145 146 (fontified t rear-nonsticky t)) . 22559) (undo-tree-id15 . -146) 22705) nil (26806 47201 695074 0) 0 nil])
([nil nil ((#("
" 0 1 (face font-lock-comment-face fontified t)) . 22550)) nil (26806 47201 695073 0) 0 nil])
([nil nil ((22940 . 22941) (22929 . 22930) (#("      " 0 6 (fontified nil)) . 22929) (22944 . 22945)) nil (26806 47201 695073 0) 0 nil])
([nil nil ((nil fontified nil 23086 . 23087) (nil fontified nil 23026 . 23086) (nil fontified nil 23004 . 23026) (nil fontified nil 23001 . 23004) (nil fontified nil 22941 . 23001) (22941 . 23087)) nil (26806 47201 695072 0) 0 nil])
([nil nil ((#("(defroute PATCH item-spec (req) (handle-patch req))
        " 0 60 (fontified t)) . -22941) (undo-tree-id14 . -60) 23001) nil (26806 47201 695071 0) 0 nil])
([nil nil ((nil fontified nil 22967 . 22968) (nil fontified nil 22951 . 22967) (22951 . 22968)) nil (26806 47201 695070 0) 0 nil])
([nil nil ((22982 . 22983)) nil (26806 47201 695069 0) 0 nil])
([nil nil ((#("(defroute DELETE item-spec (req) (handle-delete req))
      " 0 52 (fontified t) 52 53 (fontified t rear-nonsticky t) 53 54 (fontified t) 54 60 (fontified t)) . -22992) (undo-tree-id13 . -60) 23052) nil (26806 47201 695069 0) 0 nil])
([nil nil ((22927 . 22928)) nil (26806 47201 695068 0) 0 nil])
([nil nil ((23020 . 23030) (#("            " 0 12 (fontified t)) . 23020) (22956 . 22964) (#("                 " 0 5 (fontified t) 5 17 (fontified t)) . 22956) (22915 . 22923) (#("          " 0 10 (fontified t)) . 22915) (22873 . 22879) (#("        " 0 8 (fontified t)) . 22873) (22854 . 22860) (#("        " 0 1 (fontified t) 1 8 (fontified t)) . 22854) (#("  " 0 2 (fontified t)) . -22790) (undo-tree-id9 . -2) (undo-tree-id10 . -2) (undo-tree-id11 . -2) (#("	" 0 1 (face font-lock-comment-face fontified nil)) . -22741) (22741 . 22742) (#("	" 0 1 (fontified nil)) . 22741) (undo-tree-id12 . -1) (22735 . 22741) (#("	" 0 1 (fontified nil)) . -22725) (22725 . 22726) (#("	" 0 1 (fontified nil)) . 22725) (22719 . 22725) (22670 . 22680) (#("            " 0 12 (fontified t)) . 22670) (22599 . 22607) (#("                 " 0 17 (fontified t)) . 22599) (22545 . 22553) (#("                 " 0 17 (fontified t)) . 22545) (22504 . 22512) (#("          " 0 10 (fontified t)) . 22504) (22462 . 22468) (#("        " 0 8 (fontified t)) . 22462) (22443 . 22449) (#("        " 0 8 (fontified t)) . 22443) (22245 . 22253) (#("          " 0 10 (fontified t)) . 22245) (22178 . 22184) (#("               " 0 15 (fontified t)) . 22178) (22126 . 22132) (#("               " 0 2 (fontified t) 2 15 (fontified t)) . 22126) (22087 . 22093) (#("        " 0 8 (fontified t)) . 22087) (22068 . 22074) (#("        " 0 8 (fontified t)) . 22068) (21899 . 21906) (#("                    " 0 17 (fontified t) 17 20 (fontified t)) . 21899) (21846 . 21856) (#("            " 0 4 (fontified t) 4 12 (fontified t)) . 21846) (21789 . 21797) (#("                 " 0 17 (fontified t)) . 21789) (21748 . 21756) (#("          " 0 10 (fontified t)) . 21748) (21706 . 21712) (#("        " 0 8 (fontified t)) . 21706) (21687 . 21693) (#("        " 0 8 (fontified t)) . 21687) (21496 . 21510) (#("             " 0 13 (fontified t)) . 21496) (21441 . 21455) (#("             " 0 13 (fontified t)) . 21441) (21382 . 21396) (#("             " 0 13 (fontified t)) . 21382) (21329 . 21338) (#("           " 0 11 (fontified t)) . 21329) (21291 . 21299) (#("          " 0 10 (fontified t)) . 21291) (21223 . 21229) (#("               " 0 15 (fontified t)) . 21223) (21152 . 21158) (#("               " 0 5 (fontified t) 5 15 (fontified t)) . 21152) (21086 . 21092) (#("               " 0 15 (fontified t)) . 21086) (21012 . 21018) (#("               " 0 15 (fontified t)) . 21012) (20939 . 20945) (#("               " 0 15 (fontified t)) . 20939) (20877 . 20883) (#("               " 0 15 (fontified t)) . 20877) (20831 . 20844) (#("                             " 0 29 (fontified t)) . 20831) (20783 . 20790) (#("  " 0 2 (fontified t)) . 20783) (20736 . 20743) (#("  " 0 2 (fontified t)) . 20736) (20705 . 20712) (#("                              " 0 30 (fontified t)) . 20705) (20652 . 20656) (#("      " 0 6 (fontified t)) . 20652) (20604 . 20610) (#("               " 0 15 (fontified t)) . 20604) (20536 . 20542) (#("               " 0 15 (fontified t)) . 20536) (20493 . 20503) (#("     " 0 5 (fontified t)) . 20493) (20440 . 20446) (#("               " 0 15 (fontified t)) . 20440) (20395 . 20401) (#("               " 0 15 (fontified t)) . 20395) (20356 . 20362) (#("        " 0 8 (fontified t)) . 20356) (20337 . 20343) (#("        " 0 8 (fontified t)) . 20337) (19362 . 19363) (#("  " 0 2 (fontified nil)) . 19362) (#("   " 0 3 (fontified t)) . -19351) (#("   " 0 3 (fontified t)) . -19308) (#("   " 0 3 (fontified t)) . -19260) 19140) nil (26806 47201 695065 0) 0 nil])
([nil nil ((#("lumen.core.router:" 0 18 (fontified t)) . -20277) (undo-tree-id8 . -18) 20295) nil (26806 47201 695055 0) 0 nil])
([nil nil ((#("lumen.core.router:" 0 18 (fontified t)) . -21609) (undo-tree-id7 . -18) 21627) nil (26806 47201 695054 0) 0 nil])
([nil nil ((#("lumen.core.router:" 0 18 (fontified t)) . -21971) (undo-tree-id6 . -18) 21989) nil (26806 47201 695052 0) 0 nil])
([nil nil ((#("lumen.core.router:" 0 18 (fontified t)) . -22327) (undo-tree-id5 . -18) 22345) nil (26806 47201 695051 0) 0 nil])
([nil nil ((#("lumen.core.router:" 0 18 (fontified t)) . -22719) (undo-tree-id4 . -18) 22737) nil (26806 47201 695050 0) 0 nil])
([nil nil ((#("		      " 0 8 (fontified nil)) . -22858) (22858 . 22859) (#("	" 0 1 (fontified nil)) . 22858) (22854 . 22858) (#("		   " 0 5 (fontified nil)) . -22796) (22796 . 22797) (#("	" 0 1 (fontified nil)) . 22796) (22795 . 22796) (#("		    " 0 6 (fontified nil)) . -22759) (22759 . 22760) (#("	" 0 1 (fontified nil)) . 22759) (22757 . 22759) (#("		  " 0 4 (fontified t)) . -22719) (#("		  " 0 4 (fontified t)) . -22704) (#("		      " 0 8 (fontified nil)) . -22546) (22546 . 22547) (#("	" 0 1 (fontified nil)) . 22546) (22542 . 22546) (#("		   " 0 5 (fontified nil)) . -22477) (22477 . 22478) (#("	" 0 1 (fontified nil)) . 22477) (22476 . 22477) (#("		   " 0 5 (fontified nil)) . -22427) (22427 . 22428) (#("	" 0 1 (fontified nil)) . 22427) (22426 . 22427) (#("		    " 0 6 (fontified nil)) . -22390) (22390 . 22391) (#("	" 0 1 (fontified nil)) . 22390) (22388 . 22390) (#("		  " 0 4 (fontified t)) . -22350) (#("		  " 0 4 (fontified t)) . -22335) (#("		    " 0 6 (fontified nil)) . -22161) (22161 . 22162) (#("	" 0 1 (fontified nil)) . 22161) (22159 . 22161) (#("			 " 0 4 (fontified nil)) . -22096) (22096 . 22097) (#("	" 0 1 (fontified nil)) . 22096) (22089 . 22096) (#("			 " 0 4 (fontified nil)) . -22041) (22041 . 22042) (#("	" 0 1 (fontified nil)) . 22041) (22034 . 22041) (#("		  " 0 4 (fontified t)) . -21999) (#("		  " 0 4 (fontified t)) . -21984) (#("		  " 0 4 (fontified t)) . -21838) (#("		      " 0 8 (fontified nil)) . -21792) (21792 . 21793) (#("	" 0 1 (fontified nil)) . 21792) (21788 . 21792) (#("		   " 0 5 (fontified nil)) . -21737) (21737 . 21738) (#("	" 0 1 (fontified nil)) . 21737) (21736 . 21737) (#("		    " 0 6 (fontified nil)) . -21700) (21700 . 21701) (#("	" 0 1 (fontified nil)) . 21700) (21698 . 21700) (#("		  " 0 4 (fontified t)) . -21660) (#("		  " 0 4 (fontified t)) . -21645) (#("		      " 0 8 (fontified nil)) . -21484) (21484 . 21485) (#("	" 0 1 (fontified nil)) . 21484) (21480 . 21484) (#("		      " 0 8 (fontified nil)) . -21433) (21433 . 21434) (#("	" 0 1 (fontified nil)) . 21433) (21429 . 21433) (#("		      " 0 8 (fontified nil)) . -21378) (21378 . 21379) (#("	" 0 1 (fontified nil)) . 21378) (21374 . 21378) (#("		     " 0 7 (fontified nil)) . -21324) (21324 . 21325) (#("	" 0 1 (fontified nil)) . 21324) (21321 . 21324) (#("		    " 0 6 (fontified nil)) . -21289) (21289 . 21290) (#("	" 0 1 (fontified nil)) . 21289) (21287 . 21289) (#("			 " 0 4 (fontified nil)) . -21223) (21223 . 21224) (#("	" 0 1 (fontified nil)) . 21223) (21216 . 21223) (#("			 " 0 4 (fontified nil)) . -21149) (21149 . 21150) (#("	" 0 1 (fontified nil)) . 21149) (21142 . 21149) (#("			 " 0 4 (fontified nil)) . -21080) (21080 . 21081) (#("	" 0 1 (fontified nil)) . 21080) (21073 . 21080) (#("			 " 0 4 (fontified nil)) . -21003) (21003 . 21004) (#("	" 0 1 (fontified nil)) . 21003) (20996 . 21003) (#("			 " 0 4 (fontified nil)) . -20927) (20927 . 20928) (#("	" 0 1 (fontified nil)) . 20927) (20920 . 20927) (#("			 " 0 1 (fontified nil) 1 4 (fontified nil)) . -20862) (20862 . 20863) (#("	" 0 1 (fontified nil)) . 20862) (20855 . 20862) (#("		       " 0 9 (fontified nil)) . -20820) (20820 . 20821) (#("	" 0 1 (fontified nil)) . 20820) (20815 . 20820) (#("		    " 0 6 (fontified nil)) . -20770) (20770 . 20771) (#("	" 0 1 (fontified nil)) . 20770) (20768 . 20770) (#("		    " 0 6 (fontified nil)) . -20727) (20727 . 20728) (#("	" 0 1 (fontified nil)) . 20727) (20725 . 20727) (#("			" 0 3 (fontified nil)) . -20700) (20700 . 20701) (#("	" 0 1 (fontified nil)) . 20700) (20694 . 20700) (#("			" 0 3 (fontified nil)) . -20641) (20641 . 20642) (#("	" 0 1 (fontified nil)) . 20641) (20635 . 20641) (#("			 " 0 4 (fontified nil)) . -20592) (20592 . 20593) (#("	" 0 1 (fontified nil)) . 20592) (20585 . 20592) (#("			 " 0 4 (fontified nil)) . -20521) (20521 . 20522) (#("	" 0 1 (fontified nil)) . 20521) (20514 . 20521) (#("		       " 0 9 (fontified nil)) . -20479) (20479 . 20480) (#("	" 0 1 (fontified nil)) . 20479) (20474 . 20479) (#("			 " 0 4 (fontified nil)) . -20426) (20426 . 20427) (#("	" 0 1 (fontified nil)) . 20426) (20419 . 20426) (#("			 " 0 4 (fontified nil)) . -20378) (20378 . 20379) (#("	" 0 1 (fontified nil)) . 20378) (20371 . 20378) (#("		  " 0 4 (fontified t)) . -20336) (#("		  " 0 4 (fontified t)) . -20321) 19140) nil (26806 47201 695044 0) 0 nil])
([nil nil ((19138 . 19139)) nil (26806 47201 695034 0) 0 nil])
([nil nil ((19139 . 19141)) nil (26806 47201 695033 0) 0 nil])
([nil nil ((8216 . 8217)) nil (26806 47201 695033 0) 0 nil])
([nil nil ((#("*" 0 1 (fontified t)) . -8216) (undo-tree-id3 . -1) 8217) nil (26806 47201 695032 0) 0 nil])
([nil nil ((8216 . 8217)) nil (26806 47201 695025 0) 0 nil])
([nil nil ((8217 . 8219)) nil (26806 47201 695024 0) 0 nil])
([nil nil ((23009 . 23010) 19841) nil (26806 47201 695021 0) 0 nil])
([nil nil ((#("lumen.data.repo:" 0 16 (fontified t)) . -21749) (t 26806 47201 0 0) (21765 . 21787) (t 26806 47201 0 0)) nil (26806 55323 804190 0) 0 nil])
([nil nil ((#("query" 0 5 (fontified t)) . -21765) (undo-tree-id0 . -5) (undo-tree-id1 . -3) (undo-tree-id2 . -3) (undo-tree-id3 . -3) (undo-tree-id4 . -3) (undo-tree-id5 . -3) (undo-tree-id6 . -3) (undo-tree-id7 . -5) (undo-tree-id8 . -5) (undo-tree-id9 . -5) (undo-tree-id10 . -5) 21770 (t 26806 55323 0 0)) nil (26806 55366 841108 0) 0 nil])
([nil nil ((21765 . 21769)) nil (26806 55366 841086 0) 0 nil])
([nil nil ((#("params" 0 6 (fontified t)) . -20410) (undo-tree-id0 . -6) (undo-tree-id1 . -2) 20416 (t 26806 55366 0 0)) nil (26808 23631 378386 0) 0 nil])
([nil nil ((20410 . 20415)) nil (26808 23631 378365 0) 0 nil])
([nil nil ((#("(make-hash-table :test 'equal)" 0 17 (fontified t) 17 22 (face font-lock-builtin-face fontified t) 22 30 (fontified t)) . -20484) (undo-tree-id2 . -30) (undo-tree-id3 . -30) (undo-tree-id4 . -30) (undo-tree-id5 . -30) (undo-tree-id6 . -30) (undo-tree-id7 . -30) (undo-tree-id8 . -30) 20514 (t 26808 23631 0 0)) nil (26808 23649 595886 0) 0 nil])
([nil nil ((20484 . 20487)) nil (26808 23649 595869 0) 0 nil])
([nil nil ((21673 . 21676) (#("	" 0 1 (fontified nil)) . -21637) (21673 . 21674) (t 26808 23649 0 0)) nil (26809 28121 315559 0) 0 nil])
([nil nil ((21676 . 21679)) nil (26809 28121 315558 0) 0 nil])
([nil nil ((#("r" 0 1 (fontified t)) . -21678) (undo-tree-id5 . -1) (undo-tree-id6 . -1) (undo-tree-id7 . -1) (undo-tree-id8 . -1) 21679) nil (26809 28121 315557 0) 0 nil])
([nil nil ((21678 . 21683)) nil (26809 28121 315553 0) 0 nil])
([nil nil ((21683 . 21684)) nil (26809 28121 315553 0) 0 nil])
([nil nil ((21684 . 21685)) nil (26809 28121 315552 0) 0 nil])
([nil nil ((21685 . 21686)) nil (26809 28121 315552 0) 0 nil])
([nil nil ((21686 . 21687)) nil (26809 28121 315552 0) 0 nil])
([nil nil ((21687 . 21692)) nil (26809 28121 315551 0) 0 nil])
([nil nil ((21692 . 21693)) nil (26809 28121 315551 0) 0 nil])
([nil nil ((21693 . 21694)) nil (26809 28121 315551 0) 0 nil])
([nil nil ((#("~" 0 1 (face font-lock-string-face fontified t)) . -21693) (undo-tree-id3 . -1) (undo-tree-id4 . -1) 21694) nil (26809 28121 315550 0) 0 nil])
([nil nil ((21693 . 21698)) nil (26809 28121 315548 0) 0 nil])
([nil nil ((#(")" 0 1 (face font-lock-string-face fontified t)) . -21697) (undo-tree-id0 . -1) (undo-tree-id1 . -1) (undo-tree-id2 . -1) 21698) nil (26809 28121 315547 0) 0 nil])
([nil nil ((21697 . 21698)) nil (26809 28121 315529 0) 0 nil])
([nil nil ((21698 . 21699)) nil (26809 28121 315529 0) 0 nil])
([nil nil ((21699 . 21701)) nil (26809 28121 315528 0) 0 nil])
([nil nil ((21697 . 21698)) nil (26809 28121 315524 0) 0 nil])
([nil nil ((19733 . 19734) (t 26809 28121 0 0)) nil (26809 28556 954912 0) 0 nil])
([nil nil ((#(":" 0 1 (face font-lock-string-face fontified t)) . -19733) (undo-tree-id9 . -1) (undo-tree-id10 . -1) (undo-tree-id11 . -1) (undo-tree-id12 . -1) (undo-tree-id13 . -1) (undo-tree-id14 . -1) (undo-tree-id15 . -1) (undo-tree-id16 . -1) (undo-tree-id17 . -1) (undo-tree-id18 . -1) 19734 (t 26809 28556 0 0)) nil (26809 28663 283380 0) 0 nil])
([nil nil ((19734 . 19735)) nil (26809 28663 283363 0) 0 nil])
([nil nil ((19759 . 19763) (#("    " 0 4 (fontified nil)) . 19758) (undo-tree-id19 . -4) (19757 . 19763) (t 26809 28663 0 0)) nil (26809 28729 486692 0) 0 nil])
([nil nil ((19763 . 19769)) nil (26809 28729 486683 0) 0 nil])
([nil nil ((19769 . 19770)) nil (26809 28729 486682 0) 0 nil])
([nil nil ((19770 . 19780)) nil (26809 28729 486679 0) 0 nil])
([nil nil ((#(":" 0 1 (face font-lock-string-face fontified t)) . -19734) (undo-tree-id28 . -1) (undo-tree-id29 . -1) 19735 (t 26809 28729 0 0)) nil (26809 29207 107100 0) 0 nil])
([nil nil ((19755 . 19758)) nil (26809 29207 107097 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 19812 . 19813) (nil fontified nil 19801 . 19813) (nil fontified nil 19796 . 19801) (nil fontified nil 19795 . 19796) (nil fontified nil 19781 . 19795) (nil fontified nil 19758 . 19781) (19758 . 19813)) nil (26809 29207 107097 0) 0 nil])
([nil nil ((#(")" 0 1 (rear-nonsticky t fontified t)) . -19812) (undo-tree-id23 . -1) (undo-tree-id24 . -1) (undo-tree-id25 . -1) (undo-tree-id26 . -1) (undo-tree-id27 . -1) 19813) nil (26809 29207 107095 0) 0 nil])
([nil nil ((19701 . 19703)) nil (26809 29207 107087 0) 0 nil])
([nil nil ((#("(?<id>[^/]+)" 0 7 (face font-lock-string-face fontified t) 7 8 (face (font-lock-negation-char-face font-lock-string-face) fontified t) 8 12 (face font-lock-string-face fontified t)) . -19790) (undo-tree-id20 . -12) (undo-tree-id21 . -12) (undo-tree-id22 . -12) 19802) nil (26809 29207 107085 0) 0 nil])
([nil nil ((19790 . 19793)) nil (26809 29207 107065 0) 0 nil])
([nil nil ((#("	" 0 1 (fontified t)) . -21918) (#("	    " 0 5 (fontified nil)) . -21873) (21873 . 21874) (#("	" 0 1 (fontified nil)) . 21873) (21869 . 21873) (#("	 " 0 2 (fontified nil)) . -21814) (21814 . 21815) (#("	" 0 1 (fontified nil)) . 21814) (21813 . 21814) (#("	  " 0 3 (fontified nil)) . -21778) (21778 . 21779) (#("	" 0 1 (fontified nil)) . 21778) (21776 . 21778) (#("	" 0 1 (fontified t)) . -21695) 21651 (t 26809 29207 0 0)) nil (26809 29484 736996 0) 0 nil])
([nil nil ((21707 . 21709)) nil (26809 29484 736994 0) 0 nil])
([nil nil ((21709 . 21715)) nil (26809 29484 736994 0) 0 nil])
([nil nil ((21715 . 21716)) nil (26809 29484 736994 0) 0 nil])
([nil nil ((21716 . 21720)) nil (26809 29484 736993 0) 0 nil])
([nil nil ((#("s" 0 1 (fontified t)) . -21718) (undo-tree-id35 . -1) (undo-tree-id36 . -1) (undo-tree-id37 . -1) (undo-tree-id38 . -1) (undo-tree-id39 . -1) (undo-tree-id40 . -1) (undo-tree-id41 . -1) (undo-tree-id42 . -1) (#(")" 0 1 (fontified t)) . -21719) (undo-tree-id43 . -1) (undo-tree-id44 . -1) (undo-tree-id45 . -1) (undo-tree-id46 . -1) (undo-tree-id47 . -1) (undo-tree-id48 . -1) 21720) nil (26809 29484 736992 0) 0 nil])
([nil nil ((21718 . 21720)) nil (26809 29484 736980 0) 0 nil])
([nil nil ((21707 . 21709)) nil (26809 29484 736980 0) 0 nil])
([nil nil ((21709 . 21710)) nil (26809 29484 736979 0) 0 nil])
([nil nil ((#("r" 0 1 (fontified t)) . -21709) (undo-tree-id30 . -1) (undo-tree-id31 . -1) (undo-tree-id32 . -1) (undo-tree-id33 . -1) (undo-tree-id34 . -1) 21710) nil (26809 29484 736978 0) 0 nil])
([nil nil ((21709 . 21710)) nil (26809 29484 736967 0) 0 nil])
([nil nil ((21710 . 21715)) nil (26809 29484 736966 0) 0 nil])
([nil nil ((21715 . 21716)) nil (26809 29484 736966 0) 0 nil])
([nil nil ((21716 . 21719)) nil (26809 29484 736965 0) 0 nil])
([nil nil ((21719 . 21720)) nil (26809 29484 736964 0) 0 nil])
([nil nil ((21720 . 21725)) nil (26809 29484 736961 0) 0 nil])
([nil nil ((21772 . 21775) (t 26809 29484 0 0)) nil (26809 30170 855640 0) 0 nil])
([nil nil ((21775 . 21776)) nil (26809 30170 855639 0) 0 nil])
([nil nil ((22497 . 22500)) nil (26809 30170 855639 0) 0 nil])
([nil nil ((22500 . 22501)) nil (26809 30170 855638 0) 0 nil])
([nil nil ((22870 . 22873)) nil (26809 30170 855637 0) 0 nil])
([nil nil ((22873 . 22874)) nil (26809 30170 855634 0) 0 nil])
([nil nil ((22974 . 22981) (t 26809 30170 0 0)) nil (26809 47341 563129 0) 0 nil])
([nil nil ((22981 . 22987)) nil (26809 47341 563128 0) 0 nil])
([nil nil ((22987 . 22988)) nil (26809 47341 563127 0) 0 nil])
([nil nil ((22988 . 22992)) nil (26809 47341 563123 0) 0 nil])
([nil nil ((#("
		    (print res)" 0 1 (fontified t) 1 18 (fontified t)) . 22974) (undo-tree-id49 . -18) (undo-tree-id50 . -18) (undo-tree-id51 . -18) (undo-tree-id52 . -18) (t 26809 47341 0 0)) nil (26809 47626 795847 0) 0 nil])
([nil nil ((#("\"" 0 1 (face font-lock-doc-face fontified t)) . -4013) (undo-tree-id0 . -1) (undo-tree-id1 . -1) (undo-tree-id2 . -1) 4014 (t 26809 47626 0 0)) nil (26812 45888 705872 0) 0 nil])
([nil nil ((4013 . 4014)) nil (26812 45888 705853 0) 0 nil])
([nil nil ((#("\"" 0 1 (face font-lock-doc-face fontified t)) . 4017)) nil (26812 45888 705852 0) 0 nil])
([nil nil ((4017 . 4018)) nil (26812 45888 705848 0) 0 nil])
([nil nil ((#("
(defun %filters-from-query (q &key fts-config)
  \"Construit une forme `filters` depuis query-string:
  - q[name]=Alice      → (= :name \\\"Alice\\\")
  - q[min_age]=18      → (>= :age 18)  (convention min_/max_ sur les nombres)
  - q[search]=txt      → (search :q \\\"txt\\\")
  - q[in_status]=a,b,c → (in :status '(\\\"a\\\" \\\"b\\\" \\\"c\\\"))
  Les clés hors préfixes sont ignorées.\"
  (let ((clauses '()))
    (flet ((push1 (x) (when x (push x clauses))))
      (maphash
       (lambda (k v)
         (let ((ks (string-downcase (string k))))
           (cond
             ((string-prefix-p \"min_\" ks)
              (push1 (list '>= (%kw (subseq ks 4)) (%maybe-number v))))
             ((string-prefix-p \"max_\" ks)
              (push1 (list '<= (%kw (subseq ks 4)) (%maybe-number v))))
             ((string-prefix-p \"in_\" ks)
              (push1 (list 'in (%kw (subseq ks 3)) (mapcar #'string-trim (lambda (x) x) (%split v #\\,)))))
             ((string= ks \"search\")
              (push1 (list 'search :q v)))
             (t ;; égalité par défaut
              (push1 (list '= (%kw ks) (%maybe-number v)))))))
       q))
    (cond
      ((null clauses) nil)
      ((= (length clauses) 1) (first clauses))
      (t (cons 'and (nreverse clauses))))))" 0 2 (fontified t) 2 7 (face font-lock-keyword-face fontified t) 7 8 (fontified t) 8 27 (face font-lock-function-name-face fontified t) 27 31 (fontified t) 31 35 (face font-lock-type-face fontified t) 35 50 (fontified t) 50 369 (face font-lock-doc-face fontified t) 369 373 (fontified t) 373 376 (face font-lock-keyword-face fontified t) 376 398 (fontified t) 398 402 (face font-lock-keyword-face fontified t) 402 416 (fontified t) 416 420 (face font-lock-keyword-face fontified t) 420 466 (fontified t) 466 472 (face font-lock-keyword-face fontified t) 472 489 (fontified t) 489 492 (face font-lock-keyword-face fontified t) 492 541 (fontified t) 541 545 (face font-lock-keyword-face fontified t) 545 577 (fontified t) 577 583 (face font-lock-string-face fontified t) 583 691 (fontified t) 691 697 (face font-lock-string-face fontified t) 697 805 (fontified t) 805 810 (face font-lock-string-face fontified t) 810 889 (fontified t) 889 895 (face font-lock-keyword-face fontified t) 895 948 (fontified t) 948 956 (face font-lock-string-face fontified t) 956 993 (fontified t) 993 995 (face font-lock-builtin-face fontified t) 995 1017 (fontified t) 1017 1020 (face font-lock-comment-delimiter-face fontified t) 1020 1039 (face font-lock-comment-face fontified t) 1039 1118 (fontified t) 1118 1122 (face font-lock-keyword-face fontified t) 1122 1132 (fontified t) 1132 1150 (fontified t) 1150 1233 (fontified t) 1233 1240 (fontified t)) . 4327) (undo-tree-id3 . -1240) (undo-tree-id4 . -442) (undo-tree-id5 . -351) (undo-tree-id6 . -392) (undo-tree-id7 . -1240) (undo-tree-id8 . -442) (undo-tree-id9 . -587) (undo-tree-id10 . -638) (undo-tree-id11 . -638) (undo-tree-id12 . -659) (undo-tree-id13 . -602) (undo-tree-id14 . -1) (undo-tree-id15 . -9) (undo-tree-id16 . -8) (undo-tree-id17 . -27) (undo-tree-id18 . -1240) (undo-tree-id19 . -1240) (undo-tree-id20 . -1240) (undo-tree-id21 . -1240) (undo-tree-id22 . -1240) (undo-tree-id23 . -27) (undo-tree-id24 . -1240) (undo-tree-id25 . -1193) (undo-tree-id26 . -1193) (undo-tree-id27 . -145) (t 26812 45888 0 0)) nil (26812 48220 846429 0) 0 nil])
([nil nil ((#("
" 0 1 (fontified t)) . 4327)) nil (26812 48220 846394 0) 0 nil])
([nil nil ((1114 . 1115) (t 26812 48220 0 0)) nil (26817 52439 800648 0) 0 nil])
([nil nil ((1115 . 1120)) nil (26817 52439 800647 0) 0 nil])
([nil nil ((#("o" 0 1 (face font-lock-builtin-face fontified t)) . -1117) (undo-tree-id0 . -1) (#("n" 0 1 (face font-lock-builtin-face fontified t)) . -1118) (undo-tree-id1 . -1) (#("t" 0 1 (face font-lock-builtin-face fontified t)) . -1119) (undo-tree-id2 . -1) 1120) nil (26817 52439 800645 0) 0 nil])
([nil nil ((1117 . 1132)) nil (26817 52439 800623 0) 0 nil])
([nil nil ((20112 . 20117) (t 26817 52439 0 0)) nil (26819 13637 632468 0) 0 nil])
([nil nil ((20117 . 20122)) nil (26819 13637 632467 0) 0 nil])
([nil nil ((#("t" 0 1 (fontified t)) . -20121) (undo-tree-id5 . -1) 20122) nil (26819 13637 632467 0) 0 nil])
([nil nil ((20121 . 20123)) nil (26819 13637 632466 0) 0 nil])
([nil nil ((20123 . 20124)) nil (26819 13637 632465 0) 0 nil])
([nil nil ((20124 . 20128)) nil (26819 13637 632465 0) 0 nil])
([nil nil ((#("\"" 0 1 (face font-lock-string-face fontified t)) . -20127) (undo-tree-id4 . -1) 20128) nil (26819 13637 632465 0) 0 nil])
([nil nil ((20127 . 20130)) nil (26819 13637 632463 0) 0 nil])
([nil nil ((20130 . 20135)) nil (26819 13637 632463 0) 0 nil])
([nil nil ((20135 . 20136)) nil (26819 13637 632463 0) 0 nil])
([nil nil ((#("'" 0 1 (fontified t)) . -20135) (undo-tree-id3 . -1) 20136) nil (26819 13637 632462 0) 0 nil])
([nil nil ((20135 . 20136)) nil (26819 13637 632461 0) 0 nil])
([nil nil ((20128 . 20129)) nil (26819 13637 632460 0) 0 nil])
([nil nil ((20129 . 20132)) nil (26819 13637 632460 0) 0 nil])
([nil nil ((#("p" 0 1 (face font-lock-string-face fontified t)) . -20129) (undo-tree-id0 . -1) (#("r" 0 1 (face font-lock-string-face fontified t)) . -20130) (undo-tree-id1 . -1) (#("i" 0 1 (face font-lock-string-face fontified t)) . -20131) (undo-tree-id2 . -1) 20132) nil (26819 13637 632459 0) 0 nil])
([nil nil ((20137 . 20142)) nil (26819 13637 632443 0) 0 nil])
([nil nil ((20142 . 20143)) nil (26819 13637 632442 0) 0 nil])
([nil nil ((20143 . 20145)) nil (26819 13637 632442 0) 0 nil])
([nil nil ((20145 . 20146)) nil (26819 13637 632441 0) 0 nil])
([nil nil ((20146 . 20151)) nil (26819 13637 632441 0) 0 nil])
([nil nil ((20151 . 20152)) nil (26819 13637 632440 0) 0 nil])
([nil nil ((20152 . 20157)) nil (26819 13637 632440 0) 0 nil])
([nil nil ((20157 . 20158)) nil (26819 13637 632439 0) 0 nil])
([nil nil ((20158 . 20166)) nil (26819 13637 632436 0) 0 nil])
([nil nil ((20166 . 20171) (t 26819 13637 0 0)) nil (26819 13645 484171 0) 0 nil])
([nil nil ((20171 . 20177)) nil (26819 13645 484170 0) 0 nil])
([nil nil ((20177 . 20178)) nil (26819 13645 484169 0) 0 nil])
([nil nil ((20178 . 20182)) nil (26819 13645 484168 0) 0 nil])
([nil nil ((20182 . 20184)) nil (26819 13645 484165 0) 0 nil])
([nil nil ((20184 . 20185) (t 26819 13645 0 0)) nil (26819 16662 318301 0) 0 nil])
([nil nil ((#("b" 0 1 (fontified t)) . -20184) (undo-tree-id6 . -1) 20185) nil (26819 16662 318298 0) 0 nil])
([nil nil ((#("
	(print req)" 0 13 (fontified t)) . 20574) (undo-tree-id11 . -13) (t 26819 16662 0 0)) nil (26821 16737 424244 0) 0 nil])
([nil nil ((#("data.repo" 0 9 (fontified t)) . -18657) (undo-tree-id10 . -9) 18666) nil (26821 16737 424242 0) 0 nil])
([nil nil ((#("." 0 1 (fontified t)) . -18656) (undo-tree-id8 . -1) (undo-tree-id9 . -1) 18657) nil (26821 16737 424239 0) 0 nil])
([nil nil ((18661 . 18664)) nil (26821 16737 424235 0) 0 nil])
([nil nil ((#("t" 0 1 (fontified t)) . -18663) (undo-tree-id7 . -1) 18664) nil (26821 16737 424234 0) 0 nil])
([nil nil ((18663 . 18666)) nil (26821 16737 424215 0) 0 nil])
([nil nil ((20733 . 20739)) nil (26821 16737 424214 0) 0 nil])
([nil nil ((20739 . 20745)) nil (26821 16737 424213 0) 0 nil])
([nil nil ((20745 . 20746)) nil (26821 16737 424212 0) 0 nil])
([nil nil ((20746 . 20750)) nil (26821 16737 424206 0) 0 nil])
([nil nil ((20764 . 20766) (#(" " 0 1 (fontified nil)) . 20763) (undo-tree-id0 . -1) (undo-tree-id1 . -1) (undo-tree-id2 . -1) (undo-tree-id3 . -1) (undo-tree-id4 . -1) (undo-tree-id5 . -1) (undo-tree-id6 . -1) (20764 . 20765) (t 26821 16737 0 0)) nil (26821 17807 705388 0) 0 nil])
([nil nil ((20614 . 20616) (t 26821 17807 0 0)) nil (26821 18044 620334 0) 0 nil])
([nil nil ((20553 . 20555)) nil (26821 18044 620332 0) 0 nil])
([nil nil ((20743 . 20745)) nil (26821 18044 620327 0) 0 nil])
([nil nil ((6323 . 6326) (t 26821 18044 0 0)) nil (26822 34354 931647 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 8173 . 8174) (nil fontified nil 6326 . 8174) (6326 . 8174)) nil (26822 34354 931646 0) 0 nil])
([nil nil ((#("
" 0 1 (rear-nonsticky t fontified t)) . -8173) (undo-tree-id17 . -1) 8174) nil (26822 34354 931645 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 6502 . 6503) (nil fontified nil 6427 . 6503) (nil fontified nil 6423 . 6427) (nil fontified nil 6410 . 6423) (nil fontified nil 6406 . 6410) (nil fontified nil 6329 . 6406) (nil fontified nil 6325 . 6329) (6325 . 6503)) nil (26822 34354 931644 0) 0 nil])
([nil nil ((#("Montage CRUD" 0 12 (face font-lock-comment-face fontified t)) . -6410) (undo-tree-id16 . -12) 6422) nil (26822 34354 931643 0) 0 nil])
([nil nil ((6410 . 6415)) nil (26822 34354 931642 0) 0 nil])
([nil nil ((6415 . 6416)) nil (26822 34354 931642 0) 0 nil])
([nil nil ((6416 . 6423)) nil (26822 34354 931641 0) 0 nil])
([nil nil ((7198 . 7199)) nil (26822 34354 931641 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 7208 . 7209) (nil fontified nil 7199 . 7209) (7199 . 7209)) nil (26822 34354 931640 0) 0 nil])
([nil nil ((7209 . 7210)) nil (26822 34354 931639 0) 0 nil])
([nil nil ((7210 . 7212)) nil (26822 34354 931639 0) 0 nil])
([nil nil ((7212 . 7213)) nil (26822 34354 931638 0) 0 nil])
([nil nil ((#("t" 0 1 (fontified t)) . -7210) (undo-tree-id15 . -1) 7211) nil (26822 34354 931637 0) 0 nil])
([nil nil ((7210 . 7213)) nil (26822 34354 931636 0) 0 nil])
([nil nil ((1132 . 1133)) nil (26822 34354 931636 0) 0 nil])
([nil nil ((1133 . 1134)) nil (26822 34354 931635 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 1155 . 1156) (nil fontified nil 1134 . 1156) (1134 . 1156)) nil (26822 34354 931634 0) 0 nil])
([nil nil ((20912 . 20914) (#("	 " 0 2 (fontified nil)) . 20911) (undo-tree-id14 . -2) (20910 . 20914)) nil (26822 34354 931634 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 21057 . 21058) (nil fontified nil 21018 . 21058) (nil fontified nil 21007 . 21018) (nil fontified nil 20944 . 21007) (nil fontified nil 20940 . 20944) (nil fontified nil 20921 . 20940) (nil fontified nil 20914 . 20921) (20914 . 21058)) nil (26822 34354 931632 0) 0 nil])
([nil nil ((#("(guard! (req)
           (when (and auth-guard (not (funcall auth-guard req)))
             (return-from guard! (lumen.core.http:respond-404))))" 0 7 (fontified t) 7 26 (fontified t) 26 30 (face font-lock-keyword-face fontified t) 30 93 (fontified t) 93 104 (face font-lock-keyword-face fontified t) 104 143 (fontified t) 143 144 (rear-nonsticky t fontified t)) . -20914) (undo-tree-id13 . -144) 21058) nil (26822 34354 931631 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 21091 . 21092) (nil fontified nil 20914 . 21092) (20914 . 21092)) nil (26822 34354 931630 0) 0 nil])
([nil nil ((#("handler" 0 7 (fontified t)) . -21075) (undo-tree-id12 . -7) 21082) nil (26822 34354 931629 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 21079 . 21080) (nil fontified nil 21075 . 21080) (21075 . 21080)) nil (26822 34354 931628 0) 0 nil])
([nil nil ((21080 . 21081)) nil (26822 34354 931627 0) 0 nil])
([nil nil ((20757 . 20759) (#("	 " 0 2 (fontified nil)) . 20756) (20756 . 20758) (20756 . 20757)) nil (26822 34354 931627 0) 0 nil])
([nil nil ((20759 . 20761)) nil (26822 34354 931626 0) 0 nil])
([nil nil ((20912 . 20914) (#("    " 0 4 (face font-lock-comment-face fontified nil)) . -20859) (20915 . 20916)) nil (26822 34354 931625 0) 0 nil])
([nil nil ((20914 . 20916)) nil (26822 34354 931625 0) 0 nil])
([nil nil ((21059 . 21062) (#("               " 0 15 (fontified t)) . 21059) (21037 . 21039) (20976 . 20978) (20946 . 20948) 20920) nil (26822 34354 931624 0) 0 nil])
([nil nil ((#("

    (print base-item)
" 0 24 (fontified t)) . 20653) (undo-tree-id11 . -24)) nil (26822 34354 931623 0) 0 nil])
([nil nil ((7865 . 7866)) nil (26822 34354 931622 0) 0 nil])
([nil nil ((7866 . 7870)) nil (26822 34354 931622 0) 0 nil])
([nil nil ((7870 . 7871)) nil (26822 34354 931621 0) 0 nil])
([nil nil ((7871 . 7874)) nil (26822 34354 931621 0) 0 nil])
([nil nil ((#("u" 0 1 (fontified t)) . -7873) (undo-tree-id10 . -1) 7874) nil (26822 34354 931620 0) 0 nil])
([nil nil ((7873 . 7875)) nil (26822 34354 931619 0) 0 nil])
([nil nil ((7875 . 7877)) nil (26822 34354 931618 0) 0 nil])
([nil nil ((#("e" 0 1 (fontified t)) . -7876) (undo-tree-id9 . -1) 7877) nil (26822 34354 931617 0) 0 nil])
([nil nil ((7876 . 7881)) nil (26822 34354 931616 0) 0 nil])
([nil nil ((7871 . 7872)) nil (26822 34354 931615 0) 0 nil])
([nil nil ((7880 . 7881)) nil (26822 34354 931615 0) 0 nil])
([nil nil ((#(" " 0 1 (fontified t)) . -7880) (undo-tree-id8 . -1) 7881) nil (26822 34354 931614 0) 0 nil])
([nil nil ((7882 . 7883)) nil (26822 34354 931612 0) 0 nil])
([nil nil ((7883 . 7887)) nil (26822 34354 931611 0) 0 nil])
([nil nil ((#("t" 0 1 (fontified t)) . -8231) (undo-tree-id7 . -1) 8232) nil (26822 34354 931610 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 8240 . 8241) (nil fontified nil 8231 . 8241) (8231 . 8241)) nil (26822 34354 931592 0) 0 nil])
([nil nil ((21441 . 21442) (t 26822 34354 0 0)) nil (26822 34526 496257 0) 0 nil])
([nil nil ((21442 . 21448)) nil (26822 34526 496256 0) 0 nil])
([nil nil ((22815 . 22816)) nil (26822 34526 496256 0) 0 nil])
([nil nil ((22816 . 22821)) nil (26822 34526 496255 0) 0 nil])
([nil nil ((23237 . 23238)) nil (26822 34526 496255 0) 0 nil])
([nil nil ((23238 . 23245)) nil (26822 34526 496255 0) 0 nil])
([nil nil ((23596 . 23597)) nil (26822 34526 496254 0) 0 nil])
([nil nil ((23597 . 23601)) nil (26822 34526 496253 0) 0 nil])
([nil nil ((23601 . 23603)) nil (26822 34526 496253 0) 0 nil])
([nil nil ((23976 . 23977)) nil (26822 34526 496252 0) 0 nil])
([nil nil ((23977 . 23984)) nil (26822 34526 496248 0) 0 nil])
([nil nil ((#("
		  (print \"QP: \")
		  (print qp)
		  (print filters)
		  (print \"X1E\")" 0 1 (fontified t) 1 12 (fontified t) 12 18 (face font-lock-string-face fontified t) 18 49 (fontified t) 49 53 (fontified t) 53 55 (fontified t) 55 66 (fontified t) 66 71 (face font-lock-string-face fontified t) 71 72 (fontified t)) . 22372) (undo-tree-id18 . -72) (undo-tree-id19 . -11) (undo-tree-id20 . -11) (undo-tree-id21 . -11) (undo-tree-id22 . -11) (undo-tree-id23 . -11) (undo-tree-id24 . -11) (undo-tree-id25 . -11) (undo-tree-id26 . -72) (undo-tree-id27 . -72) (undo-tree-id28 . -72) (undo-tree-id29 . -72) (t 26822 34526 0 0)) nil (26822 36417 128153 0) 0 nil])
([nil nil ((7192 . 7194) (t 26822 36417 0 0)) nil (26824 11453 261000 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 7472 . 7473) (nil fontified nil 7194 . 7473) (7194 . 7473)) nil (26824 11453 260996 0) 0 nil])
([nil nil ((#("(defgeneric mount-crud! (entity &key base name order-whitelist auth-guard &allow-other-keys)
  (:documentation \"Monte les routes CRUD pour ENTITY sur ROUTER.
Options:
- BASE             : préfixe (\\\"/api\\\")
- NAME             : segment de chemin (par défaut = table)
- ORDER-WHITELIST  : colonnes autorisées au tri (keywords)
- AUTH-GUARD       : fn (lambda (req) (boolean)) – si fourni, doit renvoyer T\"))

#|
(defmethod mount-crud! ((entity symbol)
                        &key (base \"/api\")
                             (name nil)
                             (order-whitelist '())
                             (auth-guard nil)
                             host)              ;; <— NEW
  \"Monter des routes CRUD standardisées pour ENTITY.
Options :
- BASE             : préfixe (\\\"/api\\\")
- NAME             : segment de chemin (par défaut = table)
- ORDER-WHITELIST  : colonnes autorisées au tri (keywords)
- AUTH-GUARD       : fn (lambda (req) (boolean)) – si fourni, doit renvoyer T
- HOST             : string (un hôte) ou liste de strings (plusieurs hôtes)
Retourne la liste des routes montées (specs path/host).\"
  (let* ((md (entity-metadata entity))
         (table (getf md :table))
         (seg   (or name table))
         (pk    (or (getf md :primary-key) :id))
         (allowed (or order-whitelist
                      (mapcar (lambda (f) (getf f :col)) (entity-fields entity))))
         (base-list (concatenate 'string base \"/\" seg))
         (base-item (concatenate 'string base \"/\" seg \"/(?<id>[^/]+)\")))

    (labels
        (;; ---------- util ----------

         (guard! (req)
           (when (and auth-guard (not (funcall auth-guard req)))
             (return-from guard! (respond-404)))) ; politique 404 pour masquer la ressource

         (route-spec (path)
           \"Retourne soit PATH (string), soit (:host H :path PATH) / (:hosts HS :path PATH)
            selon la valeur de HOST.\"
           (cond
             ((null host) path)
             ((stringp host) (list :host host :path path))
             ((and (listp host) (every #'stringp host))
              (list :hosts host :path path))
             (t (error \"mount-crud!: :host doit être string ou liste de strings, pas ~S\" host))))

         ;; ---------- INDEX ----------
         (handle-index (req)
           (guard! req)
           (with-params (req)
             (let* ((qp       (lumen.core.http:req-params req))
                    (qf       (or (lumen.utils:alist-get qp :q) (make-hash-table :test 'equal)))
                    (select-s (lumen.utils:alist-get qp :select))
                    (order-s  (lumen.utils:alist-get qp :order))
                    (page-s   (lumen.utils:alist-get qp :page))
                    (psize-s  (lumen.utils:alist-get qp :page_size))
                    (limit-s  (lumen.utils:alist-get qp :limit))
                    (key-s    (lumen.utils:alist-get qp :key))
                    (after-s  (lumen.utils:alist-get qp :after))
                    (before-s (lumen.utils:alist-get qp :before))
                    (filters   (%filters-from-query qf))
                    (select    (%parse-select select-s))
                    (order     (or (%ensure-order-whitelist (%parse-order order-s) allowed)
                                   (%derive-default-order entity)))
                    (key       (%parse-key key-s))
                    (after     (%parse-after/before after-s))
                    (before    (%parse-after/before before-s)))
               (cond
                 ;; keyset
                 ((or after before)
                  (%ensure-key-matches-order key order)
                  (let ((res (if after
                                 (select-page-keyset* table
                                                      :filters filters :order order
                                                      :key key :after after
                                                      :limit (or (and limit-s (%maybe-number limit-s)) 20)
                                                      :order-whitelist allowed)
                                 (select-page-keyset-prev* table
                                                           :filters filters :order order
                                                           :key key :before before
                                                           :limit (or (and limit-s (%maybe-number limit-s)) 20)
                                                           :order-whitelist allowed))))
                    (respond-json res)))
                 ;; offset
                 (t
                  (let* ((page      (max 1 (or (and page-s (%maybe-number page-s)) 1)))
                         (page-size (max 1 (min 200 (or (and psize-s (%maybe-number psize-s)) 20))))
                         (offset    (* (1- page) page-size))
                         (items     (select* table
                                             :filters filters :order order
                                             :select (or select :*)
                                             :limit page-size :offset offset
                                             :order-whitelist allowed))
                         (total     (count* table :filters filters)))
                    (respond-json (list :items items
                                        :total total :page page :page-size page-size
                                        :order order :filters filters))))))))

         ;; ---------- SHOW ----------
         (handle-show (req)
           (guard! req)
           (with-params (id)
             (let* ((sid id)
                    (row (select* table :filters (list '= pk sid) :limit 1)))
               (if (and row (first row))
                   (let* ((one (first row))
                          (etag (%strong-etag-from-row one :lock-version-col :LOCK-VERSION))
                          (lm-ut (%row-timestamp one :updated-col :UPDATED-AT
						 :created-col :CREATED-AT))
                          (hdrs (remove nil
                                        (list (when etag `(\"ETag\" . ,etag))
                                              (when lm-ut `(\"Last-Modified\" . ,(%http-date lm-ut)))))))
                     (respond-json one :headers hdrs))
                   (respond-404)))))

         ;; ---------- CREATE ----------
         (handle-create (req)
           (guard! req)
           (let* ((payload (lumen.core.http:ctx-get req :json)))
             (handler-case
                 (with-tx ()
                   (let* ((ent (row->entity entity payload)))
                     (validate-entity! ent)
                     (multiple-value-bind (n ent2)
                         (entity-insert! ent :returning t)
                       (declare (ignore n))
                       (let* ((row2 (lumen.data.dao:entity->row-alist ent2))
                              (etag (%strong-etag-from-row row2 :lock-version-col :LOCK-VERSION))
                              (lm-ut (%row-timestamp row2 :updated-col :UPDATED-AT :created-col :CREATED-AT))
                              (loc  (format nil \"~a/~a\" base (cdr (assoc :ID row2))))
                              (hdrs (remove nil
                                            (list (when etag `(\"ETag\" . ,etag))
                                                  (when lm-ut `(\"Last-Modified\" . ,(%http-date lm-ut)))))))
                         (declare (ignore hdrs)) ; à brancher si tu veux renvoyer les headers
                         (respond-json row2 :status 201))))) ; respond-201 si tu as un helper
               (validation-error (e)
                 (respond-422 :message (validation-message e)
                              :errors  (validation-errors e)))
               (error (e)
                 (declare (ignore e))
                 (respond-500)))))

         ;; ---------- PATCH ----------
         (handle-patch (req)
           (guard! req)
           (handler-case
               (with-params (id)
                 (with-tx ()
                   (let* ((sid id)
                          (payload (lumen.core.http:ctx-get req :json))
                          (row (select* table :filters (list '= pk sid) :limit 1)))
                     (if (null row)
                         (respond-404)
                         (let* ((cur (first row)))
                           (%precondition-check! req cur :lock-version-col :LOCK-VERSION
                                                 :updated-col :UPDATED-AT
						 :created-col :CREATED-AT)
                           (let* ((ent (row->entity entity cur)))
                             (dolist (kv payload)
                               (let* ((col (car kv))
                                      (val (cdr kv))
                                      (slot (entity-slot-symbol entity col)))
                                 (setf (slot-value ent slot) val)))
                             (validate-entity! ent)
                             (multiple-value-bind (n ent2)
                                 (entity-update! ent :patch t :returning t)
                               (declare (ignore n))
                               (respond-json (lumen.data.dao:entity->row-alist ent2)))))))))
             (precondition-failed (e)
               (declare (ignore e))
               (respond-json '((:error . ((:type . \"precondition_failed\")))) :status 412))
             (validation-error (e)
               (respond-422 :message (validation-message e)
                            :errors  (validation-errors e)))
             (error (e)
               (respond-500))))

         ;; ---------- DELETE ----------
         (handle-delete (req)
           (guard! req)
           (handler-case
               (with-params (id)
                 (with-tx ()
                   (let* ((sid id)
                          (row (select* table :filters (list '= pk sid) :limit 1)))
                     (if (null row)
                         (respond-404)
                         (let ((cur (first row)))
                           (%precondition-check! req cur :lock-version-col :LOCK-VERSION
                                                 :updated-col :UPDATED-AT :created-col :CREATED-AT)
                           (let ((ent (row->entity entity cur)))
                             (entity-delete! ent)
                             (respond-json (list :deleted t :id sid))))))))
             (precondition-failed (e)
               (declare (ignore e))
               (respond-json '((:error . ((:type . \"precondition_failed\")))) :status 412))
             (error (e)
               (respond-500)))))

      ;; ---------- déclaration des routes (avec host) ----------
      (let* ((list-spec (route-spec base-list))
             (item-spec (route-spec base-item)))
        ;; GET /api/<seg>
        (defroute GET   list-spec (req) (handle-index req))
        ;; GET /api/<seg>/:id
        (defroute GET   item-spec (req) (handle-show req))
        ;; POST /api/<seg>
        (defroute POST  list-spec (req) (handle-create req))
        ;; PATCH /api/<seg>/:id
        (defroute PATCH item-spec (req) (handle-patch req))
        ;; DELETE /api/<seg>/:id
        (defroute DELETE item-spec (req) (handle-delete req))
        ;; retourne les specs montées
        (list list-spec item-spec)))))
|#
" 0 1 (fontified t) 1 11 (face font-lock-keyword-face fontified t) 11 12 (fontified t) 12 23 (face font-lock-function-name-face fontified t) 23 32 (fontified t) 32 36 (face font-lock-type-face fontified t) 36 74 (fontified t) 74 91 (face font-lock-type-face fontified t) 91 96 (fontified t) 96 110 (face font-lock-builtin-face fontified t) 110 111 (fontified t) 111 220 (face font-lock-doc-face fontified t) 220 267 (face font-lock-doc-face fontified t) 267 404 (face font-lock-doc-face fontified t) 404 408 (fontified t) 408 410 (face font-lock-comment-delimiter-face fontified t) 410 1517 (face font-lock-comment-face fontified t) 1517 1518 (face (font-lock-negation-char-face font-lock-comment-face) fontified t) 1518 1767 (face font-lock-comment-face fontified t) 1767 1789 (face font-lock-comment-face fontified t) 1789 3289 (face font-lock-comment-face fontified t) 3289 3308 (face font-lock-comment-face fontified t) 3308 4808 (face font-lock-comment-face fontified t) 4808 4846 (face font-lock-comment-face fontified t) 4846 6346 (face font-lock-comment-face fontified t) 6346 6351 (face font-lock-comment-face fontified t) 6351 7851 (face font-lock-comment-face fontified t) 7851 7883 (face font-lock-comment-face fontified t) 7883 9383 (face font-lock-comment-face fontified t) 9383 9401 (face font-lock-comment-face fontified t) 9401 10901 (face font-lock-comment-face fontified t) 10901 10922 (face font-lock-comment-face fontified t) 10922 11333 (face font-lock-comment-face fontified t) 11333 11335 (face font-lock-comment-delimiter-face fontified t) 11335 11336 (fontified t)) . 8968) (undo-tree-id0 . -11336) (t 26824 11453 0 0)) nil (26943 15797 301852 0) 0 nil])
([nil nil ((#("
" 0 1 (fontified t)) . 8968)) nil (26943 15797 301826 0) 0 nil])
([nil nil ((13149 . 13150) (t 26943 15797 0 0)) nil (26945 33439 181072 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 17768 . 17769) (nil fontified nil 13150 . 17769) (13150 . 17769)) nil (26945 33439 181071 0) 0 nil])
([nil nil ((17769 . 17770)) nil (26945 33439 181071 0) 0 nil])
([nil nil ((#(")" 0 1 (fontified t)) . -17769) (undo-tree-id0 . -1) 17770) nil (26945 33439 181070 0) 0 nil])
([nil nil ((8967 . 8968)) nil (26945 33439 181058 0) 0 nil])
([nil nil ((8968 . 8970)) nil (26945 33439 181057 0) 0 nil])
([nil nil ((13152 . 13154)) nil (26945 33439 181057 0) 0 nil])
([nil nil ((13154 . 13155)) nil (26945 33439 181055 0) 0 nil])
([nil nil ((17775 . 17776) 13155) nil (26945 33439 181052 0) 0 nil])
([nil nil ((15664 . 15671) (t 26945 33439 0 0)) nil (26946 40594 513853 0) 0 nil])
([nil nil ((15671 . 15675)) nil (26946 40594 513852 0) 0 nil])
([nil nil ((#("p" 0 1 (fontified t)) . -15672) (undo-tree-id8 . -1) (#("r" 0 1 (fontified t)) . -15673) (undo-tree-id9 . -1) (#("i" 0 1 (fontified t)) . -15674) (undo-tree-id10 . -1) 15675) nil (26946 40594 513852 0) 0 nil])
([nil nil ((15672 . 15678)) nil (26946 40594 513849 0) 0 nil])
([nil nil ((15678 . 15679)) nil (26946 40594 513849 0) 0 nil])
([nil nil ((15679 . 15680)) nil (26946 40594 513848 0) 0 nil])
([nil nil ((15680 . 15681)) nil (26946 40594 513848 0) 0 nil])
([nil nil ((15681 . 15684)) nil (26946 40594 513848 0) 0 nil])
([nil nil ((15684 . 15685)) nil (26946 40594 513847 0) 0 nil])
([nil nil ((#(" " 0 1 (face font-lock-string-face fontified t)) . -15684) (undo-tree-id7 . -1) 15685) nil (26946 40594 513847 0) 0 nil])
([nil nil ((15684 . 15686)) nil (26946 40594 513846 0) 0 nil])
([nil nil ((#("L" 0 1 (face font-lock-string-face fontified t)) . -15685) (undo-tree-id6 . -1) 15686) nil (26946 40594 513845 0) 0 nil])
([nil nil ((15685 . 15692)) nil (26946 40594 513842 0) 0 nil])
([nil nil ((#(";" 0 1 (face font-lock-string-face fontified t)) . -15691) (undo-tree-id5 . -1) 15692) nil (26946 40594 513841 0) 0 nil])
([nil nil ((15691 . 15692)) nil (26946 40594 513840 0) 0 nil])
([nil nil ((15692 . 15693)) nil (26946 40594 513840 0) 0 nil])
([nil nil ((15693 . 15694)) nil (26946 40594 513840 0) 0 nil])
([nil nil ((#("#" 0 1 (face font-lock-string-face fontified t)) . -15693) (undo-tree-id4 . -1) 15694) nil (26946 40594 513839 0) 0 nil])
([nil nil ((15693 . 15698)) nil (26946 40594 513838 0) 0 nil])
([nil nil ((#("é" 0 1 (face font-lock-string-face fontified t)) . -15696) (undo-tree-id2 . -1) (#(")" 0 1 (face font-lock-string-face fontified t)) . -15697) (undo-tree-id3 . -1) 15698) nil (26946 40594 513837 0) 0 nil])
([nil nil ((15696 . 15698)) nil (26946 40594 513834 0) 0 nil])
([nil nil ((#(")" 0 1 (fontified t)) . -15697) (undo-tree-id1 . -1) 15698) nil (26946 40594 513833 0) 0 nil])
([nil nil ((15697 . 15698)) nil (26946 40594 513823 0) 0 nil])
([nil nil ((15698 . 15705)) nil (26946 40594 513821 0) 0 nil])
([nil nil ((15705 . 15706)) nil (26946 40594 513817 0) 0 nil])
([nil nil ((15684 . 15687) (t 26946 40594 0 0)) nil (26946 40599 102015 0) 0 nil])
([nil nil ((15687 . 15688)) nil (26946 40599 102011 0) 0 nil])
([nil nil ((15700 . 15701) (t 26946 40599 0 0)) nil (26946 40628 648616 0) 0 nil])
([nil nil ((15701 . 15702)) nil (26946 40628 648614 0) 0 nil])
([nil nil ((#("
" 0 1 (face font-lock-string-face fontified t)) . -15701) (undo-tree-id11 . -1) (undo-tree-id12 . 1) (undo-tree-id13 . -1) (undo-tree-id14 . -1) (undo-tree-id15 . -1) 15702) nil (26946 40628 648612 0) 0 nil])
([nil nil ((15664 . 15671) (t 26946 40628 0 0)) nil (26946 41045 583762 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 15710 . 15711) (nil fontified nil 15702 . 15711) (nil fontified nil 15681 . 15702) (nil fontified nil 15671 . 15681) (15671 . 15711)) nil (26946 41045 583761 0) 0 nil])
([nil nil ((#("FILTERS" 0 7 (face font-lock-string-face fontified t)) . -15688) (undo-tree-id41 . -7) 15695) nil (26946 41045 583760 0) 0 nil])
([nil nil ((15688 . 15690)) nil (26946 41045 583759 0) 0 nil])
([nil nil ((#("filters" 0 7 (fontified t)) . -15698) (undo-tree-id40 . -7) 15705) nil (26946 41045 583759 0) 0 nil])
([nil nil ((15698 . 15700)) nil (26946 41045 583758 0) 0 nil])
([nil nil ((15700 . 15702)) nil (26946 41045 583757 0) 0 nil])
([nil nil ((#("p" 0 1 (fontified t)) . -15699) (undo-tree-id16 . -1) (undo-tree-id17 . -1) (undo-tree-id18 . -1) (undo-tree-id19 . -1) (undo-tree-id20 . -1) (undo-tree-id21 . -1) (undo-tree-id22 . -1) (undo-tree-id23 . -1) (undo-tree-id24 . -1) (undo-tree-id25 . -1) (#("t" 0 1 (fontified t)) . -15700) (undo-tree-id26 . -1) (undo-tree-id27 . -1) (undo-tree-id28 . -1) (undo-tree-id29 . -1) (undo-tree-id30 . -1) (undo-tree-id31 . -1) (undo-tree-id32 . -1) (#("t" 0 1 (fontified t)) . -15701) (undo-tree-id33 . -1) (undo-tree-id34 . -1) (undo-tree-id35 . -1) (undo-tree-id36 . -1) (undo-tree-id37 . -1) (undo-tree-id38 . -1) (undo-tree-id39 . -1) 15702) nil (26946 41045 583754 0) 0 nil])
([nil nil ((15699 . 15700)) nil (26946 41045 583719 0) 0 nil])
([nil nil ((14379 . 14386) (t 26946 41045 0 0)) nil (26946 42290 51112 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 14420 . 14421) (nil fontified nil 14386 . 14421) (14386 . 14421)) nil (26946 42291 313958 0) 0 nil])
([nil nil ((14457 . 14459)) nil (26946 42317 984389 0) 0 nil] [nil nil ((14421 . 14428)) ((#("
      " 0 1 (face font-lock-comment-face fontified t) 1 7 (fontified t)) . 14421) (undo-tree-id44 . -7) (undo-tree-id45 . -7) (undo-tree-id46 . -7) (undo-tree-id47 . -1) (undo-tree-id48 . -1) (undo-tree-id49 . -7) (undo-tree-id50 . -7) (undo-tree-id51 . -7) (undo-tree-id52 . -7)) (26946 42290 51260 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 17110 . 17111) (nil fontified nil 14459 . 17111) (14459 . 17111)) nil (26946 42317 984388 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 17079 . 17080) (nil fontified nil 14428 . 17080) (14428 . 17080)) ((#("(lumen.core.router:defroute GET (route-spec base-list) (req)
         (guard! req :index)
         (let* ((ctx (ctx-from-req* req))
                (qp  (lumen.core.http:req-query req)) ;; qp est une alist: ((\"key\" . \"val\") ...)
                
                ;; --- CORRECTION FILTRAGE ---
                ;; 1. Définir les clés réservées au moteur CRUD
                (reserved-keys '(\"q\" \"select\" \"order\" \"key\" \"after\" \"before\" \"page\" \"page_size\" \"limit\"))
                
                ;; 2. Filtres explicites (si on utilise ?q=...)
                (filters-q (or (lumen.utils:alist-get qp :q) '()))
                
                ;; 3. Filtres implicites (tout paramètre racine qui n'est PAS réservé)
                ;; Ex: ?target_id=... devient un filtre
                (filters-root (remove-if (lambda (pair) 
                                           (member (car pair) reserved-keys :test #'string-equal)) 
                                         qp))
                
                ;; 4. Fusion des deux
                (filters (append filters-q filters-root))
                ;; ---------------------------

                (select   (%parse-select (lumen.utils:alist-get qp :select)))
                (order    (or (%ensure-order-whitelist
                               (%parse-order (lumen.utils:alist-get qp :order))
                               (or order-whitelist
                                   (mapcar (lambda (f) (getf f :col))
                                           (lumen.data.dao:entity-fields entity))))
                              (%derive-default-order entity)))
                (key      (%parse-key (lumen.utils:alist-get qp :key)))
                (after    (%parse-after/before (lumen.utils:alist-get qp :after)))
                (before   (%parse-after/before (lumen.utils:alist-get qp :before)))
                (page     (%maybe-number (lumen.utils:alist-get qp :page)))
                (psize    (%maybe-number (lumen.utils:alist-get qp :page_size)))
                (limit    (%maybe-number (lumen.utils:alist-get qp :limit))))
           
           ;; Debug log pour vérifier que les filtres sont bien pris
           ;; (format t \"~&[DEBUG] Index filters: ~S~%\" filters)
           
           (lumen.core.http:respond-json
            (lumen.data.repo.core:repo-index entity ctx
                                             :filters filters 
                                             :order order :select select
                                             :page page :page-size psize :limit limit
                                             :after after :before before :key key))))" 0 82 (fontified nil) 82 88 (face font-lock-builtin-face fontified nil) 88 100 (fontified nil) 100 104 (face font-lock-keyword-face fontified nil) 104 186 (fontified nil) 186 189 (face font-lock-comment-delimiter-face fontified nil) 189 229 (face font-lock-comment-face fontified nil) 229 262 (fontified nil) 262 265 (face font-lock-comment-delimiter-face fontified nil) 265 293 (face font-lock-comment-face fontified nil) 293 309 (fontified nil) 309 312 (face font-lock-comment-delimiter-face fontified nil) 312 357 (face font-lock-comment-face fontified nil) 357 390 (fontified nil) 390 393 (face font-lock-string-face fontified nil) 393 394 (fontified nil) 394 402 (face font-lock-string-face fontified nil) 402 403 (fontified nil) 403 410 (face font-lock-string-face fontified nil) 410 411 (fontified nil) 411 416 (face font-lock-string-face fontified nil) 416 417 (fontified nil) 417 424 (face font-lock-string-face fontified nil) 424 425 (fontified nil) 425 433 (face font-lock-string-face fontified nil) 433 434 (fontified nil) 434 440 (face font-lock-string-face fontified nil) 440 441 (fontified nil) 441 452 (face font-lock-string-face fontified nil) 452 453 (fontified nil) 453 460 (face font-lock-string-face fontified nil) 460 496 (fontified nil) 496 499 (face font-lock-comment-delimiter-face fontified nil) 499 544 (face font-lock-comment-face fontified nil) 544 601 (fontified nil) 601 603 (face font-lock-builtin-face fontified nil) 603 644 (fontified nil) 644 647 (face font-lock-comment-delimiter-face fontified nil) 647 715 (face font-lock-comment-face fontified nil) 715 731 (fontified nil) 731 734 (face font-lock-comment-delimiter-face fontified nil) 734 771 (face font-lock-comment-face fontified nil) 771 813 (fontified nil) 813 819 (face font-lock-keyword-face fontified nil) 819 904 (fontified nil) 904 909 (face font-lock-builtin-face fontified nil) 909 1007 (fontified nil) 1007 1010 (face font-lock-comment-delimiter-face fontified nil) 1010 1029 (face font-lock-comment-face fontified nil) 1029 1103 (fontified nil) 1103 1106 (face font-lock-comment-delimiter-face fontified nil) 1106 1134 (face font-lock-comment-face fontified nil) 1134 1202 (fontified nil) 1202 1209 (face font-lock-builtin-face fontified nil) 1209 1339 (fontified nil) 1339 1345 (face font-lock-builtin-face fontified nil) 1345 1443 (fontified nil) 1443 1449 (face font-lock-keyword-face fontified nil) 1449 1462 (fontified nil) 1462 1466 (face font-lock-builtin-face fontified nil) 1466 1494 (fontified nil) 1494 1553 (fontified nil) 1553 1680 (fontified nil) 1680 1684 (face font-lock-builtin-face fontified nil) 1684 1761 (fontified nil) 1761 1767 (face font-lock-builtin-face fontified nil) 1767 1844 (fontified nil) 1844 1851 (face font-lock-builtin-face fontified nil) 1851 1922 (fontified nil) 1922 1927 (face font-lock-builtin-face fontified nil) 1927 1998 (fontified nil) 1998 2008 (face font-lock-builtin-face fontified nil) 2008 2079 (fontified nil) 2079 2085 (face font-lock-builtin-face fontified nil) 2085 2113 (fontified nil) 2113 2116 (face font-lock-comment-delimiter-face fontified nil) 2116 2171 (face font-lock-comment-face fontified nil) 2171 2182 (fontified nil) 2182 2185 (face font-lock-comment-delimiter-face fontified nil) 2185 2236 (face font-lock-comment-face fontified nil) 2236 2390 (fontified nil) 2390 2398 (face font-lock-builtin-face fontified nil) 2398 2453 (fontified nil) 2453 2459 (face font-lock-builtin-face fontified nil) 2459 2466 (fontified nil) 2466 2473 (face font-lock-builtin-face fontified nil) 2473 2526 (fontified nil) 2526 2531 (face font-lock-builtin-face fontified nil) 2531 2537 (fontified nil) 2537 2547 (face font-lock-builtin-face fontified nil) 2547 2554 (fontified nil) 2554 2560 (face font-lock-builtin-face fontified nil) 2560 2567 (fontified nil) 2567 2612 (fontified nil) 2612 2618 (face font-lock-builtin-face fontified nil) 2618 2625 (fontified nil) 2625 2632 (face font-lock-builtin-face fontified nil) 2632 2640 (fontified nil) 2640 2644 (face font-lock-builtin-face fontified nil) 2644 2651 (fontified nil) 2651 2652 (rear-nonsticky nil fontified nil)) . 14428) (undo-tree-id42 . -2102) (undo-tree-id43 . -2102) (nil fontified t 16988 . 16995) (nil fontified t 16982 . 16988) (nil fontified t 16975 . 16982) (nil fontified t 16965 . 16975) (nil fontified t 16959 . 16965) (nil fontified t 16954 . 16959) (nil fontified t 16901 . 16954) (nil fontified t 16894 . 16901) (nil fontified t 16887 . 16894) (nil fontified t 16881 . 16887) (nil fontified t 16826 . 16881) (nil fontified t 16818 . 16826) (nil fontified t 16664 . 16818) (nil fontified t 16613 . 16664) (nil fontified t 16610 . 16613) (nil fontified t 16599 . 16610) (nil fontified t 16544 . 16599) (nil fontified t 16541 . 16544) (nil fontified t 16513 . 16541) (nil fontified t 16507 . 16513) (nil fontified t 16436 . 16507) (nil fontified t 16426 . 16436) (nil fontified t 16355 . 16426) (nil fontified t 16350 . 16355) (nil fontified t 16279 . 16350) (nil fontified t 16272 . 16279) (nil fontified t 16195 . 16272) (nil fontified t 16189 . 16195) (nil fontified t 16112 . 16189) (nil fontified t 16108 . 16112) (nil fontified t 15981 . 16108) (nil fontified t 15922 . 15981) (nil fontified t 15894 . 15922) (nil fontified t 15890 . 15894) (nil fontified t 15877 . 15890) (nil fontified t 15871 . 15877) (nil fontified t 15773 . 15871) (nil fontified t 15767 . 15773) (nil fontified t 15637 . 15767) (nil fontified t 15630 . 15637) (nil fontified t 15562 . 15630) (nil fontified t 15534 . 15562) (nil fontified t 15531 . 15534) (nil fontified t 15457 . 15531) (nil fontified t 15438 . 15457) (nil fontified t 15435 . 15438) (nil fontified t 15337 . 15435) (nil fontified t 15332 . 15337) (nil fontified t 15247 . 15332) (nil fontified t 15241 . 15247) (nil fontified t 15199 . 15241) (nil fontified t 15162 . 15199) (nil fontified t 15159 . 15162) (nil fontified t 15143 . 15159) (nil fontified t 15075 . 15143) (nil fontified t 15072 . 15075) (nil fontified t 15031 . 15072) (nil fontified t 15029 . 15031) (nil fontified t 14972 . 15029) (nil fontified t 14927 . 14972) (nil fontified t 14924 . 14927) (nil fontified t 14888 . 14924) (nil fontified t 14881 . 14888) (nil fontified t 14880 . 14881) (nil fontified t 14869 . 14880) (nil fontified t 14868 . 14869) (nil fontified t 14862 . 14868) (nil fontified t 14861 . 14862) (nil fontified t 14853 . 14861) (nil fontified t 14852 . 14853) (nil fontified t 14845 . 14852) (nil fontified t 14844 . 14845) (nil fontified t 14839 . 14844) (nil fontified t 14838 . 14839) (nil fontified t 14831 . 14838) (nil fontified t 14830 . 14831) (nil fontified t 14822 . 14830) (nil fontified t 14821 . 14822) (nil fontified t 14818 . 14821) (nil fontified t 14785 . 14818) (nil fontified t 14740 . 14785) (nil fontified t 14737 . 14740) (nil fontified t 14721 . 14737) (nil fontified t 14693 . 14721) (nil fontified t 14690 . 14693) (nil fontified t 14657 . 14690) (nil fontified t 14617 . 14657) (nil fontified t 14614 . 14617) (nil fontified t 14532 . 14614) (nil fontified t 14528 . 14532) (nil fontified t 14516 . 14528) (nil fontified t 14510 . 14516) (nil fontified t 14428 . 14510) (nil rear-nonsticky t 17079 . 17080)) (26946 42290 51106 0) 0 nil])
([nil nil ((#("
        (lumen.core.router:defroute GET (route-spec base-list) (req)
           (guard! req :index)
           (let* ((ctx (ctx-from-req* req))
                  (qp  (lumen.core.http:req-query req))
                  (filters  (or (lumen.utils:alist-get qp :q) '()))
                  (select   (%parse-select (lumen.utils:alist-get qp :select)))
                  (order    (or (%ensure-order-whitelist
                                 (%parse-order (lumen.utils:alist-get qp :order))
                                 (or order-whitelist
                                     (mapcar (lambda (f) (getf f :col))
                                             (lumen.data.dao:entity-fields entity))))
                                (%derive-default-order entity)))
                  (key      (%parse-key (lumen.utils:alist-get qp :key)))
                  (after    (%parse-after/before (lumen.utils:alist-get qp :after)))
                  (before   (%parse-after/before (lumen.utils:alist-get qp :before)))
                  (page     (%maybe-number (lumen.utils:alist-get qp :page)))
                  (psize    (%maybe-number (lumen.utils:alist-get qp :page_size)))
                  (limit    (%maybe-number (lumen.utils:alist-get qp :limit))))
	     (format t \"~&*** QP: ~A~%\" qp)
	     (format t \"~&*** FILTERS: ~A~%\" filters)
             (lumen.core.http:respond-json
              (lumen.data.repo.core:repo-index entity ctx
                                               :filters filters :order order :select select
                                               :page page :page-size psize :limit limit
                                               :after after :before before :key key))))" 0 1 (fontified t) 1 93 (fontified t) 93 99 (face font-lock-builtin-face fontified t) 99 113 (fontified t) 113 117 (face font-lock-keyword-face fontified t) 117 241 (fontified t) 241 259 (fontified t) 259 261 (face font-lock-builtin-face fontified t) 261 269 (fontified t) 269 338 (fontified t) 338 345 (face font-lock-builtin-face fontified t) 345 479 (fontified t) 479 485 (face font-lock-builtin-face fontified t) 485 587 (fontified t) 587 593 (face font-lock-keyword-face fontified t) 593 606 (fontified t) 606 610 (face font-lock-builtin-face fontified t) 610 745 (fontified t) 745 764 (fontified t) 764 830 (fontified t) 830 834 (face font-lock-builtin-face fontified t) 834 913 (fontified t) 913 919 (face font-lock-builtin-face fontified t) 919 998 (fontified t) 998 1005 (face font-lock-builtin-face fontified t) 1005 1078 (fontified t) 1078 1083 (face font-lock-builtin-face fontified t) 1083 1156 (fontified t) 1156 1166 (face font-lock-builtin-face fontified t) 1166 1170 (fontified t) 1170 1239 (fontified t) 1239 1245 (face font-lock-builtin-face fontified t) 1245 1250 (fontified t) 1250 1256 (fontified t) 1256 1266 (fontified t) 1266 1282 (face font-lock-string-face fontified t) 1282 1285 (fontified t) 1285 1286 (fontified t rear-nonsticky t) 1286 1287 (fontified t) 1287 1303 (fontified t) 1303 1324 (face font-lock-string-face fontified t) 1324 1333 (fontified t) 1333 1334 (fontified t) 1334 1465 (fontified t) 1465 1482 (fontified t) 1482 1490 (face font-lock-builtin-face fontified t) 1490 1499 (fontified t) 1499 1501 (face font-lock-builtin-face fontified t) 1501 1505 (face font-lock-builtin-face fontified t) 1505 1512 (fontified t) 1512 1519 (face font-lock-builtin-face fontified t) 1519 1527 (fontified t) 1527 1574 (fontified t) 1574 1579 (face font-lock-builtin-face fontified t) 1579 1585 (fontified t) 1585 1595 (face font-lock-builtin-face fontified t) 1595 1602 (fontified t) 1602 1608 (face font-lock-builtin-face fontified t) 1608 1662 (fontified t) 1662 1668 (face font-lock-builtin-face fontified t) 1668 1675 (fontified t) 1675 1682 (face font-lock-builtin-face fontified t) 1682 1690 (fontified t) 1690 1694 (face font-lock-builtin-face fontified t) 1694 1702 (fontified t)) . -17111) (undo-tree-id67 . -1293) (undo-tree-id68 . -1273) (undo-tree-id69 . -1283) (undo-tree-id70 . -1702) (undo-tree-id71 . -1256) (undo-tree-id72 . -1527) (undo-tree-id73 . -1527) (undo-tree-id74 . -1) (undo-tree-id75 . -1527) (undo-tree-id76 . -69) (undo-tree-id77 . -69) (undo-tree-id78 . -69) (undo-tree-id79 . -69) (undo-tree-id80 . -69) (undo-tree-id81 . -69) (undo-tree-id82 . -1526) (undo-tree-id83 . -1526) (undo-tree-id84 . -1526) (undo-tree-id85 . -1526) (undo-tree-id86 . -1613) (undo-tree-id87 . -1613) (undo-tree-id88 . -1701) (undo-tree-id89 . -1701) (undo-tree-id90 . -1701) (undo-tree-id91 . -1701) (undo-tree-id92 . -1701) (undo-tree-id93 . -1701) (undo-tree-id94 . -1615) (undo-tree-id95 . -1702) (undo-tree-id96 . -1702) (undo-tree-id97 . -1702) (undo-tree-id98 . -1702) 18813) nil (26946 42317 984386 0) 0 nil])
nil
([nil nil ((#(";" 0 1 (face font-lock-comment-face fontified t)) . -16641) (undo-tree-id53 . -1) (undo-tree-id54 . -1) (undo-tree-id55 . -1) (undo-tree-id56 . -1) (undo-tree-id57 . -1) (undo-tree-id58 . -1) (undo-tree-id59 . -1) (#(";" 0 1 (face font-lock-comment-delimiter-face fontified t)) . -16642) (undo-tree-id60 . -1) (undo-tree-id61 . -1) (undo-tree-id62 . -1) (undo-tree-id63 . -1) (undo-tree-id64 . -1) (undo-tree-id65 . -1) (undo-tree-id66 . -1) 16643) nil (26946 42317 984366 0) 0 nil])
([nil nil ((#(" " 0 1 (fontified t)) . 16641)) nil (26946 42317 984339 0) 0 nil])
([nil nil ((13658 . 13660) (t 26946 42317 0 0)) nil (26948 7792 471205 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 15523 . 15524) (nil fontified nil 13660 . 15524) (13660 . 15524)) nil (26948 7792 471204 0) 0 nil])
([nil nil ((18897 . 18898) (18810 . 18811) (18736 . 18737) (18672 . 18673) (18582 . 18583) (18539 . 18540) (18464 . 18465) (18394 . 18395) (18308 . 18309) (18226 . 18227) (18149 . 18150) (18064 . 18065) (17980 . 17981) (17907 . 17908) (17857 . 17858) (17785 . 17786) (17706 . 17707) (17647 . 17651) ("                               " . 17647) (17594 . 17598) ("                               " . 17594) (17554 . 17555) (17475 . 17476) (17426 . 17427) (17367 . 17368) (17328 . 17329) (17289 . 17290) (17190 . 17191) (17105 . 17106) (17048 . 17049) (16960 . 16961) (16875 . 16876) (16810 . 16811) (16686 . 16687) (16621 . 16622) (16573 . 16574) (16458 . 16459) (16408 . 16409) (16378 . 16379) (#("   " 0 3 (fontified t)) . -13490) (#("     " 0 5 (fontified t)) . -13402) (#("   " 0 3 (fontified t)) . -13367) (#("   " 0 3 (fontified t)) . -13324) (#("   " 0 3 (fontified t)) . -13276) 13156) nil (26948 7792 471198 0) 0 nil])
([nil nil ((851 . 852) (t 26948 7792 0 0)) nil (26949 32175 544761 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 867 . 868) (nil fontified nil 852 . 868) (852 . 868)) nil (26949 32175 544760 0) 0 nil])
([nil nil ((#("metadata" 0 7 (face font-lock-builtin-face fontified t) 7 8 (face font-lock-builtin-face rear-nonsticky t fontified t)) . 860) (undo-tree-id99 . -8)) nil (26949 32175 544759 0) 0 nil])
([nil nil ((860 . 865)) nil (26949 32175 544746 0) 0 nil])
([nil nil ((#("#|
(defmethod mount-crud! ((entity symbol)
                        &key (base \"/api\") (name nil)
                          (order-whitelist '())
                          (auth-guard nil)
                          (host nil)) ;; <<--- NOUVEAU
  \"Monte des routes CRUD pour ENTITY, en s’appuyant sur lumen.data.repo.
:host peut être une string ou une liste de hosts (utilise defroute v2 :host/:hosts).\"
  (let* ((md (lumen.data.dao:entity-metadata entity))
         (seg (or name (getf md :table)))
         (base-list (format nil \"~a/~a\" base seg))
         ;;(base-item (format nil \"~a/~a/(?<id>[^/]+)\" base seg))
	 (base-item (format nil \"~a/~a/:id\" base seg)))
    (labels
        ((ctx-from-req* (req) (lumen.core.http:ctx-from-req req))

	 #|
         (guard! (req)
           (when (and auth-guard (not (funcall auth-guard req)))
         (return-from guard! (lumen.core.http:respond-404))))
	 |#

	 (guard! (req op)
           (when auth-guard
             (let ((gret (funcall auth-guard req :op op)))
               (unless (eq gret t)
		 (return-from guard! gret)))))

         (route-spec (path)
           (cond
             ((null host) path)
             ((stringp host) (list :host host :path path))
             ((listp host)   (list :hosts host :path path))
             (t path))))

      ;; INDEX
      ;; GET (:host ... :path /api/<seg>)
      (defroute GET (route-spec base-list) (req)
		(guard! req :index)
		(let* ((ctx (ctx-from-req* req))
		       (qp  (lumen.core.http:req-query req))
		       (filters  (or (lumen.utils:alist-get qp :q)
				     '()))
		       (select   (%parse-select (lumen.utils:alist-get qp :select)))
		       (order    (or (%ensure-order-whitelist
				      (%parse-order (lumen.utils:alist-get qp :order))
				      (or order-whitelist
					  (mapcar (lambda (f) (getf f :col))
						  (lumen.data.dao:entity-fields entity))))
				     (%derive-default-order entity)))
		       (key      (%parse-key (lumen.utils:alist-get qp :key)))
		       (after    (%parse-after/before (lumen.utils:alist-get qp :after)))
		       (before   (%parse-after/before (lumen.utils:alist-get qp :before)))
		       (page     (%maybe-number (lumen.utils:alist-get qp :page)))
		       (psize    (%maybe-number (lumen.utils:alist-get qp :page_size)))
		       (limit    (%maybe-number (lumen.utils:alist-get qp :limit))))
		  (lumen.core.http:respond-json
		   (lumen.data.repo.core:repo-index entity ctx
						    :filters filters :order order :select select
						    :page page :page-size psize :limit limit
						    :after after :before before :key key))))

      ;; SHOW
      ;; GET (:host ... :path /api/<seg>/:id)        
      (defroute GET (route-spec base-item) (req)
	(guard! req :show)
	;;(print \"IN GET\")
	(lumen.core.router:with-params (req id)
	  ;;(format t \"~&ID: ~A~%\" id)
	  (let* ((ctx (ctx-from-req* req))
		 (row (lumen.data.repo.core:repo-show entity ctx id)))
	    ;;(print row)
	    (if row
		(lumen.core.http:respond-json row)
		(lumen.core.http:respond-404)))))

      ;; CREATE
      ;; POST (:host ... :path /api/<seg>)
      (defroute POST (route-spec base-list) (req)
		(guard! req :create)
		(let* ((ctx (ctx-from-req* req))
		       (payload (lumen.core.http:ctx-get req :json))
		       (res (lumen.data.repo.core:repo-create entity ctx payload)))
		  (lumen.core.http:respond-json res :status 201)))

      ;; PATCH
      ;; PATCH (:host ... :path /api/<seg>/:id)        
      (defroute PATCH (route-spec base-item) (req)
		(guard! req :patch)
		(lumen.core.router:with-params (req id)
		  (let* ((ctx (ctx-from-req* req))
			 (payload (lumen.core.http:ctx-get req :json))
			 (res (lumen.data.repo.core:repo-patch entity ctx id payload)))
		    (lumen.core.http:respond-json res))))

      ;; DELETE
      ;; DELETE (:host ... :path /api/<seg>/:id)
      (defroute DELETE (route-spec base-item) (req)
		(guard! req :delete)
		(lumen.core.router:with-params (req id)
		  (let* ((ctx (ctx-from-req* req))
			 (res (lumen.data.repo.core:repo-delete entity ctx id)))
		    (lumen.core.http:respond-json res))))

      ;; Retourne les patterns montés (utile pour introspection/tests)
      (list base-list base-item))))
|#" 0 2 (face font-lock-comment-delimiter-face fontified t) 2 25 (face font-lock-comment-face fontified t) 25 597 (face font-lock-comment-face fontified t) 597 598 (face (font-lock-negation-char-face font-lock-comment-face) fontified t) 598 1525 (face font-lock-comment-face fontified t) 1525 1564 (face font-lock-comment-face fontified t) 1564 3591 (face font-lock-comment-face fontified t) 3591 4184 (face font-lock-comment-face fontified t) 4184 4186 (face font-lock-comment-delimiter-face fontified t)) . 8982) (undo-tree-id10 . -4186) (t 26949 32175 0 0)) nil (26977 6216 252906 0) 0 nil])
([nil nil ((#("
" 0 1 (fontified t)) . 8982)) nil (26977 6216 252905 0) 0 nil])
([nil nil ((8982 . 8984)) nil (26977 6216 252904 0) 0 nil])
([nil nil ((16510 . 16512)) nil (26977 6216 252904 0) 0 nil])
([nil nil ((16512 . 16514)) nil (26977 6216 252904 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 23036 . 23037) (nil fontified nil 16514 . 23037) (16514 . 23037)) nil (26977 6216 252903 0) 0 nil])
([nil nil ((#("\"Monte des routes CRUD sécurisées qui capturent les erreurs métier.\"" 0 68 (face font-lock-doc-face fontified t)) . -16814) (undo-tree-id3 . -68) (undo-tree-id4 . -68) (undo-tree-id5 . -68) (undo-tree-id6 . -68) (undo-tree-id7 . -68) (undo-tree-id8 . -68) (undo-tree-id9 . -68) 16882) nil (26977 6216 252902 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 18779 . 18780) (nil fontified nil 18073 . 18780) (nil fontified nil 18070 . 18073) (nil fontified nil 17955 . 18070) (nil fontified nil 17950 . 17955) (nil fontified nil 17928 . 17950) (nil fontified nil 17927 . 17928) (nil fontified nil 16814 . 17927) (16814 . 18780)) nil (26977 6216 252896 0) 0 nil])
([nil nil ((#("
" 0 1 (fontified t)) . 18780) (undo-tree-id0 . -1) (undo-tree-id1 . -1) (undo-tree-id2 . -1)) nil (26977 6216 252894 0) 0 nil])
([nil nil ((24934 . 24935) 18780) nil (26977 6216 252877 0) 0 nil])
([nil nil ((581 . 583) (539 . 541) (#("   " 0 3 (fontified nil)) . 539) (581 . 582) (t 26977 6216 0 0)) nil (26977 8063 759735 0) 0 nil])
([nil nil ((nil fontified nil 688 . 689) (nil fontified nil 687 . 688) (nil fontified nil 666 . 687) (nil fontified nil 665 . 666) (nil fontified nil 664 . 665) (nil fontified nil 663 . 664) (nil fontified nil 639 . 663) (nil fontified nil 638 . 639) (nil fontified nil 637 . 638) (nil fontified nil 636 . 637) (nil fontified nil 619 . 636) (nil fontified nil 616 . 619) (nil fontified nil 614 . 616) (nil fontified nil 613 . 614) (nil fontified nil 597 . 613) (nil fontified nil 596 . 597) (nil fontified nil 584 . 596) (nil fontified nil 583 . 584) (583 . 689)) nil (26977 8063 759734 0) 0 nil])
([nil nil ((#("(let ((msg (format nil \"~A\" c)))" 0 1 (fontified t) 1 4 (face font-lock-keyword-face fontified t) 4 23 (fontified t) 23 27 (face font-lock-string-face fontified t) 27 32 (fontified t)) . -19762) (undo-tree-id32 . -32) (undo-tree-id33 . -32) (undo-tree-id34 . -32) (undo-tree-id35 . -32) (undo-tree-id36 . -32) (undo-tree-id37 . -32) (undo-tree-id38 . -32) 19794) nil (26977 8063 759731 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 19927 . 19928) (nil fontified nil 19762 . 19928) (19762 . 19928)) nil (26977 8063 759723 0) 0 nil])
([nil nil ((#(";" 0 1 (face font-lock-comment-face fontified t)) . -19986) (undo-tree-id11 . -1) (undo-tree-id12 . -1) (undo-tree-id13 . -1) (undo-tree-id14 . -1) (undo-tree-id15 . -1) (undo-tree-id16 . -1) (undo-tree-id17 . -1) (#(";" 0 1 (face font-lock-comment-delimiter-face fontified t)) . -19987) (undo-tree-id18 . -1) (undo-tree-id19 . -1) (undo-tree-id20 . -1) (undo-tree-id21 . -1) (undo-tree-id22 . -1) (undo-tree-id23 . -1) (undo-tree-id24 . -1) (#(" " 0 1 (face font-lock-comment-delimiter-face fontified t)) . -19988) (undo-tree-id25 . -1) (undo-tree-id26 . -1) (undo-tree-id27 . -1) (undo-tree-id28 . -1) (undo-tree-id29 . -1) (undo-tree-id30 . -1) (undo-tree-id31 . -1) 19989) nil (26977 8063 759719 0) 0 nil])
([nil nil ((20032 . 20039) (t 26977 8063 0 0)) nil (26977 11862 128679 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 20093 . 20094) (nil fontified nil 20039 . 20094) (20039 . 20094)) nil (26977 11862 128662 0) 0 nil])
([nil nil ((#("400" 0 3 (fontified t)) . -20275) (undo-tree-id39 . -3) (undo-tree-id40 . -1) (undo-tree-id41 . -1) (undo-tree-id42 . -1) (undo-tree-id43 . -1) (undo-tree-id44 . -1) (undo-tree-id45 . -3) (undo-tree-id46 . -3) (undo-tree-id47 . -3) (undo-tree-id48 . -3) (undo-tree-id49 . -3) (undo-tree-id50 . -3) (undo-tree-id51 . -3) (undo-tree-id52 . -3) 20278 (t 26977 11862 0 0)) nil (26977 12052 921885 0) 0 nil])
([nil nil ((20275 . 20279)) nil (26977 12052 921865 0) 0 nil])
([nil nil ((#("
  ;; DB
  (:import-from :lumen.data.db   :with-tx)" 0 3 (fontified t) 3 6 (face font-lock-comment-delimiter-face fontified t) 6 9 (face font-lock-comment-face fontified t) 9 12 (fontified t) 12 24 (face font-lock-builtin-face fontified t) 24 25 (fontified t) 25 39 (face font-lock-builtin-face fontified t) 39 42 (fontified t) 42 50 (face font-lock-builtin-face fontified t) 50 51 (fontified t)) . 1094) (undo-tree-id53 . -51) (t 26977 12052 0 0)) nil (26978 4355 494678 0) 0 nil])
([nil nil ((1227 . 1228) (t 26978 4355 0 0)) nil (26981 62553 178421 0) 0 nil])
([nil nil ((1228 . 1229)) nil (26981 62553 178420 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 1249 . 1250) (nil fontified nil 1229 . 1250) (1229 . 1250)) nil (26981 62553 178416 0) 0 nil])
([nil nil ((1229 . 1237) (#("REGISTER" 0 8 (face font-lock-builtin-face fontified t sldb-default-action sldb-inspect-condition)) . 1229) (t 26981 62553 0 0)) nil (26981 62560 621855 0) 0 nil])
([nil nil ((1237 . 1244) (#("-CUSTOM" 0 7 (face font-lock-builtin-face fontified t sldb-default-action sldb-inspect-condition)) . 1237)) nil (26981 62560 621854 0) 0 nil])
([nil nil ((1244 . 1250) (#("-ROUTE" 0 5 (face font-lock-builtin-face fontified t sldb-default-action sldb-inspect-condition) 5 6 (face font-lock-builtin-face rear-nonsticky t fontified t sldb-default-action sldb-inspect-condition)) . 1244)) nil (26981 62560 621853 0) 0 nil])
([nil nil ((1229 . 1231) (1227 . 1228)) nil (26981 62560 621848 0) 0 nil])
([nil nil ((#("extras" 0 6 (face font-lock-builtin-face fontified t)) . -157) (undo-tree-id12 . -6) (undo-tree-id13 . -1) 163 (t 26981 62560 0 0)) nil (26981 62867 59627 0) 0 nil])
([nil nil ((157 . 159)) nil (26981 62867 59625 0) 0 nil])
([nil nil ((#("i" 0 1 (face font-lock-builtin-face fontified t)) . -158) (undo-tree-id11 . -1) 159) nil (26981 62867 59625 0) 0 nil])
([nil nil ((158 . 162)) nil (26981 62867 59623 0) 0 nil])
([nil nil ((#("extras" 0 6 (fontified t)) . -4366) (undo-tree-id0 . -6) (undo-tree-id1 . -5) (undo-tree-id2 . -5) (undo-tree-id3 . -5) (undo-tree-id4 . -5) (undo-tree-id5 . -5) (undo-tree-id6 . -5) (undo-tree-id7 . -6) (undo-tree-id8 . -6) (undo-tree-id9 . -6) (undo-tree-id10 . -6) 4372) nil (26981 62867 59621 0) 0 nil])
([nil nil ((4366 . 4371)) nil (26981 62867 59600 0) 0 nil])
([nil nil ((1255 . 1257) (t 26993 53276 0 0)) nil (26996 23281 918330 0) 0 nil])
([nil nil ((#("x" 0 1 (fontified t)) . -1255) (undo-tree-id0 . -1) (#("g" 0 1 (fontified t)) . -1256) (undo-tree-id1 . -1) 1257) nil (26996 23281 918326 0) 0 nil])
([nil nil ((#("auth-jwt" 0 8 (fontified t)) . -8588) (8596 . 8611) (#("auth-jwt" 0 8 (fontified t)) . -7832) (7840 . 7855) (#("auth-jwt" 0 8 (face font-lock-doc-face fontified t)) . -7779) (7787 . 7802) (#("auth-jwt" 0 8 (fontified t)) . -7428) (t 26996 23281 0 0) (7436 . 7451) (t 26996 23281 0 0)) nil (26996 57090 661985 0) 0 nil])
([nil nil ((756 . 759) (t 26996 57090 0 0)) nil (26996 65218 306363 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 795 . 796) (nil fontified nil 759 . 796) (759 . 796)) nil (26996 65218 306363 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 773 . 774) (nil fontified nil 773 . 774) (nil fontified nil 772 . 773) (nil fontified nil 760 . 772) (nil fontified nil 759 . 760) (759 . 774)) nil (26996 65218 306362 0) 0 nil])
([nil nil ((795 . 796)) nil (26996 65218 306360 0) 0 nil])
([nil nil ((812 . 813)) nil (26996 65218 306356 0) 0 nil])
([nil nil ((#("(defmethod mount-crud! ((entity symbol)
                        &key (base \"/api\") (name nil)
                          (order-whitelist '())
                          (auth-guard nil)
                          (host nil)
                        ;; NOUVEAU : Liste des actions autorisées (toutes par défaut)
                          (actions '(:index :show :create :patch :delete)))
  \"Monte des routes CRUD pour ENTITY.
   :actions permet de limiter les routes (ex: '(:index :show)).

EXEMPLES DE CONSTRUCTION D'URL VALIDES (QUERY PARAMS) :

1. Filtrage Simple (Paramètres à la racine)
   Tout paramètre inconnu est traité comme un filtre d'égalité SQL.
   - URL : /api/users?role=admin&is_active=true
   - SQL : WHERE role = 'admin' AND is_active = true

2. Filtrage Explicite (Namespace 'q[...]')
   Méthode robuste (recommandée) pour éviter les collisions avec les clés système.
   - URL : /api/users?q[unit_id]=123&q[lastname]=Doe
   - SQL : WHERE unit_id = '123' AND lastname = 'Doe'

3. Pagination
   Gère le découpage des résultats.
   - URL : /api/users?page=2&page_size=20
   - Note : Le paramètre 'limit' est un alias accepté pour 'page_size'.

4. Tri (Sorting)
   Format attendu : 'colonne' (ascendant par défaut) ou 'colonne:desc'.
   - URL : /api/users?order=created_at:desc
   - URL : /api/users?order=lastname:asc

5. Sélection de Colonnes (Projection)
   Permet de ne récupérer que certains champs pour alléger le JSON.
   - URL : /api/users?select=id,firstname,lastname,email

6. Recherche Textuelle Globale
   Le paramètre 'q' utilisé sans crochets déclenche une recherche (ILIKE ou FTS).
   - URL : /api/documents?q=rapport
   - SQL : (col1 ILIKE '%rapport%' OR col2 ILIKE '%rapport%')

7. Combinaison Complexe
   Tous les paramètres peuvent être combinés.
   - URL : /api/documents?target_type=folder&q=fip&page=1&order=created_at:desc
   - Action : Récupère les documents de type 'folder' contenant le mot 'fip',
              affiche la 1ère page, triée par date de création décroissante.

ARGUMENTS :
  :actions - Liste des opérations à monter (ex: '(:index :show)).
  :base    - Préfixe de l'URL (défaut: \\\"/api\\\").
  :name    - Nom de la ressource dans l'URL (défaut: table de l'entité).
  :host    - Virtual host optionnel (string ou liste).
  :auth-guard - Fonction (lambda (req &key op)) retournant T ou une réponse HTTP.\"
  (let* ((md (lumen.data.dao:entity-metadata entity))
         (seg (or name (getf md :table)))
         (base-list (format nil \"~a/~a\" base seg))
         (base-item (format nil \"~a/~a/:id\" base seg)))
    
    (labels
        ((ctx-from-req* (req) (lumen.core.http:ctx-from-req req))

         (guard! (req op)
           (when auth-guard
             (let ((gret (funcall auth-guard req :op op)))
               (unless (eq gret t)
                 (return-from guard! gret)))))

         (route-spec (path)
           (cond
             ((null host) path)
             ((stringp host) (list :host host :path path))
             ((listp host)   (list :hosts host :path path))
             (t path))))

      ;; INDEX
      ;; GET (:host ... :path /api/<seg>)
      (when (member :index actions)
	(lumen.core.router:defroute GET (route-spec base-list) (req)
          (guard! req :index)
          (let* ((ctx (ctx-from-req* req))
                 (qp  (lumen.core.http:req-query req)) ;; qp est une alist: ((\"key\" . \"val\") ...)
                
                 ;; --- CORRECTION FILTRAGE ---
                 ;; 1. Définir les clés réservées au moteur CRUD
                 (reserved-keys '(\"q\" \"select\" \"order\" \"key\" \"after\" \"before\" \"page\" \"page_size\" \"limit\"))
                
                 ;; 2. Filtres explicites (si on utilise ?q=...)
                 (filters-q (or (lumen.utils:alist-get qp :q) '()))
                
                 ;; 3. Filtres implicites (tout paramètre racine qui n'est PAS réservé)
                 ;; Ex: ?target_id=... devient un filtre
                 (filters-root (remove-if (lambda (pair) 
                                            (member (car pair) reserved-keys :test #'string-equal)) 
                                          qp))
                
                 ;; 4. Fusion des deux
                 (filters (append filters-q filters-root))
                 ;; ---------------------------

                 (select   (%parse-select (lumen.utils:alist-get qp :select)))
                 (order    (or (%ensure-order-whitelist
				(%parse-order (lumen.utils:alist-get qp :order))
				(or order-whitelist
                                    (mapcar (lambda (f) (getf f :col))
                                            (lumen.data.dao:entity-fields entity))))
                               (%derive-default-order entity)))
                 (key      (%parse-key (lumen.utils:alist-get qp :key)))
                 (after    (%parse-after/before (lumen.utils:alist-get qp :after)))
                 (before   (%parse-after/before (lumen.utils:alist-get qp :before)))
                 (page     (%maybe-number (lumen.utils:alist-get qp :page)))
                 (psize    (%maybe-number (lumen.utils:alist-get qp :page_size)))
                 (limit    (%maybe-number (lumen.utils:alist-get qp :limit))))
           
            ;; Debug log pour vérifier que les filtres sont bien pris
            (format t \"~&[DEBUG] Index filters: ~S~%\" filters)
           
            (lumen.core.http:respond-json
             (lumen.data.repo.core:repo-index entity ctx
                                              :filters filters 
                                              :order order :select select
                                              :page page :page-size psize :limit limit
                                              :after after :before before :key key)))))

      ;; SHOW
      (when (member :show actions)
        (lumen.core.router:defroute GET (route-spec base-item) (req)
          (guard! req :show)
          (lumen.core.router:with-params (req id)
            (let* ((ctx (ctx-from-req* req))
                   (row (lumen.data.repo.core:repo-show entity ctx id)))
              (if row
                  (lumen.core.http:respond-json row)
                  (lumen.core.http:respond-404))))))

      ;; CREATE
      (when (member :create actions)
        (lumen.core.router:defroute POST (route-spec base-list) (req)
          (guard! req :create)
          (let* ((ctx (ctx-from-req* req))
                 (payload (lumen.core.http:ctx-get req :json))
                 (res (lumen.data.repo.core:repo-create entity ctx payload)))
            (lumen.core.http:respond-json res :status 201))))

      ;; PATCH
      (when (member :patch actions)
        (lumen.core.router:defroute PATCH (route-spec base-item) (req)
          (guard! req :patch)
          (lumen.core.router:with-params (req id)
            (let* ((ctx (ctx-from-req* req))
                   (payload (lumen.core.http:ctx-get req :json))
                   (res (lumen.data.repo.core:repo-patch entity ctx id payload)))
              (lumen.core.http:respond-json res)))))

      ;; DELETE
      (when (member :delete actions)
        (lumen.core.router:defroute DELETE (route-spec base-item) (req)
          (guard! req :delete)
          (lumen.core.router:with-params (req id)
            (let* ((ctx (ctx-from-req* req))
                   (res (lumen.data.repo.core:repo-delete entity ctx id)))
              (lumen.core.http:respond-json res)))))

      ;; Retourne les patterns
      (list base-list base-item))))" 0 1334 (face font-lock-comment-face fontified t) 1334 1370 (face font-lock-comment-face fontified t) 1370 7524 (face font-lock-comment-face fontified t)) . -9151) (undo-tree-id5 . -6681) (undo-tree-id6 . -7524) 16675 (t 26996 65218 0 0)) nil (26997 1305 45534 0) 0 nil])
([nil nil ((#("#|

|#" 0 2 (face font-lock-comment-delimiter-face fontified t) 2 3 (face font-lock-comment-face fontified t) 3 4 (face font-lock-comment-face fontified t) 4 6 (face font-lock-comment-delimiter-face fontified t)) . 9148) (undo-tree-id4 . -6)) nil (26997 1305 45531 0) 0 nil])
([nil nil ((#("
" 0 1 (fontified t)) . 9148) (#("
" 0 1 (fontified t)) . 9148)) nil (26997 1305 45529 0) 0 nil])
([nil nil ((#("(defun %jwt-required-or-response (req)
  \"Retourne T si OK, sinon un objet réponse (401/403) du mw.\"
  (let* ((mw   (lumen.core.middleware:auth-middleware :required-p t))
         (next (lambda (_req) :ok))
         (out  (funcall (funcall mw next) req)))
    (if (eql out :ok) t out)))

(defun make-jwt-guard (&key (required-p nil) roles scopes scopes-mode
                            (allow-query-token-p t) (qs-keys '(\"access\" \"token\")))
  \"Fabrique un guard (req) ⇒ T|response basé sur auth-middleware.\"
  (let ((mw (lumen.core.middleware:auth-middleware
             :required-p t
             :roles-allow roles
             :scopes-allow scopes
             :scopes-mode (or scopes-mode :any)
             :allow-query-token-p allow-query-token-p
             :qs-keys qs-keys)))
    (lambda (req)
      (let* ((next (lambda (_req) :ok))
             (out  (funcall (funcall mw next) req)))
        (if (eql out :ok) t out)))))

(defun make-entity-crud-guard (entity &key (required-p nil))
  \"Retourne un guard (req &key op) ⇒ T|response. Si :op est absent, on exige juste un JWT valide.\"
  (lambda (req &key op &allow-other-keys)
    (cond
      ((null op) (%jwt-required-or-response req))
      (t
       (let* ((scopes (%crud-scope-for entity op))
              (mw (lumen.core.middleware:auth-middleware
                   :required-p required-p :scopes-allow scopes :scopes-mode :any)))
         (let* ((next (lambda (_req) :ok))
                (out  (funcall (funcall mw next) req)))
           (if (eql out :ok) t out)))))))" 0 1 (fontified t) 1 6 (face font-lock-keyword-face fontified t) 6 7 (fontified t) 7 32 (face font-lock-function-name-face fontified t) 32 41 (fontified t) 41 100 (face font-lock-doc-face fontified t) 100 104 (fontified t) 104 108 (face font-lock-keyword-face fontified t) 108 132 (fontified t) 132 155 (fontified t) 155 166 (face font-lock-builtin-face fontified t) 166 187 (fontified t) 187 193 (face font-lock-keyword-face fontified t) 193 201 (fontified t) 201 204 (face font-lock-builtin-face fontified t) 204 261 (fontified t) 261 263 (face font-lock-keyword-face fontified t) 263 273 (fontified t) 273 276 (face font-lock-builtin-face fontified t) 276 289 (fontified t) 289 294 (face font-lock-keyword-face fontified t) 294 295 (fontified t) 295 309 (face font-lock-function-name-face fontified t) 309 311 (fontified t) 311 315 (face font-lock-type-face fontified t) 315 421 (fontified t) 421 429 (face font-lock-string-face fontified t) 429 430 (fontified t) 430 437 (face font-lock-string-face fontified t) 437 443 (fontified t) 443 507 (face font-lock-doc-face fontified t) 507 511 (fontified t) 511 514 (face font-lock-keyword-face fontified t) 514 572 (fontified t) 572 583 (face font-lock-builtin-face fontified t) 583 599 (fontified t) 599 611 (face font-lock-builtin-face fontified t) 611 631 (fontified t) 631 644 (face font-lock-builtin-face fontified t) 644 665 (fontified t) 665 677 (face font-lock-builtin-face fontified t) 677 694 (fontified t) 694 698 (face font-lock-builtin-face fontified t) 698 713 (fontified t) 713 733 (face font-lock-builtin-face fontified t) 733 767 (fontified t) 767 775 (face font-lock-builtin-face fontified t) 775 792 (fontified t) 792 798 (face font-lock-keyword-face fontified t) 798 812 (fontified t) 812 816 (face font-lock-keyword-face fontified t) 816 825 (fontified t) 825 831 (face font-lock-keyword-face fontified t) 831 839 (fontified t) 839 842 (face font-lock-builtin-face fontified t) 842 907 (fontified t) 907 909 (face font-lock-keyword-face fontified t) 909 919 (fontified t) 919 922 (face font-lock-builtin-face fontified t) 922 937 (fontified t) 937 942 (face font-lock-keyword-face fontified t) 942 943 (fontified t) 943 965 (face font-lock-function-name-face fontified t) 965 974 (fontified t) 974 978 (face font-lock-type-face fontified t) 978 999 (fontified t) 999 1095 (face font-lock-doc-face fontified t) 1095 1099 (fontified t) 1099 1105 (face font-lock-keyword-face fontified t) 1105 1111 (fontified t) 1111 1115 (face font-lock-type-face fontified t) 1115 1119 (fontified t) 1119 1136 (face font-lock-type-face fontified t) 1136 1143 (fontified t) 1143 1147 (face font-lock-keyword-face fontified t) 1147 1215 (fontified t) 1215 1219 (face font-lock-keyword-face fontified t) 1219 1334 (fontified t) 1334 1345 (face font-lock-builtin-face fontified t) 1345 1357 (fontified t) 1357 1370 (face font-lock-builtin-face fontified t) 1370 1378 (fontified t) 1378 1390 (face font-lock-builtin-face fontified t) 1390 1391 (fontified t) 1391 1395 (face font-lock-builtin-face fontified t) 1395 1409 (fontified t) 1409 1413 (face font-lock-keyword-face fontified t) 1413 1422 (fontified t) 1422 1428 (face font-lock-keyword-face fontified t) 1428 1436 (fontified t) 1436 1439 (face font-lock-builtin-face fontified t) 1439 1510 (fontified t) 1510 1512 (face font-lock-keyword-face fontified t) 1512 1522 (fontified t) 1522 1525 (face font-lock-builtin-face fontified t) 1525 1539 (fontified t)) . 7346) (undo-tree-id0 . -1539) (undo-tree-id1 . -155) (undo-tree-id2 . -155) (undo-tree-id3 . -155)) nil (26997 1305 45528 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 10838 . 10839) (nil fontified nil 7346 . 10839) (7346 . 10839)) nil (26997 1305 45511 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 6874 . 6875) (nil fontified nil 6837 . 6875) (6837 . 6875) (t 26997 1305 0 0)) nil (26998 12791 67721 0) 0 nil])
([nil nil ((6875 . 6881)) nil (26998 12791 67720 0) 0 nil])
([nil nil ((#("
                   (string-downcase (symbol-name entity))" 0 1 (fontified t) 1 58 (fontified t)) . 6897) (undo-tree-id3 . -58)) nil (26998 12791 67769 0) 0 nil])
([nil nil ((#("~a" 0 2 (face font-lock-string-face fontified t)) . 7106) (undo-tree-id43 . -2) (undo-tree-id44 . -2) (undo-tree-id45 . -2) (undo-tree-id46 . -2) 7108) nil (26998 12821 803924 0) 0 nil] [nil nil ((#("))
         (tbl  (string-downcase (etypecase seg
                                  (string seg)
                                  (symbol (symbol-name seg))))))
    (ecase op
      (:index (list (format nil \"~a" 0 3 (fontified t) 3 36 (fontified t) 36 45 (face font-lock-keyword-face fontified t) 45 167 (fontified t) 167 172 (face font-lock-keyword-face fontified t) 172 183 (fontified t) 183 189 (face font-lock-builtin-face fontified t) 189 208 (fontified t) 208 211 (face font-lock-string-face fontified t)) . 6897) (undo-tree-id0 . -211) (undo-tree-id1 . -209) (undo-tree-id2 . -209) 7108) ((6897 . 7108)) (26998 12791 67715 0) 0 nil])
([nil nil ((#(":" 0 1 (face font-lock-string-face fontified t)) . 7106)) nil (26998 12821 803916 0) 0 nil])
nil
([nil nil ((7110 . 7111)) nil (26998 12821 803915 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 7112 . 7113) (nil fontified nil 7111 . 7113) (7111 . 7113)) nil (26998 12821 803915 0) 0 nil])
([nil nil ((#("~a:" 0 3 (face font-lock-string-face fontified t)) . -7157) (undo-tree-id40 . -3) (undo-tree-id41 . -3) (undo-tree-id42 . -3) 7160) nil (26998 12821 803913 0) 0 nil])
([nil nil ((nil fontified nil 7163 . 7164) (nil fontified nil 7162 . 7163) (nil fontified nil 7161 . 7162) (7161 . 7164)) nil (26998 12821 803911 0) 0 nil])
([nil nil ((#("~a:" 0 3 (face font-lock-string-face fontified t)) . -7208) (undo-tree-id37 . -3) (undo-tree-id38 . -3) (undo-tree-id39 . -3) 7211) nil (26998 12821 803910 0) 0 nil])
([nil nil ((nil fontified nil 7215 . 7216) (nil fontified nil 7214 . 7215) (nil fontified nil 7213 . 7214) (7213 . 7216)) nil (26998 12821 803907 0) 0 nil])
([nil nil ((#("a" 0 1 (face font-lock-string-face fontified t)) . 7259) (#("~" 0 1 (face font-lock-string-face fontified t)) . 7259) (undo-tree-id32 . -1) (undo-tree-id33 . -1) (undo-tree-id34 . -1) (undo-tree-id35 . -1) (undo-tree-id36 . -1)) nil (26998 12821 803906 0) 0 nil])
([nil nil ((nil fontified nil 7267 . 7268) (nil fontified nil 7266 . 7267) (nil fontified nil 7265 . 7266) (7265 . 7268)) nil (26998 12821 803902 0) 0 nil])
([nil nil ((#(":" 0 1 (face font-lock-string-face fontified t)) . -7259) (undo-tree-id25 . -1) (undo-tree-id26 . -1) (undo-tree-id27 . -1) (undo-tree-id28 . -1) (undo-tree-id29 . -1) (undo-tree-id30 . -1) (undo-tree-id31 . -1) 7260) nil (26998 12821 803901 0) 0 nil])
([nil nil ((#("~" 0 1 (face font-lock-string-face fontified t)) . -7310) (undo-tree-id4 . -1) (undo-tree-id5 . -1) (undo-tree-id6 . -1) (undo-tree-id7 . -1) (undo-tree-id8 . -1) (undo-tree-id9 . -1) (undo-tree-id10 . -1) (#("a" 0 1 (face font-lock-string-face fontified t)) . -7311) (undo-tree-id11 . -1) (undo-tree-id12 . -1) (undo-tree-id13 . -1) (undo-tree-id14 . -1) (undo-tree-id15 . -1) (undo-tree-id16 . -1) (undo-tree-id17 . -1) (#(":" 0 1 (face font-lock-string-face fontified t)) . -7312) (undo-tree-id18 . -1) (undo-tree-id19 . -1) (undo-tree-id20 . -1) (undo-tree-id21 . -1) (undo-tree-id22 . -1) (undo-tree-id23 . -1) (undo-tree-id24 . -1) 7313) nil (26998 12821 803891 0) 0 nil])
([nil nil ((nil fontified nil 7318 . 7319) (nil fontified nil 7317 . 7318) (nil fontified nil 7316 . 7317) (7316 . 7319)) nil (26998 12821 803866 0) 0 nil])
([nil nil ((7291 . 7293) (t 26998 12821 0 0)) nil (26998 12831 477215 0) 0 nil])
([nil nil ((7240 . 7242)) nil (26998 12831 477214 0) 0 nil])
([nil nil ((7189 . 7191)) nil (26998 12831 477214 0) 0 nil])
([nil nil ((7138 . 7140)) nil (26998 12831 477213 0) 0 nil])
([nil nil ((7087 . 7089)) nil (26998 12831 477209 0) 0 nil])
([nil nil ((#("list" 0 4 (fontified t)) . -10419) (undo-tree-id77 . -4) (undo-tree-id78 . -1) (undo-tree-id79 . -1) (undo-tree-id80 . -1) (undo-tree-id81 . -1) (undo-tree-id82 . -1) (undo-tree-id83 . -4) (undo-tree-id84 . -4) (undo-tree-id85 . -4) (undo-tree-id86 . -4) (undo-tree-id87 . -4) (undo-tree-id88 . -4) (undo-tree-id89 . -4) (undo-tree-id90 . -4) 10423 (t 26998 12831 0 0)) nil (26998 13137 340737 0) 0 nil])
([nil nil ((#("(" 0 1 (fontified t)) . -10418) (undo-tree-id56 . -1) (undo-tree-id57 . -1) (undo-tree-id58 . -1) (undo-tree-id59 . -1) (undo-tree-id60 . -1) (undo-tree-id61 . -1) (undo-tree-id62 . -1) (undo-tree-id63 . -1) (undo-tree-id64 . -1) (undo-tree-id65 . -1) (undo-tree-id66 . -1) (undo-tree-id67 . -1) (undo-tree-id68 . -1) (undo-tree-id69 . -1) (undo-tree-id70 . -1) (undo-tree-id71 . -1) (undo-tree-id72 . -1) (undo-tree-id73 . -1) (undo-tree-id74 . -1) (undo-tree-id75 . -1) (undo-tree-id76 . -1) 10419) nil (26998 13137 340729 0) 0 nil])
([nil nil ((#(" " 0 1 (fontified t)) . -10448) (undo-tree-id54 . -1) (undo-tree-id55 . -1) 10449) nil (26998 13137 340715 0) 0 nil])
([nil nil ((#(" " 0 1 (fontified t)) . -10418) (undo-tree-id47 . -1) (undo-tree-id48 . -1) (undo-tree-id49 . -1) (undo-tree-id50 . -1) (undo-tree-id51 . -1) (undo-tree-id52 . -1) (undo-tree-id53 . -1) 10419) nil (26998 13137 340710 0) 0 nil])
([nil current ((#(")" 0 1 (fontified t)) . -10446) (undo-tree-id91 . -1) (undo-tree-id92 . -1) (undo-tree-id93 . -1) (undo-tree-id94 . -1) (undo-tree-id95 . -1) (undo-tree-id96 . -1) (undo-tree-id97 . -1) (undo-tree-id98 . -1) 10447 (t 26998 13137 0 0)) nil (26998 13147 470713 0) 0 nil])
nil
