(undo-tree-save-format-version . 1)
"82b7fded72b62d7f8503f8e1378675de3eb55067"
[nil nil nil nil (26797 27884 86207 0) 0 nil]
([nil nil ((nil rear-nonsticky nil 2552 . 2553) (nil fontified nil 1 . 2553) (1 . 2553) (t . -1)) nil (26797 27884 86206 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 1047 . 1048) (nil fontified nil 1047 . 1048) (nil fontified nil 1025 . 1047) (nil fontified nil 1024 . 1025) (nil fontified nil 1014 . 1024) (nil fontified nil 1012 . 1014) (nil fontified nil 1009 . 1012) (nil fontified nil 1004 . 1009) (nil fontified nil 1000 . 1004) (nil fontified nil 999 . 1000) (nil fontified nil 991 . 999) (nil fontified nil 987 . 991) (nil fontified nil 979 . 987) (nil fontified nil 976 . 979) (nil fontified nil 973 . 976) (nil fontified nil 972 . 973) (nil fontified nil 971 . 972) (nil fontified nil 947 . 971) (nil fontified nil 946 . 947) (nil fontified nil 943 . 946) (nil fontified nil 942 . 943) (nil fontified nil 930 . 942) (nil fontified nil 927 . 930) (nil fontified nil 915 . 927) (nil fontified nil 912 . 915) (nil fontified nil 909 . 912) (nil fontified nil 908 . 909) (nil fontified nil 907 . 908) (nil fontified nil 904 . 907) (nil fontified nil 903 . 904) (nil fontified nil 900 . 903) (nil fontified nil 895 . 900) (nil fontified nil 892 . 895) (nil fontified nil 889 . 892) (nil fontified nil 888 . 889) (nil fontified nil 873 . 888) (nil fontified nil 872 . 873) (nil fontified nil 865 . 872) (nil fontified nil 864 . 865) (nil fontified nil 852 . 864) (nil fontified nil 851 . 852) (nil fontified nil 840 . 851) (nil fontified nil 837 . 840) (nil fontified nil 829 . 837) (nil fontified nil 826 . 829) (nil fontified nil 823 . 826) (nil fontified nil 822 . 823) (nil fontified nil 808 . 822) (nil fontified nil 807 . 808) (nil fontified nil 791 . 807) (nil fontified nil 788 . 791) (nil fontified nil 772 . 788) (nil fontified nil 769 . 772) (nil fontified nil 764 . 769) (nil fontified nil 752 . 764) (nil fontified nil 751 . 752) (nil fontified nil 746 . 751) (nil fontified nil 745 . 746) (nil fontified nil 738 . 745) (nil fontified nil 737 . 738) (nil fontified nil 732 . 737) (nil fontified nil 731 . 732) (nil fontified nil 725 . 731) (nil fontified nil 720 . 725) (nil fontified nil 699 . 720) (nil fontified nil 698 . 699) (nil fontified nil 689 . 698) (nil fontified nil 688 . 689) (nil fontified nil 680 . 688) (nil fontified nil 679 . 680) (nil fontified nil 651 . 679) (nil fontified nil 646 . 651) (nil fontified nil 633 . 646) (nil fontified nil 632 . 633) (nil fontified nil 622 . 632) (nil fontified nil 621 . 622) (nil fontified nil 614 . 621) (nil fontified nil 613 . 614) (nil fontified nil 607 . 613) (nil fontified nil 606 . 607) (nil fontified nil 595 . 606) (nil fontified nil 594 . 595) (nil fontified nil 576 . 594) (nil fontified nil 575 . 576) (nil fontified nil 568 . 575) (nil fontified nil 565 . 568) (nil fontified nil 564 . 565) (nil fontified nil 563 . 564) (nil fontified nil 562 . 563) (nil fontified nil 553 . 562) (nil fontified nil 552 . 553) (nil fontified nil 551 . 552) (nil fontified nil 550 . 551) (nil fontified nil 541 . 550) (nil fontified nil 540 . 541) (nil fontified nil 539 . 540) (nil fontified nil 529 . 539) (nil fontified nil 528 . 529) (nil fontified nil 527 . 528) (nil fontified nil 517 . 527) (nil fontified nil 516 . 517) (nil fontified nil 515 . 516) (nil fontified nil 508 . 515) (nil fontified nil 507 . 508) (nil fontified nil 506 . 507) (nil fontified nil 505 . 506) (nil fontified nil 489 . 505) (nil fontified nil 476 . 489) (nil fontified nil 475 . 476) (nil fontified nil 474 . 475) (nil fontified nil 462 . 474) (nil fontified nil 461 . 462) (nil fontified nil 460 . 461) (nil fontified nil 448 . 460) (nil fontified nil 447 . 448) (nil fontified nil 435 . 447) (nil fontified nil 434 . 435) (nil fontified nil 433 . 434) (nil fontified nil 426 . 433) (nil fontified nil 422 . 426) (nil fontified nil 421 . 422) (nil fontified nil 402 . 421) (nil fontified nil 401 . 402) (nil fontified nil 389 . 401) (nil fontified nil 388 . 389) (nil fontified nil 386 . 388) (nil fontified nil 384 . 386) (nil fontified nil 367 . 384) (nil fontified nil 366 . 367) (nil fontified nil 350 . 366) (nil fontified nil 349 . 350) (nil fontified nil 337 . 349) (nil fontified nil 334 . 337) (nil fontified nil 332 . 334) (nil fontified nil 316 . 332) (nil fontified nil 315 . 316) (nil fontified nil 312 . 315) (nil fontified nil 311 . 312) (nil fontified nil 297 . 311) (nil fontified nil 296 . 297) (nil fontified nil 295 . 296) (nil fontified nil 281 . 295) (nil fontified nil 280 . 281) (nil fontified nil 267 . 280) (nil fontified nil 266 . 267) (nil fontified nil 262 . 266) (nil fontified nil 261 . 262) (nil fontified nil 258 . 261) (nil fontified nil 257 . 258) (nil fontified nil 245 . 257) (nil fontified nil 244 . 245) (nil fontified nil 232 . 244) (nil fontified nil 229 . 232) (nil fontified nil 227 . 229) (nil fontified nil 218 . 227) (nil fontified nil 217 . 218) (nil fontified nil 209 . 217) (nil fontified nil 208 . 209) (nil fontified nil 198 . 208) (nil fontified nil 197 . 198) (nil fontified nil 185 . 197) (nil fontified nil 184 . 185) (nil fontified nil 172 . 184) (nil fontified nil 171 . 172) (nil fontified nil 170 . 171) (nil fontified nil 159 . 170) (nil fontified nil 158 . 159) (nil fontified nil 155 . 158) (nil fontified nil 154 . 155) (nil fontified nil 142 . 154) (nil fontified nil 141 . 142) (nil fontified nil 132 . 141) (nil fontified nil 131 . 132) (nil fontified nil 130 . 131) (nil fontified nil 121 . 130) (nil fontified nil 120 . 121) (nil fontified nil 112 . 120) (nil fontified nil 111 . 112) (nil fontified nil 95 . 111) (nil fontified nil 94 . 95) (nil fontified nil 82 . 94) (nil fontified nil 79 . 82) (nil fontified nil 77 . 79) (nil fontified nil 66 . 77) (nil fontified nil 65 . 66) (nil fontified nil 62 . 65) (nil fontified nil 61 . 62) (nil fontified nil 57 . 61) (nil fontified nil 53 . 57) (nil fontified nil 31 . 53) (nil fontified nil 30 . 31) (nil fontified nil 20 . 30) (nil fontified nil 19 . 20) (nil fontified nil 16 . 19) (nil fontified nil 13 . 16) (nil fontified nil 12 . 13) (nil fontified nil 2 . 12) (nil fontified nil 1 . 2) (1 . 1048)) nil (26797 27884 86202 0) 0 nil])
([nil nil ((1048 . 1049)) nil (26797 27884 86188 0) 0 nil])
([nil nil ((#("
(in-package :lumen.core.middleware)" 0 1 (fontified t) 1 2 (fontified t) 2 12 (face font-lock-keyword-face fontified t) 12 13 (fontified t) 13 35 (face font-lock-builtin-face fontified t) 35 36 (rear-nonsticky t fontified t)) . 1012) (undo-tree-id6 . -36)) nil (26797 27884 86188 0) 0 nil])
([nil nil ((#("middleware" 0 10 (face font-lock-type-face fontified t)) . -43) (undo-tree-id5 . -10) 53) nil (26797 27884 86185 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 45 . 46) (nil fontified nil 43 . 46) (43 . 46)) nil (26797 27884 86184 0) 0 nil])
([nil nil ((#(":define-middleware :my-compose :*app* :logger :json-only :query-parser
	   :parse-query-string-to-alist :*debug* :set-app! :*pipeline-signature*
	   :named :->mw :static :cors :static-many
	   ;; Erreur Handlers
   :*error-handler* :error-wrapper
   ;; Cookies
   :request-id :set-cookie! :cookie :cookies-parser
   ;; ETag
   :etag
   ;; Compression
   :compression
   :last-modified-conditional
   ;; Session
	   :session
	   :csrf" 0 18 (face font-lock-builtin-face fontified t) 18 19 (fontified t) 19 30 (face font-lock-builtin-face fontified t) 30 31 (fontified t) 31 37 (face font-lock-builtin-face fontified t) 37 38 (fontified t) 38 45 (face font-lock-builtin-face fontified t) 45 46 (fontified t) 46 56 (face font-lock-builtin-face fontified t) 56 57 (fontified t) 57 70 (face font-lock-builtin-face fontified t) 70 75 (fontified t) 75 103 (face font-lock-builtin-face fontified t) 103 104 (fontified t) 104 112 (face font-lock-builtin-face fontified t) 112 113 (fontified t) 113 122 (face font-lock-builtin-face fontified t) 122 123 (fontified t) 123 144 (face font-lock-builtin-face fontified t) 144 149 (fontified t) 149 155 (face font-lock-builtin-face fontified t) 155 156 (fontified t) 156 161 (face font-lock-builtin-face fontified t) 161 162 (fontified t) 162 169 (face font-lock-builtin-face fontified t) 169 170 (fontified t) 170 175 (face font-lock-builtin-face fontified t) 175 176 (fontified t) 176 188 (face font-lock-builtin-face fontified t) 188 193 (fontified t) 193 196 (face font-lock-comment-delimiter-face fontified t) 196 212 (face font-lock-comment-face fontified t) 212 215 (fontified t) 215 231 (face font-lock-builtin-face fontified t) 231 232 (fontified t) 232 246 (face font-lock-builtin-face fontified t) 246 247 (fontified t) 247 250 (fontified t) 250 253 (face font-lock-comment-delimiter-face fontified t) 253 261 (face font-lock-comment-face fontified t) 261 264 (fontified t) 264 275 (face font-lock-builtin-face fontified t) 275 276 (fontified t) 276 288 (face font-lock-builtin-face fontified t) 288 289 (fontified t) 289 296 (face font-lock-builtin-face fontified t) 296 297 (fontified t) 297 312 (face font-lock-builtin-face fontified t) 312 313 (fontified t) 313 316 (fontified t) 316 319 (face font-lock-comment-delimiter-face fontified t) 319 324 (face font-lock-comment-face fontified t) 324 327 (fontified t) 327 328 (face font-lock-builtin-face fontified t) 328 331 (face font-lock-builtin-face fontified t) 331 332 (face font-lock-builtin-face fontified t rear-nonsticky t) 332 333 (fontified t) 333 336 (fontified t) 336 339 (face font-lock-comment-delimiter-face fontified t) 339 351 (face font-lock-comment-face fontified t) 351 354 (fontified t) 354 366 (face font-lock-builtin-face fontified t) 366 367 (fontified t) 367 370 (fontified t) 370 371 (face font-lock-builtin-face fontified t) 371 395 (face font-lock-builtin-face fontified t) 395 396 (face font-lock-builtin-face fontified t rear-nonsticky t) 396 397 (fontified t) 397 400 (fontified t) 400 403 (face font-lock-comment-delimiter-face fontified t) 403 411 (face font-lock-comment-face fontified t) 411 415 (fontified t) 415 423 (face font-lock-builtin-face fontified t) 423 424 (fontified t) 424 428 (fontified t) 428 433 (face font-lock-builtin-face fontified t)) . 569) (undo-tree-id4 . -433)) nil (26797 27884 86184 0) 0 nil])
([nil nil ((569 . 573)) nil (26797 27884 86183 0) 0 nil])
([nil nil ((569 . 579) (#("jwt-" 0 4 (fontified t)) . -569) (undo-tree-id3 . -4) 573) nil (26797 27884 86182 0) 0 nil])
([nil nil ((579 . 580)) nil (26797 27884 86181 0) 0 nil])
([nil nil ((580 . 585)) nil (26797 27884 86181 0) 0 nil])
([nil nil ((580 . 590) (#("jwt-e" 0 5 (fontified t)) . -580) (undo-tree-id2 . -5) 585) nil (26797 27884 86180 0) 0 nil])
([nil nil ((580 . 581)) nil (26797 27884 86178 0) 0 nil])
([nil nil ((569 . 570)) nil (26797 27884 86178 0) 0 nil])
([nil nil ((#("
  (:import-from :lumen.core.body :parse-urlencoded)
  (:import-from :lumen.core.session :session-id :session-data :session-get :session-set! :session-del!:verify-signed-sid :sign-sid :store-get :store-put! :store-del! :rand-bytes)" 0 1 (fontified t) 1 4 (fontified t) 4 16 (face font-lock-builtin-face fontified t) 16 17 (fontified t) 17 33 (face font-lock-builtin-face fontified t) 33 34 (fontified t) 34 51 (face font-lock-builtin-face fontified t) 51 53 (fontified t) 53 55 (fontified t) 55 56 (fontified t) 56 68 (face font-lock-builtin-face fontified t) 68 69 (fontified t) 69 88 (face font-lock-builtin-face fontified t) 88 89 (fontified t) 89 93 (face font-lock-builtin-face fontified t) 93 100 (face font-lock-builtin-face fontified t) 100 101 (fontified t) 101 102 (face font-lock-builtin-face fontified t) 102 114 (face font-lock-builtin-face fontified t) 114 115 (fontified t) 115 127 (face font-lock-builtin-face fontified t) 127 128 (fontified t) 128 129 (face font-lock-builtin-face fontified t) 129 141 (face font-lock-builtin-face fontified t) 141 142 (fontified t) 142 143 (face font-lock-builtin-face fontified t) 143 156 (face font-lock-builtin-face fontified t) 156 172 (face font-lock-builtin-face fontified t) 172 173 (face font-lock-builtin-face fontified t rear-nonsticky t) 173 174 (fontified t) 174 175 (face font-lock-builtin-face fontified t) 175 182 (face font-lock-builtin-face fontified t) 182 183 (face font-lock-builtin-face fontified t rear-nonsticky t) 183 184 (fontified t) 184 194 (face font-lock-builtin-face fontified t) 194 195 (fontified t) 195 196 (face font-lock-builtin-face fontified t) 196 206 (face font-lock-builtin-face fontified t) 206 207 (fontified t) 207 208 (face font-lock-builtin-face fontified t) 208 217 (face font-lock-builtin-face fontified t) 217 218 (face font-lock-builtin-face fontified t rear-nonsticky t) 218 219 (fontified t) 219 220 (face font-lock-builtin-face fontified t) 220 229 (face font-lock-builtin-face fontified t) 229 230 (face font-lock-builtin-face fontified t rear-nonsticky t) 230 231 (fontified t rear-nonsticky t)) . 326) (undo-tree-id1 . -231)) nil (26797 27884 86177 0) 0 nil])
([nil nil ((#("
  (:import-from :lumen.core.http :request :response :resp-body :resp-status
   :resp-headers :respond-500 :respond-404 :req-query :ctx-get :ctx-set!)" 0 1 (fontified t) 1 4 (fontified t) 4 16 (face font-lock-builtin-face fontified t) 16 17 (fontified t) 17 33 (face font-lock-builtin-face fontified t) 33 34 (fontified t) 34 42 (face font-lock-builtin-face fontified t) 42 43 (fontified t) 43 52 (face font-lock-builtin-face fontified t) 52 53 (fontified t) 53 54 (face font-lock-builtin-face fontified t) 54 63 (face font-lock-builtin-face fontified t) 63 64 (fontified t) 64 76 (face font-lock-builtin-face fontified t) 76 77 (fontified t) 77 80 (fontified t) 80 81 (face font-lock-builtin-face fontified t) 81 92 (face font-lock-builtin-face fontified t) 92 93 (face font-lock-builtin-face fontified t rear-nonsticky t) 93 94 (fontified t) 94 106 (face font-lock-builtin-face fontified t) 106 107 (fontified t) 107 119 (face font-lock-builtin-face fontified t) 119 120 (fontified t) 120 130 (face font-lock-builtin-face fontified t) 130 131 (fontified t) 131 139 (face font-lock-builtin-face fontified t) 139 140 (fontified t) 140 149 (face font-lock-builtin-face fontified t) 149 150 (fontified t)) . 71) (undo-tree-id0 . -150)) nil (26797 27884 86172 0) 0 nil])
([nil nil ((747 . 748) (t 26797 27884 0 0)) nil (26797 28801 125676 0) 0 nil])
([nil nil ((175 . 176)) nil (26797 28801 125676 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 187 . 188) (nil fontified nil 176 . 188) (176 . 188)) nil (26797 28801 125675 0) 0 nil])
([nil nil ((#("

(defun hmac-sha256 (key u8)
  (ironclad:hmac-digest (ironclad:make-hmac key :sha256) u8))" 0 2 (fontified t) 2 3 (fontified t) 3 8 (face font-lock-keyword-face fontified t) 8 9 (fontified t) 9 20 (face font-lock-function-name-face fontified t) 20 30 (fontified t) 30 52 (fontified t) 52 78 (fontified t) 78 85 (face font-lock-builtin-face fontified t) 85 91 (fontified t)) . 718) (undo-tree-id7 . -91)) nil (26797 28801 125671 0) 0 nil])
([nil nil ((#(" :wrap nil" 0 1 (fontified t) 1 6 (face font-lock-builtin-face fontified t) 6 10 (fontified t)) . -343) (undo-tree-id0 . -10) 353 (t 26797 28801 0 0)) nil (26797 30790 953919 0) 0 nil])
([nil nil ((256 . 258) (t 26797 30790 0 0)) nil (26798 57467 942215 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 406 . 407) (nil fontified nil 258 . 407) (258 . 407)) nil (26798 57467 942214 0) 0 nil])
([nil nil ((907 . 909)) nil (26798 57467 942213 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 2848 . 2849) (nil fontified nil 909 . 2849) (909 . 2849)) nil (26798 57467 942212 0) 0 nil])
([nil nil ((#("

(defun jwt-encode (payload &key (secret \"change-me\") (alg \"HS256\") (extra-headers nil))
  \"Retourne une string JWT. payload = alist or plist convertible en JSON.\"
  (declare (ignore alg))
  (let* ((header (append '((:typ . \"JWT\") (:alg . \"HS256\")) extra-headers))
         (h-b64 (b64url-encode (json-bytes header)))
         (p-b64 (b64url-encode (json-bytes payload)))
         (msg   (trivial-utf-8:string-to-utf-8-bytes (format nil \"~A.~A\" h-b64 p-b64)))
         (sig   (hmac-sha256 (trivial-utf-8:string-to-utf-8-bytes secret) msg))
         (s-b64 (b64url-encode sig)))
    (format nil \"~A.~A.~A\" h-b64 p-b64 s-b64)))

(defun jwt-decode (token &key (secret \"change-me\") (verify t) (leeway 0))
  \"Retourne (values payload header) ou (values NIL NIL) si invalide.\"
  (handler-case
      (multiple-value-bind (h p s)
          (let ((parts (uiop:split-string token :separator \".\")))
            (values (first parts) (second parts) (third parts)))
        (let* ((header (parse-json-bytes (b64url-decode h)))
               (payload (parse-json-bytes (b64url-decode p))))
          (when verify
            (let* ((msg (trivial-utf-8:string-to-utf-8-bytes (format nil \"~A.~A\" h p)))
                   (exp-s (b64url-decode s))
                   (calc  (hmac-sha256 (trivial-utf-8:string-to-utf-8-bytes secret) msg)))
              (unless (equalp exp-s calc) (return-from jwt-decode (values nil nil)))))
          ;; vérifier exp/nbf si présents (en secondes UTC)
          (let ((exp (or (cdr (assoc :exp payload)) (cdr (assoc \"exp\" payload))))
                (nbf (or (cdr (assoc :nbf payload)) (cdr (assoc \"nbf\" payload))))
                (now (now)))
            (when (and exp (> (+ now leeway) exp)) (return-from jwt-decode (values nil nil)))
            (when (and nbf (< (- now leeway) nbf)) (return-from jwt-decode (values nil nil))))
          (values payload header)))
    (error () (values nil nil))))
" 0 1 (fontified t) 1 3 (fontified t) 3 8 (face font-lock-keyword-face fontified t) 8 9 (fontified t) 9 19 (face font-lock-function-name-face fontified t) 19 29 (fontified t) 29 33 (face font-lock-type-face fontified t) 33 42 (fontified t) 42 53 (face font-lock-string-face fontified t) 53 60 (fontified t) 60 67 (face font-lock-string-face fontified t) 67 92 (fontified t) 92 164 (face font-lock-doc-face fontified t) 164 168 (fontified t) 168 175 (face font-lock-keyword-face fontified t) 175 193 (fontified t) 193 197 (face font-lock-keyword-face fontified t) 197 218 (fontified t) 218 222 (face font-lock-builtin-face fontified t) 222 225 (fontified t) 225 230 (face font-lock-string-face fontified t) 230 233 (fontified t) 233 237 (face font-lock-builtin-face fontified t) 237 240 (fontified t) 240 247 (face font-lock-string-face fontified t) 247 438 (fontified t) 438 445 (face font-lock-string-face fontified t) 445 595 (fontified t) 595 605 (face font-lock-string-face fontified t) 605 628 (fontified t) 628 629 (fontified t) 629 634 (face font-lock-keyword-face fontified t) 634 635 (fontified t) 635 645 (face font-lock-function-name-face fontified t) 645 653 (fontified t) 653 657 (face font-lock-type-face fontified t) 657 666 (fontified t) 666 677 (face font-lock-string-face fontified t) 677 704 (fontified t) 704 735 (face font-lock-doc-face fontified t) 735 771 (face font-lock-doc-face fontified t) 771 772 (fontified t) 772 775 (fontified t) 775 787 (face font-lock-keyword-face fontified t) 787 795 (fontified t) 795 814 (face font-lock-keyword-face fontified t) 814 834 (fontified t) 834 837 (face font-lock-keyword-face fontified t) 837 871 (fontified t) 871 881 (face font-lock-builtin-face fontified t) 881 882 (fontified t) 882 885 (face font-lock-string-face fontified t) 885 963 (fontified t) 963 967 (face font-lock-keyword-face fontified t) 967 1001 (fontified t) 1001 1015 (fontified t) 1015 1028 (fontified t) 1028 1078 (fontified t) 1078 1089 (fontified t) 1089 1091 (face font-lock-keyword-face fontified t) 1091 1093 (face font-lock-keyword-face fontified t) 1093 1101 (fontified t) 1101 1114 (fontified t) 1114 1118 (face font-lock-keyword-face fontified t) 1118 1174 (fontified t) 1174 1181 (face font-lock-string-face fontified t) 1181 1274 (fontified t) 1274 1325 (fontified t) 1325 1340 (fontified t) 1340 1346 (face font-lock-keyword-face fontified t) 1346 1368 (fontified t) 1368 1379 (face font-lock-keyword-face fontified t) 1379 1422 (fontified t) 1422 1425 (face font-lock-comment-delimiter-face fontified t) 1425 1472 (face font-lock-comment-face fontified t) 1472 1483 (fontified t) 1483 1486 (face font-lock-keyword-face fontified t) 1486 1509 (fontified t) 1509 1513 (face font-lock-builtin-face fontified t) 1513 1536 (fontified t) 1536 1541 (face font-lock-string-face fontified t) 1541 1591 (fontified t) 1591 1595 (face font-lock-builtin-face fontified t) 1595 1618 (fontified t) 1618 1623 (face font-lock-string-face fontified t) 1623 1678 (fontified t) 1678 1682 (face font-lock-keyword-face fontified t) 1682 1717 (fontified t) 1717 1728 (face font-lock-keyword-face fontified t) 1728 1772 (fontified t) 1772 1776 (face font-lock-keyword-face fontified t) 1776 1811 (fontified t) 1811 1822 (face font-lock-keyword-face fontified t) 1822 1895 (fontified t) 1895 1900 (face font-lock-warning-face fontified t) 1900 1924 (fontified t)) . -2849) (undo-tree-id1 . -579) (undo-tree-id2 . -579) (undo-tree-id3 . -1924) (undo-tree-id4 . -788) 4773) nil (26798 57467 942210 0) 0 nil])
([nil nil ((2849 . 2850)) nil (26798 57467 942192 0) 0 nil])
([nil nil ((224 . 225) (t 26798 57467 0 0)) nil (26798 59827 793017 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 236 . 237) (nil fontified nil 225 . 237) (225 . 237)) nil (26798 59827 793015 0) 0 nil])
([nil nil ((225 . 226)) nil (26798 59827 793011 0) 0 nil])
([nil nil ((238 . 239) (t 26798 59827 0 0)) nil (26798 61460 453667 0) 0 nil])
([nil nil ((239 . 244)) nil (26798 61460 453667 0) 0 nil])
([nil nil ((239 . 251) (#("issue" 0 5 (fontified t)) . -239) (undo-tree-id6 . -5) 244) nil (26798 61460 453666 0) 0 nil])
([nil nil ((251 . 252)) nil (26798 61460 453663 0) 0 nil])
([nil nil ((252 . 260)) nil (26798 61460 453662 0) 0 nil])
([nil nil ((252 . 265) (#("issue-re" 0 8 (fontified t)) . -252) (undo-tree-id5 . -8) 260) nil (26798 61460 453661 0) 0 nil])
([nil nil ((252 . 253)) nil (26798 61460 453652 0) 0 nil])
([nil nil ((239 . 240)) nil (26798 61460 453648 0) 0 nil])
([nil nil ((#("json-bytes" 0 10 (face font-lock-function-name-face fontified t)) . -701) (undo-tree-id7 . -10) 711 (t 26798 61460 0 0)) nil (26798 61570 957593 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 711 . 712) (nil fontified nil 701 . 712) (701 . 712)) nil (26798 61570 957582 0) 0 nil])
([nil nil ((267 . 268)) nil (26798 61570 957581 0) 0 nil])
([nil nil ((268 . 269)) nil (26798 61570 957580 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 281 . 282) (nil fontified nil 269 . 282) (269 . 282)) nil (26798 61570 957577 0) 0 nil])
([nil nil ((#("parse-json-bytes" 0 16 (face font-lock-function-name-face fontified t)) . -819) (undo-tree-id8 . -16) (undo-tree-id9 . -5) (undo-tree-id10 . -5) (undo-tree-id11 . -5) (undo-tree-id12 . -5) (undo-tree-id13 . -5) (undo-tree-id14 . -16) (undo-tree-id15 . -16) (undo-tree-id16 . -16) (undo-tree-id17 . -16) (undo-tree-id18 . -16) (undo-tree-id19 . -16) (undo-tree-id20 . -16) (undo-tree-id21 . -16) (undo-tree-id22 . -16) (undo-tree-id23 . -16) (undo-tree-id24 . -16) (undo-tree-id25 . -16) (undo-tree-id26 . -16) (undo-tree-id27 . -16) (undo-tree-id28 . -16) (undo-tree-id29 . -16) (undo-tree-id30 . -16) (undo-tree-id31 . -16) (undo-tree-id32 . -5) (undo-tree-id33 . -5) (undo-tree-id34 . -5) (undo-tree-id35 . -5) (undo-tree-id36 . -5) (undo-tree-id37 . -16) (undo-tree-id38 . -16) (undo-tree-id39 . -16) (undo-tree-id40 . -16) (undo-tree-id41 . -16) (undo-tree-id42 . -16) (undo-tree-id43 . -16) (undo-tree-id44 . -16) 835 (t 26798 61570 0 0)) nil (26798 61664 800600 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 829 . 830) (nil fontified nil 819 . 830) (819 . 830)) nil (26798 61664 800564 0) 0 nil])
([nil nil ((1361 . 1366) (t 26798 61664 0 0)) nil (26799 11112 988908 0) 0 nil])
([nil nil ((1366 . 1372)) nil (26799 11112 988907 0) 0 nil])
([nil nil ((1372 . 1373)) nil (26799 11112 988907 0) 0 nil])
([nil nil ((1373 . 1375)) nil (26799 11112 988906 0) 0 nil])
([nil nil ((1375 . 1380)) nil (26799 11112 988906 0) 0 nil])
([nil nil ((1380 . 1386)) nil (26799 11112 988905 0) 0 nil])
([nil nil ((1386 . 1387)) nil (26799 11112 988905 0) 0 nil])
([nil nil ((1387 . 1389)) nil (26799 11112 988905 0) 0 nil])
([nil nil ((1389 . 1394)) nil (26799 11112 988904 0) 0 nil])
([nil nil ((1394 . 1400)) nil (26799 11112 988904 0) 0 nil])
([nil nil ((1400 . 1401)) nil (26799 11112 988903 0) 0 nil])
([nil nil ((1401 . 1403)) nil (26799 11112 988902 0) 0 nil])
([nil nil ((#(")" 0 1 (fontified t)) . -1402) (undo-tree-id0 . -1) (undo-tree-id1 . -1) (undo-tree-id2 . -1) (undo-tree-id3 . -1) (undo-tree-id4 . -1) (undo-tree-id5 . -1) 1403) nil (26799 11112 988901 0) 0 nil])
([nil nil ((#("-" 0 1 (fontified t)) . 1394)) nil (26799 11112 988884 0) 0 nil])
([nil nil ((1394 . 1395)) nil (26799 11112 988883 0) 0 nil])
([nil nil ((1402 . 1403)) nil (26799 11112 988879 0) 0 nil])
([nil nil ((629 . 631) (t 26799 11112 0 0)) nil (26799 11794 271843 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 868 . 869) (nil fontified nil 631 . 869) (631 . 869)) nil (26799 11794 271842 0) 0 nil])
([nil nil ((#("
(defun b64url-encode (u8)
  (let ((s (cl-base64:usb8-array-to-base64-string u8 :uri t)))
    ;; cl-base64 en mode :uri fait déjà base64url sans '=' finaux
    s))
" 0 1 (fontified t) 1 2 (fontified t) 2 7 (face font-lock-keyword-face fontified t) 7 8 (fontified t) 8 21 (face font-lock-function-name-face fontified t) 21 30 (fontified t) 30 33 (face font-lock-keyword-face fontified t) 33 80 (fontified t) 80 84 (face font-lock-builtin-face fontified t) 84 94 (fontified t) 94 97 (face font-lock-comment-delimiter-face fontified t) 97 156 (face font-lock-comment-face fontified t) 156 164 (fontified t)) . 466) (undo-tree-id15 . -164) (undo-tree-id16 . -163) (undo-tree-id17 . -163) (undo-tree-id18 . -163) (undo-tree-id19 . -163) (undo-tree-id20 . -163) (undo-tree-id21 . -163) (undo-tree-id22 . 1) (undo-tree-id23 . -164) (undo-tree-id24 . -1) (undo-tree-id25 . -156) (undo-tree-id26 . -164) (undo-tree-id27 . -164) (undo-tree-id28 . -164) (undo-tree-id29 . -164) (undo-tree-id30 . -164) (undo-tree-id31 . -164) (undo-tree-id32 . -164) (undo-tree-id33 . -164)) nil (26799 11794 271840 0) 0 nil])
([nil nil ((#("
(defun b64url-decode (s)
  (cl-base64:base64-string-to-usb8-array s :uri t))" 0 2 (fontified t) 2 7 (face font-lock-keyword-face fontified t) 7 8 (fontified t) 8 21 (face font-lock-function-name-face fontified t) 21 69 (fontified t) 69 73 (face font-lock-builtin-face fontified t) 73 77 (fontified t)) . 706) (undo-tree-id9 . -77) (undo-tree-id10 . -77) (undo-tree-id11 . -77) (undo-tree-id12 . -77) (undo-tree-id13 . -77) (undo-tree-id14 . -77)) nil (26799 11794 271828 0) 0 nil])
([nil nil ((706 . 707)) nil (26799 11794 271821 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 1050 . 1051) (nil fontified nil 707 . 1051) (707 . 1051)) nil (26799 11794 271820 0) 0 nil])
([nil nil ((#(" :wrap nil" 0 1 (fontified t) 1 6 (face font-lock-builtin-face fontified t) 6 10 (fontified t)) . -604) (undo-tree-id6 . -10) (undo-tree-id7 . -10) (undo-tree-id8 . -10) 614) nil (26799 11794 271816 0) 0 nil])
([nil nil ((3051 . 3053) (t 26799 11794 0 0)) nil (26808 13508 640366 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 3729 . 3730) (nil fontified nil 3053 . 3730) (3053 . 3730)) nil (26808 13508 640365 0) 0 nil])
([nil nil ((2818 . 2819)) nil (26808 13508 640364 0) 0 nil])
([nil nil ((2819 . 2821)) nil (26808 13508 640364 0) 0 nil])
([nil nil ((3055 . 3057)) nil (26808 13508 640363 0) 0 nil])
([nil nil ((3057 . 3058)) nil (26808 13508 640360 0) 0 nil])
([nil nil ((1700 . 1702) (t 26808 13508 0 0)) nil (26808 24447 345487 0) 0 nil])
([nil nil ((1716 . 1718)) nil (26808 24447 345486 0) 0 nil])
([nil nil ((1732 . 1734)) nil (26808 24447 345482 0) 0 nil])
([nil nil ((1956 . 1958) (t 26808 24447 0 0)) nil (26819 48209 6106 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 1987 . 1988) (nil fontified nil 1984 . 1988) (nil fontified nil 1983 . 1984) (nil fontified nil 1968 . 1983) (nil fontified nil 1958 . 1968) (1958 . 1988)) nil (26819 48209 6105 0) 0 nil])
([nil nil ((#("TOKEN" 0 5 (face font-lock-string-face fontified t)) . -1971) (undo-tree-id48 . -5) 1976) nil (26819 48209 6104 0) 0 nil])
([nil nil ((1971 . 1972)) nil (26819 48209 6104 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 1984 . 1985) (nil fontified nil 1978 . 1985) (1978 . 1985)) nil (26819 48209 6103 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 1991 . 1992) (nil fontified nil 1985 . 1992) (1985 . 1992)) nil (26819 48209 6102 0) 0 nil])
([nil nil ((#("h" 0 1 (face font-lock-string-face fontified t)) . -1978) (undo-tree-id47 . -1) 1979) nil (26819 48209 6102 0) 0 nil])
([nil nil ((1978 . 1979)) nil (26819 48209 6100 0) 0 nil])
([nil nil ((#("h" 0 1 (face font-lock-string-face fontified t)) . 1985)) nil (26819 48209 6100 0) 0 nil])
([nil nil ((1985 . 1986)) nil (26819 48209 6099 0) 0 nil])
([nil nil ((#("tok" 0 3 (fontified t)) . -1994) (undo-tree-id46 . -3) 1997) nil (26819 48209 6099 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 1998 . 1999) (nil fontified nil 1994 . 1999) (1994 . 1999)) nil (26819 48209 6097 0) 0 nil])
([nil nil ((2058 . 2062)) nil (26819 48209 6096 0) 0 nil])
([nil nil ((nil fontified nil 2103 . 2104) (nil fontified nil 2102 . 2103) (nil fontified nil 2098 . 2102) (nil fontified nil 2097 . 2098) (nil fontified nil 2096 . 2097) (nil fontified nil 2095 . 2096) (nil fontified nil 2090 . 2095) (nil fontified nil 2089 . 2090) (nil fontified nil 2088 . 2089) (nil fontified nil 2083 . 2088) (nil fontified nil 2072 . 2083) (nil fontified nil 2062 . 2072) (2062 . 2104)) nil (26819 48209 6096 0) 0 nil])
([nil nil ((#("h" 0 1 (face font-lock-string-face fontified t)) . -2075) (undo-tree-id45 . -1) 2076) nil (26819 48209 6094 0) 0 nil])
([nil nil ((2075 . 2082)) nil (26819 48209 6093 0) 0 nil])
([nil nil ((#("p: ~A~%s: ~A~%" 0 1 (face font-lock-string-face fontified t) 1 6 (face font-lock-string-face fontified t) 6 7 (face font-lock-string-face fontified t rear-nonsticky t) 7 8 (face font-lock-string-face fontified t) 8 13 (face font-lock-string-face fontified t) 13 14 (face font-lock-string-face fontified t rear-nonsticky t)) . -2088) (undo-tree-id44 . -14) 2102) nil (26819 48209 6093 0) 0 nil])
([nil nil ((#("h p s" 0 4 (fontified t) 4 5 (fontified t rear-nonsticky t)) . -2090) (undo-tree-id43 . -5) 2095) nil (26819 48209 6091 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 2096 . 2097) (nil fontified nil 2090 . 2097) (2090 . 2097)) nil (26819 48209 6090 0) 0 nil])
([nil nil ((2432 . 2436)) nil (26819 48209 6090 0) 0 nil])
([nil nil ((2436 . 2442)) nil (26819 48209 6089 0) 0 nil])
([nil nil ((2442 . 2443)) nil (26819 48209 6089 0) 0 nil])
([nil nil ((2443 . 2444)) nil (26819 48209 6089 0) 0 nil])
([nil nil ((#("'" 0 1 (fontified t)) . -2443) (undo-tree-id42 . -1) 2444) nil (26819 48209 6088 0) 0 nil])
([nil nil ((2443 . 2449)) nil (26819 48209 6087 0) 0 nil])
([nil nil ((#("?" 0 1 (face font-lock-string-face fontified t)) . -2444) (undo-tree-id12 . -1) (undo-tree-id13 . -1) (undo-tree-id14 . -1) (undo-tree-id15 . -1) (undo-tree-id16 . -1) (undo-tree-id17 . -1) (#("?" 0 1 (face font-lock-string-face fontified t)) . -2445) (undo-tree-id18 . -1) (undo-tree-id19 . -1) (undo-tree-id20 . -1) (undo-tree-id21 . -1) (undo-tree-id22 . -1) (undo-tree-id23 . -1) (#("?" 0 1 (face font-lock-string-face fontified t)) . -2446) (undo-tree-id24 . -1) (undo-tree-id25 . -1) (undo-tree-id26 . -1) (undo-tree-id27 . -1) (undo-tree-id28 . -1) (undo-tree-id29 . -1) (#("\"" 0 1 (face font-lock-string-face fontified t)) . -2447) (undo-tree-id30 . -1) (undo-tree-id31 . -1) (undo-tree-id32 . -1) (undo-tree-id33 . -1) (undo-tree-id34 . -1) (undo-tree-id35 . -1) (#(")" 0 1 (fontified t)) . -2448) (undo-tree-id36 . -1) (undo-tree-id37 . -1) (undo-tree-id38 . -1) (undo-tree-id39 . -1) (undo-tree-id40 . -1) (undo-tree-id41 . -1) 2449) nil (26819 48209 6085 0) 0 nil])
([nil nil ((2444 . 2450)) nil (26819 48209 6066 0) 0 nil])
([nil nil ((#(")" 0 1 (fontified t)) . -2449) (undo-tree-id10 . -1) (undo-tree-id11 . -1) 2450) nil (26819 48209 6065 0) 0 nil])
([nil nil ((2859 . 2863)) nil (26819 48209 6063 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 2875 . 2876) (nil fontified nil 2875 . 2876) (nil fontified nil 2870 . 2875) (nil fontified nil 2863 . 2870) (2863 . 2876)) nil (26819 48209 6062 0) 0 nil])
([nil nil ((#("MMM" 0 3 (face font-lock-string-face fontified t)) . -2871) (undo-tree-id0 . -3) (undo-tree-id1 . -2) (undo-tree-id2 . -2) (undo-tree-id3 . -2) (undo-tree-id4 . -2) (undo-tree-id5 . -2) (undo-tree-id6 . -3) (undo-tree-id7 . -3) (undo-tree-id8 . -3) (undo-tree-id9 . -3) 2874) nil (26819 48209 6060 0) 0 nil])
([nil nil ((2871 . 2875)) nil (26819 48209 6033 0) 0 nil])
([nil nil ((2670 . 2676) (t 26819 48209 0 0)) nil (26819 48418 803880 0) 0 nil])
([nil nil ((2676 . 2682)) nil (26819 48418 803879 0) 0 nil])
([nil nil ((2682 . 2683)) nil (26819 48418 803879 0) 0 nil])
([nil nil ((2683 . 2687)) nil (26819 48418 803878 0) 0 nil])
([nil nil ((2687 . 2693)) nil (26819 48418 803878 0) 0 nil])
([nil nil ((2693 . 2695)) nil (26819 48418 803877 0) 0 nil])
([nil nil ((#("^" 0 1 (fontified t)) . -2694) (undo-tree-id59 . -1) 2695) nil (26819 48418 803877 0) 0 nil])
([nil nil ((2694 . 2698)) nil (26819 48418 803876 0) 0 nil])
([nil nil ((#("o" 0 1 (fontified t)) . -2696) (undo-tree-id57 . -1) (#("t" 0 1 (fontified t)) . -2697) (undo-tree-id58 . -1) 2698) nil (26819 48418 803875 0) 0 nil])
([nil nil ((2696 . 2699)) nil (26819 48418 803873 0) 0 nil])
([nil nil ((2699 . 2700)) nil (26819 48418 803873 0) 0 nil])
([nil nil ((2700 . 2702)) nil (26819 48418 803872 0) 0 nil])
([nil nil ((2702 . 2704)) nil (26819 48418 803872 0) 0 nil])
([nil nil ((2704 . 2710)) nil (26819 48418 803872 0) 0 nil])
([nil nil ((2710 . 2716)) nil (26819 48418 803871 0) 0 nil])
([nil nil ((2716 . 2717)) nil (26819 48418 803871 0) 0 nil])
([nil nil ((2717 . 2721)) nil (26819 48418 803871 0) 0 nil])
([nil nil ((2721 . 2727)) nil (26819 48418 803870 0) 0 nil])
([nil nil ((2727 . 2733)) nil (26819 48418 803870 0) 0 nil])
([nil nil ((2733 . 2734)) nil (26819 48418 803870 0) 0 nil])
([nil nil ((#("-" 0 1 (fontified t)) . -2727) (undo-tree-id50 . -1) (#("p" 0 1 (fontified t)) . -2728) (undo-tree-id51 . -1) (#("r" 0 1 (fontified t)) . -2729) (undo-tree-id52 . -1) (#("i" 0 1 (fontified t)) . -2730) (undo-tree-id53 . -1) (#("n" 0 1 (fontified t)) . -2731) (undo-tree-id54 . -1) (#("t" 0 1 (fontified t)) . -2732) (undo-tree-id55 . -1) (#(" " 0 1 (fontified t)) . -2733) (undo-tree-id56 . -1) 2734) nil (26819 48418 803868 0) 0 nil])
([nil nil ((2727 . 2733)) nil (26819 48418 803863 0) 0 nil])
([nil nil ((2733 . 2734)) nil (26819 48418 803862 0) 0 nil])
([nil nil ((2734 . 2737)) nil (26819 48418 803862 0) 0 nil])
([nil nil ((2734 . 2740) (#("lee" 0 3 (fontified t)) . -2734) (undo-tree-id49 . -3) 2737) nil (26819 48418 803861 0) 0 nil])
([nil nil ((2740 . 2741)) nil (26819 48418 803851 0) 0 nil])
([nil nil ((2741 . 2747)) nil (26819 48418 803851 0) 0 nil])
([nil nil ((2747 . 2753)) nil (26819 48418 803850 0) 0 nil])
([nil nil ((2753 . 2754)) nil (26819 48418 803850 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 2785 . 2786) (nil fontified nil 2754 . 2786) (2754 . 2786)) nil (26819 48418 803850 0) 0 nil])
([nil nil ((2786 . 2787)) nil (26819 48418 803849 0) 0 nil])
([nil nil ((2787 . 2793)) nil (26819 48418 803848 0) 0 nil])
([nil nil ((2793 . 2799)) nil (26819 48418 803848 0) 0 nil])
([nil nil ((2799 . 2800)) nil (26819 48418 803847 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 2831 . 2832) (nil fontified nil 2800 . 2832) (2800 . 2832)) nil (26819 48418 803846 0) 0 nil])
([nil nil ((2832 . 2833)) nil (26819 48418 803842 0) 0 nil])
([nil nil ((1852 . 1853) (t 26819 48418 0 0)) nil (26819 51402 146739 0) 0 nil])
([nil nil ((#("
	(format t \"~&h: ~A~%p: ~A~%s: ~A~%\" h p s)" 0 1 (fontified t) 1 2 (fontified t) 2 12 (fontified t) 12 23 (face font-lock-string-face fontified t) 23 28 (face font-lock-string-face fontified t) 28 29 (face font-lock-string-face fontified t rear-nonsticky t) 29 30 (face font-lock-string-face fontified t) 30 35 (face font-lock-string-face fontified t) 35 36 (face font-lock-string-face fontified t rear-nonsticky t) 36 37 (face font-lock-string-face fontified t) 37 38 (fontified t) 38 42 (fontified t) 42 43 (fontified t rear-nonsticky t) 43 44 (fontified t rear-nonsticky t)) . 1957) (undo-tree-id64 . -44) (t 26819 51402 0 0)) nil (26821 11288 212241 0) 0 nil])
([nil nil ((#("
	  (format t \"~&payload: ~A~%\" payload)" 0 1 (fontified t) 1 4 (fontified t) 4 14 (fontified t) 14 30 (face font-lock-string-face fontified t) 30 31 (face font-lock-string-face fontified t) 31 32 (fontified t) 32 38 (fontified t) 38 39 (fontified t rear-nonsticky t) 39 40 (fontified t rear-nonsticky t)) . 2015) (undo-tree-id63 . -40)) nil (26821 11288 212240 0) 0 nil])
([nil nil ((#("
	  (print \"MMM\")" 0 1 (fontified t) 1 11 (fontified t) 11 16 (face font-lock-string-face fontified t) 16 17 (fontified t)) . 2349) (undo-tree-id62 . -17)) nil (26821 11288 212238 0) 0 nil])
([nil nil ((#("
	    (print exp)
	    (print nbf)
	    (print now)
	    (print leeway)
	    (print (and exp (> (+ now leeway) exp)))
	    (print (and nbf (< (- now leeway) nbf)))" 0 1 (fontified t) 1 18 (fontified t) 18 35 (fontified t) 35 52 (fontified t) 52 64 (fontified t) 64 72 (fontified t) 72 84 (fontified t) 84 115 (fontified t) 115 116 (fontified t rear-nonsticky t) 116 118 (fontified t) 118 130 (fontified t) 130 161 (fontified t) 161 162 (fontified t rear-nonsticky t) 162 163 (fontified t)) . 2570) (undo-tree-id61 . -163)) nil (26821 11288 212236 0) 0 nil])
([nil nil ((#("
	  (print \"PPPP\")" 0 1 (fontified t) 1 4 (fontified t) 4 11 (fontified t) 11 17 (face font-lock-string-face fontified t) 17 18 (fontified t rear-nonsticky t)) . 2759) (undo-tree-id60 . -18)) nil (26821 11288 212231 0) 0 nil])
([nil nil ((2349 . 2353) (t 26821 11288 0 0)) nil (26822 28475 351494 0) 0 nil])
([nil nil ((2353 . 2359)) nil (26822 28475 351493 0) 0 nil])
([nil nil ((2359 . 2360)) nil (26822 28475 351493 0) 0 nil])
([nil nil ((2360 . 2368)) nil (26822 28475 351492 0) 0 nil])
([nil nil ((2368 . 2372)) nil (26822 28475 351491 0) 0 nil])
([nil nil ((2372 . 2376)) nil (26822 28475 351491 0) 0 nil])
([nil nil ((#("-" 0 1 (fontified t)) . -2372) (undo-tree-id17 . -1) (#("p" 0 1 (fontified t)) . -2373) (undo-tree-id18 . -1) (#("r" 0 1 (fontified t)) . -2374) (undo-tree-id19 . -1) (#("i" 0 1 (fontified t)) . -2375) (undo-tree-id20 . -1) 2376) nil (26822 28475 351489 0) 0 nil])
([nil nil ((2372 . 2378)) nil (26822 28475 351485 0) 0 nil])
([nil nil ((2378 . 2379)) nil (26822 28475 351484 0) 0 nil])
([nil nil ((#("or (cdr (assoc" 0 14 (fontified t)) . -2430) (undo-tree-id16 . -14) 2444) nil (26822 28475 351484 0) 0 nil])
([nil nil ((2430 . 2438)) nil (26822 28475 351482 0) 0 nil])
([nil nil ((2430 . 2451) (#("lumen.ut" 0 8 (fontified t)) . -2430) (undo-tree-id15 . -8) 2438) nil (26822 28475 351481 0) 0 nil])
([nil nil ((#(" (cdr (assoc \"exp\" payload))))" 0 13 (fontified t) 13 18 (face font-lock-string-face fontified t) 18 30 (fontified t)) . 2466)) nil (26822 28475 351479 0) 0 nil])
([nil nil ((#("or (cdr (assoc" 0 14 (fontified t)) . -2489) (undo-tree-id14 . -14) 2503) nil (26822 28475 351479 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 2509 . 2510) (nil fontified nil 2489 . 2510) (2489 . 2510)) nil (26822 28475 351477 0) 0 nil])
([nil nil ((#(" (cdr (assoc \"nbf\" payload))))" 0 13 (fontified t) 13 18 (face font-lock-string-face fontified t) 18 30 (fontified t)) . 2525)) nil (26822 28475 351476 0) 0 nil])
([nil nil ((2554 . 2560)) nil (26822 28475 351475 0) 0 nil])
([nil nil ((#("
	  (print " 0 1 (fontified t) 1 11 (fontified t)) . 2368) (undo-tree-id13 . -11)) nil (26822 28475 351474 0) 0 nil])
([nil nil ((2549 . 2555)) nil (26822 28475 351473 0) 0 nil])
([nil nil ((2555 . 2556)) nil (26822 28475 351472 0) 0 nil])
([nil nil ((2556 . 2560)) nil (26822 28475 351472 0) 0 nil])
([nil nil ((2560 . 2566)) nil (26822 28475 351471 0) 0 nil])
([nil nil ((2566 . 2567)) nil (26822 28475 351470 0) 0 nil])
([nil nil ((#("-" 0 1 (fontified t)) . -2566) (undo-tree-id12 . -1) 2567) nil (26822 28475 351470 0) 0 nil])
([nil nil ((2566 . 2572)) nil (26822 28475 351468 0) 0 nil])
([nil nil ((2572 . 2573)) nil (26822 28475 351467 0) 0 nil])
([nil nil ((2573 . 2574)) nil (26822 28475 351467 0) 0 nil])
([nil nil ((#("b" 0 1 (fontified t)) . -2573) (undo-tree-id11 . -1) 2574) nil (26822 28475 351466 0) 0 nil])
([nil nil ((2573 . 2577)) nil (26822 28475 351464 0) 0 nil])
([nil nil ((2577 . 2583)) nil (26822 28475 351463 0) 0 nil])
([nil nil ((2583 . 2589)) nil (26822 28475 351462 0) 0 nil])
([nil nil ((2589 . 2590)) nil (26822 28475 351462 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 2603 . 2604) (nil fontified nil 2590 . 2604) (2590 . 2604)) nil (26822 28475 351461 0) 0 nil])
([nil nil ((2604 . 2605)) nil (26822 28475 351460 0) 0 nil])
([nil nil ((2605 . 2611)) nil (26822 28475 351459 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 2632 . 2633) (nil fontified nil 2632 . 2633) (nil fontified nil 2631 . 2632) (nil fontified nil 2618 . 2631) (nil fontified nil 2611 . 2618) (2611 . 2633)) nil (26822 28475 351458 0) 0 nil])
([nil nil ((#("+" 0 1 (fontified t)) . -2619) (undo-tree-id0 . -1) (undo-tree-id1 . -1) (undo-tree-id2 . -1) (undo-tree-id3 . -1) (undo-tree-id4 . -1) (undo-tree-id5 . -1) (undo-tree-id6 . -1) (undo-tree-id7 . -1) (undo-tree-id8 . -1) (undo-tree-id9 . -1) (undo-tree-id10 . -1) 2620) nil (26822 28475 351455 0) 0 nil])
([nil nil ((2619 . 2620)) nil (26822 28475 351420 0) 0 nil])
([nil nil ((2543 . 2549) (t 26822 28475 0 0)) nil (26822 28687 322608 0) 0 nil])
([nil nil ((2549 . 2555)) nil (26822 28687 322607 0) 0 nil])
([nil nil ((2555 . 2556)) nil (26822 28687 322607 0) 0 nil])
([nil nil ((2556 . 2559)) nil (26822 28687 322606 0) 0 nil])
([nil nil ((2559 . 2560)) nil (26822 28687 322605 0) 0 nil])
([nil nil ((2560 . 2563)) nil (26822 28687 322605 0) 0 nil])
([nil nil ((2563 . 2564)) nil (26822 28687 322605 0) 0 nil])
([nil nil ((2564 . 2570)) nil (26822 28687 322604 0) 0 nil])
([nil nil ((2570 . 2571)) nil (26822 28687 322603 0) 0 nil])
([nil nil ((2571 . 2574)) nil (26822 28687 322603 0) 0 nil])
([nil nil ((1856 . 1859)) nil (26822 28687 322602 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 1883 . 1884) (nil fontified nil 1883 . 1884) (nil fontified nil 1866 . 1883) (nil fontified nil 1859 . 1866) (1859 . 1884)) nil (26822 28687 322601 0) 0 nil])
([nil nil ((#("1" 0 1 (face font-lock-string-face fontified t)) . -1881) (undo-tree-id24 . -1) 1882) nil (26822 28687 322600 0) 0 nil])
([nil nil ((1881 . 1882)) nil (26822 28687 322598 0) 0 nil])
([nil nil ((2290 . 2298)) nil (26822 28687 322597 0) 0 nil])
([nil nil ((2298 . 2304)) nil (26822 28687 322597 0) 0 nil])
([nil nil ((2304 . 2305)) nil (26822 28687 322596 0) 0 nil])
([nil nil ((2305 . 2311)) nil (26822 28687 322596 0) 0 nil])
([nil nil ((2311 . 2319)) nil (26822 28687 322595 0) 0 nil])
([nil nil ((2319 . 2325)) nil (26822 28687 322594 0) 0 nil])
([nil nil ((2325 . 2326)) nil (26822 28687 322593 0) 0 nil])
([nil nil ((2326 . 2331)) nil (26822 28687 322592 0) 0 nil])
([nil nil ((#("à" 0 1 (fontified t)) . -2330) (undo-tree-id21 . -1) (undo-tree-id22 . -1) (undo-tree-id23 . -1) 2331) nil (26822 28687 322590 0) 0 nil])
([nil nil ((2330 . 2331)) nil (26822 28687 322568 0) 0 nil])
([nil nil ((#("print" 0 5 (fontified t)) . -2299) (undo-tree-id40 . -5) 2304 (t 26822 28687 0 0)) nil (26822 28871 130242 0) 0 nil])
([nil nil ((2299 . 2305)) nil (26822 28871 130240 0) 0 nil])
([nil nil ((2305 . 2306)) nil (26822 28871 130239 0) 0 nil])
([nil nil ((2306 . 2307)) nil (26822 28871 130239 0) 0 nil])
([nil nil ((2307 . 2308)) nil (26822 28871 130238 0) 0 nil])
([nil nil ((2308 . 2309)) nil (26822 28871 130238 0) 0 nil])
([nil nil ((#("é" 0 1 (fontified t)) . -2308) (undo-tree-id39 . -1) 2309) nil (26822 28871 130237 0) 0 nil])
([nil nil ((2308 . 2314)) nil (26822 28871 130235 0) 0 nil])
([nil nil ((2314 . 2315)) nil (26822 28871 130235 0) 0 nil])
([nil nil ((2315 . 2317)) nil (26822 28871 130234 0) 0 nil])
([nil nil ((#("!" 0 1 (face font-lock-string-face fontified t)) . -2316) (undo-tree-id38 . -1) 2317) nil (26822 28871 130233 0) 0 nil])
([nil nil ((2316 . 2318)) nil (26822 28871 130232 0) 0 nil])
([nil nil ((#(";" 0 1 (face font-lock-string-face fontified t)) . -2316) (undo-tree-id36 . -1) (#("\"" 0 1 (face font-lock-string-face fontified t)) . -2317) (undo-tree-id37 . -1) 2318) nil (26822 28871 130230 0) 0 nil])
([nil nil ((2316 . 2317)) nil (26822 28871 130225 0) 0 nil])
([nil nil ((2317 . 2318)) nil (26822 28871 130224 0) 0 nil])
([nil nil ((#(" " 0 1 (face font-lock-string-face fontified t)) . -2317) (undo-tree-id35 . -1) 2318) nil (26822 28871 130224 0) 0 nil])
([nil nil ((2317 . 2318)) nil (26822 28871 130222 0) 0 nil])
([nil nil ((2318 . 2323)) nil (26822 28871 130222 0) 0 nil])
([nil nil ((2330 . 2338)) nil (26822 28871 130221 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 2369 . 2370) (nil fontified nil 2363 . 2370) (nil fontified nil 2348 . 2363) (nil fontified nil 2338 . 2348) (2338 . 2370)) nil (26822 28871 130220 0) 0 nil])
([nil nil ((#("calc" 0 4 (fontified t)) . 2385) (undo-tree-id34 . -4) 2389) nil (26822 28871 130218 0) 0 nil])
([nil nil ((#("exp-s" 0 5 (fontified t)) . -2364) (undo-tree-id33 . -5) 2369) nil (26822 28871 130216 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 2367 . 2368) (nil fontified nil 2364 . 2368) (2364 . 2368)) nil (26822 28871 130213 0) 0 nil])
([nil nil ((#("
	      (print )" 0 1 (fontified t) 1 16 (fontified t)) . 2369) (undo-tree-id25 . -16) (undo-tree-id26 . -15) (undo-tree-id27 . -1) (undo-tree-id28 . -1) (undo-tree-id29 . -16) (undo-tree-id30 . -16) (undo-tree-id31 . -16) (undo-tree-id32 . -16)) nil (26822 28871 130208 0) 0 nil])
([nil nil ((#("EXP S" 0 5 (face font-lock-string-face fontified t)) . -2351) (undo-tree-id41 . -5) 2356 (t 26822 28871 0 0)) nil (26822 29084 936106 0) 0 nil])
([nil nil ((2351 . 2355)) nil (26822 29084 936094 0) 0 nil])
([nil nil ((2455 . 2459)) nil (26822 29084 936093 0) 0 nil])
([nil nil ((2459 . 2465)) nil (26822 29084 936092 0) 0 nil])
([nil nil ((2465 . 2466)) nil (26822 29084 936090 0) 0 nil])
([nil nil ((2466 . 2480)) nil (26822 29084 936084 0) 0 nil])
([nil nil ((2586 . 2589) (t 26822 29084 0 0)) nil (26822 29186 558779 0) 0 nil])
([nil nil ((2589 . 2591)) nil (26822 29186 558778 0) 0 nil])
([nil nil ((2591 . 2592)) nil (26822 29186 558778 0) 0 nil])
([nil nil ((2592 . 2598)) nil (26822 29186 558777 0) 0 nil])
([nil nil ((2598 . 2599)) nil (26822 29186 558777 0) 0 nil])
([nil nil ((2599 . 2602)) nil (26822 29186 558776 0) 0 nil])
([nil nil ((2602 . 2603)) nil (26822 29186 558776 0) 0 nil])
([nil nil ((2603 . 2607)) nil (26822 29186 558775 0) 0 nil])
([nil nil ((2666 . 2669)) nil (26822 29186 558774 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 2686 . 2687) (nil fontified nil 2685 . 2687) (nil fontified nil 2679 . 2685) (nil fontified nil 2669 . 2679) (2669 . 2687)) nil (26822 29186 558773 0) 0 nil])
([nil nil ((#("0" 0 1 (face font-lock-string-face fontified t)) . -2683) (undo-tree-id42 . -1) (undo-tree-id43 . -1) (undo-tree-id44 . -1) (undo-tree-id45 . -1) (undo-tree-id46 . -1) (undo-tree-id47 . -1) (undo-tree-id48 . -1) 2684) nil (26822 29186 558770 0) 0 nil])
([nil nil ((2683 . 2684)) nil (26822 29186 558745 0) 0 nil])
([nil nil ((2542 . 2543) (t 26822 29186 0 0)) nil (26822 29222 531113 0) 0 nil])
([nil nil ((3091 . 3094) (t 26822 29222 0 0)) nil (26822 29296 458578 0) 0 nil])
([nil nil ((1887 . 1889)) nil (26822 29296 458577 0) 0 nil])
([nil nil ((#(":" 0 1 (fontified t)) . -1887) (undo-tree-id49 . -1) (undo-tree-id50 . -1) (undo-tree-id51 . -1) (#(":" 0 1 (face font-lock-builtin-face fontified t)) . -1888) (undo-tree-id52 . -1) 1889) nil (26822 29296 458575 0) 0 nil])
([nil nil ((1887 . 1889)) nil (26822 29296 458557 0) 0 nil])
([nil nil ((3065 . 3067)) nil (26822 29296 458552 0) 0 nil])
([nil nil ((#("payload" 0 7 (fontified t)) . 2580) (undo-tree-id75 . -7) (undo-tree-id76 . -7) (undo-tree-id77 . -7) (undo-tree-id78 . -7) (undo-tree-id79 . -7) (undo-tree-id80 . -7) (undo-tree-id81 . -7) (undo-tree-id82 . -7) (undo-tree-id83 . -7) (undo-tree-id84 . -7) 2587 (t 26822 29296 0 0)) nil (26822 29330 762638 0) 0 nil])
([nil nil ((#(" " 0 1 (fontified t)) . -2579) (undo-tree-id54 . -1) (undo-tree-id55 . -1) (undo-tree-id56 . -1) (undo-tree-id57 . -1) (undo-tree-id58 . -1) (undo-tree-id59 . -1) (undo-tree-id60 . -1) (undo-tree-id61 . -1) (undo-tree-id62 . -1) (undo-tree-id63 . -1) (undo-tree-id64 . -1) (undo-tree-id65 . -1) (undo-tree-id66 . -1) (undo-tree-id67 . -1) (undo-tree-id68 . -1) (undo-tree-id69 . -1) (undo-tree-id70 . -1) (undo-tree-id71 . -1) (undo-tree-id72 . -1) (undo-tree-id73 . -1) (undo-tree-id74 . -1) 2580) nil (26822 29330 762628 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 2581 . 2582) (nil fontified nil 2575 . 2582) (2575 . 2582)) nil (26822 29330 762606 0) 0 nil])
([nil nil ((2582 . 2583)) nil (26822 29330 762605 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 2661 . 2662) (nil fontified nil 2655 . 2662) (2655 . 2662)) nil (26822 29330 762604 0) 0 nil])
([nil nil ((2662 . 2663)) nil (26822 29330 762601 0) 0 nil])
([nil nil ((#(" payload" 0 8 (fontified t)) . 2667) (undo-tree-id53 . -8)) nil (26822 29330 762597 0) 0 nil])
([nil nil ((2750 . 2756) (t 26822 29330 0 0)) nil (26822 33020 966472 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 2766 . 2767) (nil fontified nil 2756 . 2767) (2756 . 2767)) nil (26822 33020 966471 0) 0 nil])
([nil nil ((#("exp" 0 3 (fontified t)) . -2763) (undo-tree-id85 . -3) 2766) nil (26822 33020 966469 0) 0 nil])
([nil nil ((2763 . 2766)) nil (26822 33020 966457 0) 0 nil])
([nil nil ((465 . 467) (t 26822 33020 0 0)) nil (26822 35258 827859 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 1979 . 1980) (nil fontified nil 467 . 1980) (467 . 1980)) nil (26822 35258 827858 0) 0 nil])
([nil nil ((1980 . 1981)) nil (26822 35258 827858 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 2191 . 2192) (nil fontified nil 2117 . 2192) (nil fontified nil 2113 . 2117) (nil fontified nil 2066 . 2113) (nil fontified nil 2062 . 2066) (nil fontified nil 1986 . 2062) (nil fontified nil 1982 . 1986) (1982 . 2192)) nil (26822 35258 827857 0) 0 nil])
([nil nil ((#("Comparaison temps constant pour les signatures" 0 46 (face font-lock-comment-face fontified t)) . -2066) (undo-tree-id96 . -46) 2112) nil (26822 35258 827856 0) 0 nil])
([nil nil ((2066 . 2070)) nil (26822 35258 827855 0) 0 nil])
([nil nil ((#("d" 0 1 (face font-lock-comment-face fontified t)) . -2069) (undo-tree-id95 . -1) 2070) nil (26822 35258 827854 0) 0 nil])
([nil nil ((2069 . 2074)) nil (26822 35258 827854 0) 0 nil])
([nil nil ((2074 . 2075)) nil (26822 35258 827853 0) 0 nil])
([nil nil ((2075 . 2076)) nil (26822 35258 827853 0) 0 nil])
([nil nil ((2076 . 2077)) nil (26822 35258 827852 0) 0 nil])
([nil nil ((2077 . 2085)) nil (26822 35258 827852 0) 0 nil])
([nil nil ((#(" (reposent sur tes fonctions existantes)" 0 40 (face font-lock-comment-face fontified t)) . -562) (undo-tree-id94 . -40) 602) nil (26822 35258 827852 0) 0 nil])
([nil nil ((#("s" 0 1 (face font-lock-comment-face fontified t)) . -561) (undo-tree-id92 . -1) (undo-tree-id93 . -1) 562) nil (26822 35258 827850 0) 0 nil])
([nil nil ((561 . 562)) nil (26822 35258 827849 0) 0 nil])
([nil nil ((189 . 192)) nil (26822 35258 827849 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 269 . 270) (nil fontified nil 269 . 270) (nil fontified nil 252 . 269) (nil fontified nil 251 . 252) (nil fontified nil 227 . 251) (nil fontified nil 224 . 227) (nil fontified nil 223 . 224) (nil fontified nil 206 . 223) (nil fontified nil 205 . 206) (nil fontified nil 204 . 205) (nil fontified nil 193 . 204) (nil fontified nil 192 . 193) (192 . 270)) nil (26822 35258 827848 0) 0 nil])
([nil nil ((269 . 270)) nil (26822 35258 827846 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 298 . 299) (nil fontified nil 270 . 299) (270 . 299)) nil (26822 35258 827846 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 843 . 844) (nil fontified nil 828 . 844) (828 . 844)) nil (26822 35258 827845 0) 0 nil])
([nil nil ((844 . 845)) nil (26822 35258 827845 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 1465 . 1466) (nil fontified nil 1450 . 1466) (1450 . 1466)) nil (26822 35258 827844 0) 0 nil])
([nil nil ((1466 . 1467)) nil (26822 35258 827844 0) 0 nil])
([nil nil ((#("
" 0 1 (fontified t)) . -2085) (undo-tree-id91 . -1) 2086) nil (26822 35258 827843 0) 0 nil])
([nil nil ((3583 . 3584)) nil (26822 35258 827842 0) 0 nil])
([nil nil ((#("
" 0 1 (fontified t)) . -3583) (undo-tree-id90 . -1) 3584) nil (26822 35258 827841 0) 0 nil])
([nil nil ((#("
(defun jwt-decode (token &key (secret *jwt-secret*) (verify t) (leeway 60))
  (print \"IN JWT DECODE 0\")
  ;;(handler-case
      (destructuring-bind (h p s)
          (uiop:split-string token :separator \".\")
        (let* ((payload (bytes->json (b64url-decode p))))
          (when verify
            (let* ((msg (trivial-utf-8:string-to-utf-8-bytes (format nil \"~A.~A\" h p)))
                   (exp-s (b64url-decode s))
                   (calc  (hmac-sha256 (trivial-utf-8:string-to-utf-8-bytes secret) msg)))
	      (format t \"~&EXP S: ~A~%\" exp-s)
	      (format t \"~&CALC: ~A~%\" calc)
              (unless (equalp exp-s calc) (return-from jwt-decode (values nil nil)))))
	  (print \"VVVVVVVVVVV\")
	  (print payload)
          ;; checks exp/nbf
          (let* ((exp (lumen.utils:alist-get payload :exp))
		(x (print \"OK 0\"))
                (nbf (lumen.utils:alist-get payload :nbf))
		(x (print \"OK 1\"))
                (now (now)))
	    (print \"IN JWT DECODE 1\")
	    (print now)
	    (print exp)
	    (print nbf)
	    (print (+ now leeway))
	    (print (- now leeway))
            (when (and exp (> (+ now leeway) exp)) (return-from jwt-decode (values nil nil)))
            (when (and nbf (< (- now leeway) nbf)) (return-from jwt-decode (values nil nil))))
          (values payload t)))
    ;;(error () (values nil nil)))
  )
" 0 1 (fontified t) 1 2 (fontified t) 2 3 (face font-lock-keyword-face fontified t) 3 7 (face font-lock-keyword-face fontified t) 7 8 (fontified t) 8 18 (face font-lock-function-name-face fontified t) 18 26 (fontified t) 26 30 (face font-lock-type-face fontified t) 30 77 (fontified t) 77 79 (fontified t) 79 86 (fontified t) 86 103 (face font-lock-string-face fontified t) 103 104 (fontified t rear-nonsticky t) 104 105 (fontified t) 105 107 (fontified t) 107 109 (face font-lock-comment-delimiter-face fontified t) 109 110 (face font-lock-comment-face fontified t) 110 122 (face font-lock-comment-face fontified t) 122 123 (face font-lock-comment-face fontified t) 123 130 (fontified t) 130 148 (face font-lock-keyword-face fontified t) 148 186 (fontified t) 186 187 (fontified t) 187 192 (fontified t) 192 202 (face font-lock-builtin-face fontified t) 202 203 (fontified t) 203 206 (face font-lock-string-face fontified t) 206 208 (fontified t) 208 217 (fontified t) 217 221 (face font-lock-keyword-face fontified t) 221 277 (fontified t) 277 281 (face font-lock-keyword-face fontified t) 281 302 (fontified t) 302 306 (face font-lock-keyword-face fontified t) 306 362 (fontified t) 362 369 (face font-lock-string-face fontified t) 369 422 (fontified t) 422 513 (fontified t) 513 530 (fontified t) 530 545 (face font-lock-string-face fontified t) 545 553 (fontified t) 553 560 (fontified t) 560 570 (fontified t) 570 584 (face font-lock-string-face fontified t) 584 585 (fontified t) 585 588 (fontified t) 588 589 (fontified t rear-nonsticky t) 589 590 (fontified t rear-nonsticky t) 590 591 (fontified t) 591 606 (fontified t) 606 612 (face font-lock-keyword-face fontified t) 612 634 (fontified t) 634 645 (face font-lock-keyword-face fontified t) 645 678 (fontified t) 678 688 (fontified t) 688 701 (face font-lock-string-face fontified t) 701 702 (fontified t) 702 703 (fontified t) 703 721 (fontified t) 721 722 (fontified t) 722 732 (fontified t) 732 735 (face font-lock-comment-delimiter-face fontified t) 735 750 (face font-lock-comment-face fontified t) 750 761 (fontified t) 761 765 (face font-lock-keyword-face fontified t) 765 773 (fontified t) 773 794 (fontified t) 794 795 (fontified t) 795 801 (fontified t) 801 802 (fontified t rear-nonsticky t) 802 803 (fontified t) 803 807 (face font-lock-builtin-face fontified t) 807 810 (fontified t) 810 822 (fontified t) 822 828 (face font-lock-string-face fontified t) 828 830 (fontified t) 830 831 (fontified t) 831 853 (fontified t) 853 873 (fontified t) 873 874 (fontified t rear-nonsticky t) 874 875 (fontified t) 875 881 (fontified t) 881 882 (fontified t rear-nonsticky t) 882 883 (fontified t) 883 887 (face font-lock-builtin-face fontified t) 887 890 (fontified t) 890 892 (fontified t) 892 902 (fontified t) 902 908 (face font-lock-string-face fontified t) 908 909 (fontified t) 909 910 (fontified t rear-nonsticky t) 910 911 (fontified t) 911 940 (fontified t) 940 952 (fontified t) 952 968 (face font-lock-string-face fontified t) 968 969 (face font-lock-string-face fontified t) 969 971 (fontified t) 971 976 (fontified t) 976 986 (fontified t) 986 987 (fontified t rear-nonsticky t) 987 988 (fontified t) 988 1005 (fontified t) 1005 1022 (fontified t) 1022 1034 (fontified t) 1034 1047 (fontified t) 1047 1048 (fontified t rear-nonsticky t) 1048 1050 (fontified t) 1050 1055 (fontified t) 1055 1062 (fontified t) 1062 1075 (fontified t) 1075 1076 (fontified t rear-nonsticky t) 1076 1077 (fontified t rear-nonsticky t) 1077 1078 (fontified t) 1078 1091 (fontified t) 1091 1095 (face font-lock-keyword-face fontified t) 1095 1130 (fontified t) 1130 1141 (face font-lock-keyword-face fontified t) 1141 1185 (fontified t) 1185 1189 (face font-lock-keyword-face fontified t) 1189 1224 (fontified t) 1224 1235 (face font-lock-keyword-face fontified t) 1235 1298 (fontified t) 1298 1302 (fontified t) 1302 1304 (face font-lock-comment-delimiter-face fontified t) 1304 1305 (face font-lock-comment-face fontified t) 1305 1310 (face font-lock-comment-face fontified t) 1310 1333 (face font-lock-comment-face fontified t) 1333 1337 (fontified t)) . -3583) (undo-tree-id86 . -1) (undo-tree-id87 . -939) (undo-tree-id88 . -1267) (undo-tree-id89 . -1337) 4920) nil (26822 35258 827840 0) 0 nil])
([nil nil ((3583 . 3584)) nil (26822 35258 827829 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 6320 . 6321) (nil fontified nil 3584 . 6321) (3584 . 6321)) nil (26822 35258 827825 0) 0 nil])
([nil nil ((#("(defun issue-access (user-id &key role scopes tenant claims (ttl *access-ttl*))
  \"Émet un access JWT. Champs standard : sub, role, scopes, (optionnel) tenant, iat, exp.
   CLAIMS permet d’ajouter des paires arbitraires (alist :kw → val).\"
  (let* ((base `((:sub . ,user-id)
                 (:role . ,role)
                 (:scopes . ,(or scopes '()))
                 ,@(when tenant `((:tenant . ,tenant)))
                 (:iat . ,(now))
                 (:exp . ,(+ (now) (or ttl *access-ttl*)))))
         ;; Merge (claims) *après* base pour autoriser un override si voulu
         (payload (append base (or claims '()))))
    (jwt-encode payload :secret *jwt-secret*)))

(defun issue-refresh (user-id &key role)
  (jwt-encode `((:sub . ,user-id)
                (:role . ,role)
                (:typ . \"refresh\")
                (:iat . ,(now))
                (:exp . ,(+ (now) *refresh-ttl*)))))" 0 1 (fontified t) 1 6 (face font-lock-keyword-face fontified t) 6 7 (fontified t) 7 19 (face font-lock-function-name-face fontified t) 19 29 (fontified t) 29 33 (face font-lock-type-face fontified t) 33 64 (fontified t) 64 80 (fontified t) 80 82 (fontified t) 82 83 (face font-lock-doc-face fontified t) 83 197 (face font-lock-doc-face fontified t) 197 227 (face font-lock-doc-face fontified t) 227 230 (face font-lock-doc-face fontified t) 230 232 (face font-lock-doc-face fontified t) 232 238 (face font-lock-doc-face fontified t) 238 239 (face font-lock-doc-face fontified t) 239 240 (fontified t) 240 243 (fontified t) 243 247 (face font-lock-keyword-face fontified t) 247 258 (fontified t) 258 262 (face font-lock-builtin-face fontified t) 262 293 (fontified t) 293 298 (face font-lock-builtin-face fontified t) 298 326 (fontified t) 326 333 (face font-lock-builtin-face fontified t) 333 374 (fontified t) 374 378 (face font-lock-keyword-face fontified t) 378 389 (fontified t) 389 396 (face font-lock-builtin-face fontified t) 396 428 (fontified t) 428 432 (face font-lock-builtin-face fontified t) 432 461 (fontified t) 461 465 (face font-lock-builtin-face fontified t) 465 504 (fontified t) 504 513 (fontified t) 513 516 (face font-lock-comment-delimiter-face fontified t) 516 580 (face font-lock-comment-face fontified t) 580 583 (fontified t) 583 587 (fontified t) 587 603 (fontified t) 603 630 (fontified t) 630 654 (fontified t) 654 661 (face font-lock-builtin-face fontified t) 661 680 (fontified t) 680 685 (face font-lock-keyword-face fontified t) 685 686 (fontified t) 686 690 (face font-lock-function-name-face fontified t) 690 693 (face font-lock-function-name-face fontified t) 693 699 (face font-lock-function-name-face fontified t) 699 709 (fontified t) 709 713 (face font-lock-type-face fontified t) 713 720 (fontified t) 720 734 (fontified t) 734 737 (fontified t) 737 741 (face font-lock-builtin-face fontified t) 741 749 (fontified t) 749 754 (fontified t) 754 763 (fontified t) 763 771 (fontified t) 771 776 (face font-lock-builtin-face fontified t) 776 784 (fontified t) 784 786 (fontified t) 786 792 (fontified t) 792 796 (fontified t) 796 803 (fontified t) 803 807 (face font-lock-builtin-face fontified t) 807 810 (fontified t) 810 811 (face font-lock-string-face fontified t) 811 818 (face font-lock-string-face fontified t) 818 819 (face font-lock-string-face fontified t) 819 821 (fontified t) 821 824 (fontified t) 824 826 (fontified t) 826 829 (fontified t) 829 834 (fontified t) 834 838 (fontified t) 838 842 (face font-lock-builtin-face fontified t) 842 853 (fontified t) 853 855 (fontified t) 855 870 (fontified t) 870 873 (face font-lock-builtin-face fontified t) 873 874 (face font-lock-builtin-face fontified t) 874 894 (fontified t) 894 905 (fontified t)) . -6562) (undo-tree-id151 . -905) 7467 (t 26822 35258 0 0)) nil (26822 35488 852740 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 7879 . 7880) (nil fontified nil 6562 . 7880) (6562 . 7880)) nil (26822 35488 852739 0) 0 nil])
([nil nil ((#("%" 0 1 (fontified t)) . -6776) (undo-tree-id140 . -1) (undo-tree-id141 . -1) (undo-tree-id142 . -1) (undo-tree-id143 . -1) (undo-tree-id144 . -1) (undo-tree-id145 . -1) (undo-tree-id146 . -1) (undo-tree-id147 . -1) (undo-tree-id148 . -1) (undo-tree-id149 . -1) (undo-tree-id150 . -1) 6777) nil (26822 35488 852738 0) 0 nil])
([nil nil ((6784 . 6786)) nil (26822 35488 852732 0) 0 nil])
([nil nil ((6776 . 6792) (#("now-unix-s" 0 10 (fontified t)) . -6776) (undo-tree-id125 . -10) (undo-tree-id126 . -8) (undo-tree-id127 . -8) (undo-tree-id128 . -8) (undo-tree-id129 . -8) (undo-tree-id130 . -8) (undo-tree-id131 . -8) (undo-tree-id132 . -8) (undo-tree-id133 . -8) (undo-tree-id134 . -8) (undo-tree-id135 . -8) (undo-tree-id136 . -9) (undo-tree-id137 . -9) (undo-tree-id138 . -10) (undo-tree-id139 . -10) 6786) nil (26822 35488 852731 0) 0 nil])
([nil nil ((#("%" 0 1 (fontified t)) . -7448) (undo-tree-id118 . -1) (undo-tree-id119 . -1) (undo-tree-id120 . -1) (undo-tree-id121 . -1) (undo-tree-id122 . -1) (undo-tree-id123 . -1) (undo-tree-id124 . -1) 7449) nil (26822 35488 852723 0) 0 nil])
([nil nil ((7456 . 7459)) nil (26822 35488 852719 0) 0 nil])
([nil nil ((7448 . 7464) (#("now-unix-se" 0 11 (fontified t)) . -7448) (undo-tree-id97 . -11) (undo-tree-id98 . -8) (undo-tree-id99 . -8) (undo-tree-id100 . -8) (undo-tree-id101 . -8) (undo-tree-id102 . -8) (undo-tree-id103 . -8) (undo-tree-id104 . -8) (undo-tree-id105 . -8) (undo-tree-id106 . -8) (undo-tree-id107 . -8) (undo-tree-id108 . -9) (undo-tree-id109 . -9) (undo-tree-id110 . -9) (undo-tree-id111 . -9) (undo-tree-id112 . -9) (undo-tree-id113 . -9) (undo-tree-id114 . -10) (undo-tree-id115 . -10) (undo-tree-id116 . -11) (undo-tree-id117 . -11) 7459) nil (26822 35656 592931 0) 0 nil])
([nil nil ((#("," 0 1 (fontified t)) . -6979) (undo-tree-id5 . -1) (undo-tree-id6 . -1) (#("(" 0 1 (fontified t)) . -6980) (undo-tree-id7 . -1) (undo-tree-id8 . -1) (#("o" 0 1 (fontified t)) . -6981) (undo-tree-id9 . -1) (undo-tree-id10 . -1) (#("r" 0 1 (fontified t)) . -6982) (undo-tree-id11 . -1) (undo-tree-id12 . -1) (#(" " 0 1 (fontified t)) . -6983) (undo-tree-id13 . -1) (undo-tree-id14 . -1) 6984 (t 26993 53276 0 0)) nil (27000 63510 155518 0) 0 nil] [nil nil ((4301 . 4303) (t 26822 35488 0 0)) ((#(";;" 0 2 (face font-lock-comment-delimiter-face fontified t)) . 4301)) (26822 35652 906828 0) 0 nil])
([nil nil ((#(" '()" 0 4 (fontified t)) . -6985) (undo-tree-id4 . -4) 6989) nil (27000 63510 155510 0) 0 nil])
([nil nil ((6321 . 6324)) ((#("
  " 0 1 (fontified t) 1 3 (fontified t)) . 6321) (undo-tree-id155 . -1)) (26822 35652 541720 0) 0 nil])
([nil nil ((#(")" 0 1 (fontified t)) . -6986) (undo-tree-id3 . -1) 6987) nil (27000 63510 155509 0) 0 nil])
([nil nil ((6238 . 6240)) ((#(";;" 0 2 (face font-lock-comment-delimiter-face fontified t)) . 6238)) (26822 35652 210477 0) 0 nil])
([nil nil ((#("(or " 0 4 (fontified t)) . -7144) (undo-tree-id1 . -4) (undo-tree-id2 . -4) 7148) nil (27000 63510 155507 0) 0 nil])
([nil nil ((6258 . 6260)) ((#(";;" 0 2 (face font-lock-comment-delimiter-face fontified t)) . 6258)) (26822 35651 853623 0) 0 nil])
([nil current ((#("'())" 0 4 (fontified t)) . -7151) (undo-tree-id0 . -4) 7155) nil (27000 63510 155500 0) 0 nil])
([nil nil ((6306 . 6308)) ((#(";;" 0 2 (face font-lock-comment-delimiter-face fontified t)) . 6306) (undo-tree-id152 . -2) (undo-tree-id153 . -2) (undo-tree-id154 . -2) (t 26822 35643 0 0)) (26822 35643 737450 0) 0 nil])
nil
nil
