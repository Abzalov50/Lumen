(undo-tree-save-format-version . 1)
"f15df8b5e114b99b65b8c8142cf50fadaf389ac1"
[nil nil nil nil (26810 37952 474151 0) 0 nil]
([nil nil ((nil rear-nonsticky nil 492 . 493) (nil fontified nil 1 . 493) (1 . 493) (t . -1)) nil (26810 37952 474150 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 16 . 17) (nil fontified nil 1 . 17) (1 . 17)) nil (26810 37952 474149 0) 0 nil])
([nil nil ((17 . 18)) nil (26810 37952 474149 0) 0 nil])
([nil nil ((#("host" 0 4 (face font-lock-type-face fontified t)) . -61) (undo-tree-id22 . -4) 65) nil (26810 37952 474148 0) 0 nil])
([nil nil ((#("-" 0 1 (face font-lock-type-face fontified t)) . -60) (undo-tree-id20 . -1) (undo-tree-id21 . -1) 61) nil (26810 37952 474147 0) 0 nil])
([nil nil ((#("core.middleware" 0 15 (face font-lock-type-face fontified t)) . -38) (undo-tree-id19 . -15) 53) nil (26810 37952 474145 0) 0 nil])
([nil nil ((38 . 43)) nil (26810 37952 474145 0) 0 nil])
([nil nil ((#("." 0 1 (face font-lock-type-face fontified t)) . -42) (undo-tree-id18 . -1) 43) nil (26810 37952 474144 0) 0 nil])
([nil nil ((#(":lumen.core.middleware.tenant-host" 0 34 (face font-lock-builtin-face fontified t)) . -459) (undo-tree-id17 . -34) 493) nil (26810 37952 474143 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 476 . 477) (nil fontified nil 459 . 477) (459 . 477)) nil (26810 37952 474142 0) 0 nil])
([nil nil ((478 . 480)) nil (26810 37952 474141 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 4836 . 4837) (nil fontified nil 4814 . 4837) (nil fontified nil 4804 . 4814) (nil fontified nil 4755 . 4804) (nil fontified nil 4732 . 4755) (nil fontified nil 4728 . 4732) (nil fontified nil 4702 . 4728) (nil fontified nil 4696 . 4702) (nil fontified nil 4657 . 4696) (nil fontified nil 4647 . 4657) (nil fontified nil 4644 . 4647) (nil fontified nil 4637 . 4644) (nil fontified nil 4596 . 4637) (nil fontified nil 4591 . 4596) (nil fontified nil 4581 . 4591) (nil fontified nil 4573 . 4581) (nil fontified nil 4535 . 4573) (nil fontified nil 4520 . 4535) (nil fontified nil 4504 . 4520) (nil fontified nil 4501 . 4504) (nil fontified nil 4373 . 4501) (nil fontified nil 4371 . 4373) (nil fontified nil 4364 . 4371) (nil fontified nil 4358 . 4364) (nil fontified nil 4345 . 4358) (nil fontified nil 4341 . 4345) (nil fontified nil 4306 . 4341) (nil fontified nil 4303 . 4306) (nil fontified nil 4299 . 4303) (nil fontified nil 4204 . 4299) (nil fontified nil 4194 . 4204) (nil fontified nil 4176 . 4194) (nil fontified nil 4175 . 4176) (nil fontified nil 4170 . 4175) (nil fontified nil 4169 . 4170) (nil fontified nil 4168 . 4169) (nil fontified nil 4153 . 4168) (nil fontified nil 4148 . 4153) (nil fontified nil 4104 . 4148) (nil fontified nil 4099 . 4104) (nil fontified nil 4095 . 4099) (nil fontified nil 4072 . 4095) (nil fontified nil 4034 . 4072) (nil fontified nil 4017 . 4034) (nil fontified nil 4014 . 4017) (nil fontified nil 3967 . 4014) (nil fontified nil 3963 . 3967) (nil fontified nil 3896 . 3963) (nil fontified nil 3885 . 3896) (nil fontified nil 3872 . 3885) (nil fontified nil 3868 . 3872) (nil fontified nil 3864 . 3868) (nil fontified nil 3801 . 3864) (nil fontified nil 3792 . 3801) (nil fontified nil 3775 . 3792) (nil fontified nil 3774 . 3775) (nil fontified nil 3769 . 3774) (nil fontified nil 3768 . 3769) (nil fontified nil 3744 . 3768) (nil fontified nil 3741 . 3744) (nil fontified nil 3674 . 3741) (nil fontified nil 3670 . 3674) (nil fontified nil 3649 . 3670) (nil fontified nil 3643 . 3649) (nil fontified nil 3636 . 3643) (nil fontified nil 3631 . 3636) (nil fontified nil 3621 . 3631) (nil fontified nil 3613 . 3621) (nil fontified nil 3612 . 3613) (nil fontified nil 3604 . 3612) (nil fontified nil 3588 . 3604) (nil fontified nil 3585 . 3588) (nil fontified nil 3543 . 3585) (nil fontified nil 3516 . 3543) (nil fontified nil 3509 . 3516) (nil fontified nil 3505 . 3509) (nil fontified nil 3437 . 3505) (nil fontified nil 3426 . 3437) (nil fontified nil 3413 . 3426) (nil fontified nil 3409 . 3413) (nil fontified nil 3405 . 3409) (nil fontified nil 3337 . 3405) (nil fontified nil 3327 . 3337) (nil fontified nil 3310 . 3327) (nil fontified nil 3309 . 3310) (nil fontified nil 3304 . 3309) (nil fontified nil 3303 . 3304) (nil fontified nil 3302 . 3303) (nil fontified nil 3224 . 3302) (nil fontified nil 3219 . 3224) (nil fontified nil 3174 . 3219) (nil fontified nil 3169 . 3174) (nil fontified nil 3091 . 3169) (nil fontified nil 3086 . 3091) (nil fontified nil 2965 . 3086) (nil fontified nil 2963 . 2965) (nil fontified nil 2864 . 2963) (nil fontified nil 2860 . 2864) (nil fontified nil 2849 . 2860) (nil fontified nil 2845 . 2849) (nil fontified nil 2841 . 2845) (nil fontified nil 2773 . 2841) (nil fontified nil 2763 . 2773) (nil fontified nil 2748 . 2763) (nil fontified nil 2747 . 2748) (nil fontified nil 2742 . 2747) (nil fontified nil 2704 . 2742) (nil fontified nil 2702 . 2704) (nil fontified nil 2661 . 2702) (nil fontified nil 2658 . 2661) (nil fontified nil 2648 . 2658) (nil fontified nil 2613 . 2648) (nil fontified nil 2610 . 2613) (nil fontified nil 2463 . 2610) (nil fontified nil 2461 . 2463) (nil fontified nil 2371 . 2461) (nil fontified nil 2367 . 2371) (nil fontified nil 2286 . 2367) (nil fontified nil 2266 . 2286) (nil fontified nil 2263 . 2266) (nil fontified nil 2256 . 2263) (nil fontified nil 2252 . 2256) (nil fontified nil 2241 . 2252) (nil fontified nil 2237 . 2241) (nil fontified nil 2233 . 2237) (nil fontified nil 2180 . 2233) (nil fontified nil 2170 . 2180) (nil fontified nil 2159 . 2170) (nil fontified nil 2158 . 2159) (nil fontified nil 2153 . 2158) (nil fontified nil 2131 . 2153) (nil fontified nil 2126 . 2131) (nil fontified nil 2107 . 2126) (nil fontified nil 2101 . 2107) (nil fontified nil 2036 . 2101) (nil fontified nil 2024 . 2036) (nil fontified nil 2023 . 2024) (nil fontified nil 2018 . 2023) (nil fontified nil 2016 . 2018) (nil fontified nil 1996 . 2016) (nil fontified nil 1991 . 1996) (nil fontified nil 1980 . 1991) (nil fontified nil 1967 . 1980) (nil fontified nil 1954 . 1967) (nil fontified nil 1918 . 1954) (nil fontified nil 1913 . 1918) (nil fontified nil 1894 . 1913) (nil fontified nil 1876 . 1894) (nil fontified nil 1856 . 1876) (nil fontified nil 1846 . 1856) (nil fontified nil 1826 . 1846) (nil fontified nil 1751 . 1826) (nil fontified nil 1742 . 1751) (nil fontified nil 1715 . 1742) (nil fontified nil 1714 . 1715) (nil fontified nil 1709 . 1714) (nil fontified nil 1707 . 1709) (nil fontified nil 1629 . 1707) (nil fontified nil 1624 . 1629) (nil fontified nil 1605 . 1624) (nil fontified nil 1600 . 1605) (nil fontified nil 1522 . 1600) (nil fontified nil 1517 . 1522) (nil fontified nil 1477 . 1517) (nil fontified nil 1466 . 1477) (nil fontified nil 1461 . 1466) (nil fontified nil 1455 . 1461) (nil fontified nil 1358 . 1455) (nil fontified nil 1349 . 1358) (nil fontified nil 1339 . 1349) (nil fontified nil 1329 . 1339) (nil fontified nil 1328 . 1329) (nil fontified nil 1323 . 1328) (nil fontified nil 1237 . 1323) (nil fontified nil 1233 . 1237) (nil fontified nil 1192 . 1233) (nil fontified nil 1188 . 1192) (nil fontified nil 1178 . 1188) (nil fontified nil 1168 . 1178) (nil fontified nil 1167 . 1168) (nil fontified nil 1162 . 1167) (nil fontified nil 1074 . 1162) (nil fontified nil 1067 . 1074) (nil fontified nil 1066 . 1067) (nil fontified nil 1061 . 1066) (nil fontified nil 1059 . 1061) (nil fontified nil 1016 . 1059) (nil fontified nil 1012 . 1016) (nil fontified nil 967 . 1012) (nil fontified nil 963 . 967) (nil fontified nil 920 . 963) (nil fontified nil 916 . 920) (nil fontified nil 899 . 916) (nil fontified nil 896 . 899) (nil fontified nil 886 . 896) (nil fontified nil 881 . 886) (nil fontified nil 863 . 881) (nil fontified nil 849 . 863) (nil fontified nil 848 . 849) (nil fontified nil 842 . 848) (nil fontified nil 821 . 842) (nil fontified nil 809 . 821) (nil fontified nil 808 . 809) (nil fontified nil 799 . 808) (nil fontified nil 783 . 799) (nil fontified nil 777 . 783) (nil fontified nil 769 . 777) (nil fontified nil 761 . 769) (nil fontified nil 760 . 761) (nil fontified nil 740 . 760) (nil fontified nil 702 . 740) (nil fontified nil 681 . 702) (nil fontified nil 680 . 681) (nil fontified nil 668 . 680) (nil fontified nil 666 . 668) (nil fontified nil 588 . 666) (nil fontified nil 583 . 588) (nil fontified nil 568 . 583) (nil fontified nil 563 . 568) (nil fontified nil 485 . 563) (nil fontified nil 480 . 485) (480 . 4837)) nil (26810 37952 474137 0) 0 nil])
([nil nil ((#("
" 0 1 (face font-lock-comment-face fontified t)) . -3301) (undo-tree-id16 . -1) 3302) nil (26810 37952 474124 0) 0 nil])
([nil nil ((#("
" 0 1 (face font-lock-comment-face fontified t)) . -1706) (undo-tree-id15 . -1) 1707) nil (26810 37952 474123 0) 0 nil])
([nil nil ((#("
" 0 1 (face font-lock-comment-face fontified t)) . -665) (undo-tree-id14 . -1) 666) nil (26810 37952 474122 0) 0 nil])
([nil nil ((#("%" 0 1 (face font-lock-function-name-face fontified t)) . -2746) (undo-tree-id13 . -1) 2747) nil (26810 37952 474121 0) 0 nil])
([nil nil ((#("%" 0 1 (fontified t)) . -4308) (undo-tree-id12 . -1) 4309) nil (26810 37952 474120 0) 0 nil])
([nil nil ((#("%" 0 1 (face font-lock-function-name-face fontified t)) . -2022) (undo-tree-id11 . -1) 2023) nil (26810 37952 474119 0) 0 nil])
([nil nil ((2022 . 2023)) nil (26810 37952 474118 0) 0 nil])
([nil nil ((#("(defun %host-header (req)
  (or (%maybe-real-host-from-proxy req)
      (cdr (assoc \"host\" (req-headers req) :test #'string-equal))))" 0 1 (fontified t) 1 6 (face font-lock-keyword-face fontified t) 6 7 (fontified t) 7 8 (face font-lock-function-name-face fontified t) 8 19 (face font-lock-function-name-face fontified t) 19 26 (fontified t) 26 84 (fontified t) 84 90 (face font-lock-string-face fontified t) 90 109 (fontified t) 109 114 (face font-lock-builtin-face fontified t) 114 133 (fontified t)) . 2015) (undo-tree-id10 . -133) 2148) nil (26810 37952 474117 0) 0 nil])
([nil nil ((#("
" 0 1 (fontified t)) . -2013) (undo-tree-id6 . -1) (undo-tree-id7 . -1) (#("
" 0 1 (fontified t)) . -2014) (undo-tree-id8 . -1) (undo-tree-id9 . -1) 2015) nil (26810 37952 474116 0) 0 nil])
([nil nil ((#(":tenant-from-host" 0 17 (face font-lock-builtin-face fontified t)) . -335) (undo-tree-id5 . -17) 352) nil (26810 37952 474110 0) 0 nil])
([nil nil ((335 . 336)) nil (26810 37952 474109 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 349 . 350) (nil fontified nil 336 . 350) (336 . 350)) nil (26810 37953 608580 0) 0 nil])
([nil nil ((4695 . 4696) 2714) nil (26810 37955 77795 0) 0 nil] [nil nil ((nil rear-nonsticky nil 2728 . 2729) (nil fontified nil 2714 . 2729) (2714 . 2729)) ((#("\"x-tenant-code\"" 0 14 (face font-lock-string-face fontified nil) 14 15 (face font-lock-string-face rear-nonsticky nil fontified nil)) . 2714) (undo-tree-id32 . -15) (undo-tree-id33 . -15) (undo-tree-id34 . -15) (undo-tree-id35 . -15) (undo-tree-id36 . -15) (undo-tree-id37 . -15) (undo-tree-id38 . -15) (undo-tree-id39 . -15) (undo-tree-id40 . -15) (nil rear-nonsticky t 2728 . 2729)) (26810 37953 81665 0) 0 nil])
([nil nil ((4565 . 4571) (t 26810 37955 0 0)) nil (26819 3384 625160 0) 0 nil])
([nil nil ((2729 . 2730)) ((#("s" 0 1 (fontified t)) . 2729) (undo-tree-id23 . -1) (undo-tree-id24 . -1) (undo-tree-id25 . -1) (undo-tree-id26 . -1) (undo-tree-id27 . -1) (undo-tree-id28 . -1) (undo-tree-id29 . -1) (undo-tree-id30 . -1) (undo-tree-id31 . -1)) (26810 37952 474194 0) 0 nil])
([nil nil ((4571 . 4577)) nil (26819 3384 625159 0) 0 nil])
([nil nil ((#("s" 0 1 (fontified t)) . -2729) (undo-tree-id0 . -1) (undo-tree-id1 . -1) (undo-tree-id2 . -1) (undo-tree-id3 . -1) (undo-tree-id4 . -1) 2730) ((2729 . 2730)) (26810 37952 474103 0) 0 nil])
([nil nil ((4577 . 4578)) nil (26819 3384 625159 0) 0 nil])
nil
([nil nil ((4578 . 4586)) nil (26819 3384 625158 0) 0 nil])
([nil nil ((4586 . 4592)) nil (26819 3384 625158 0) 0 nil])
([nil nil ((4592 . 4598)) nil (26819 3384 625157 0) 0 nil])
([nil nil ((4598 . 4599)) nil (26819 3384 625156 0) 0 nil])
([nil nil ((4599 . 4603)) nil (26819 3384 625152 0) 0 nil])
([nil nil ((4688 . 4691) (t 26819 3384 0 0)) nil (26819 3618 83865 0) 0 nil])
([nil nil ((4691 . 4692)) nil (26819 3618 83865 0) 0 nil])
([nil nil ((4728 . 4735)) nil (26819 3618 83864 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 4770 . 4771) (nil fontified nil 4757 . 4771) (nil fontified nil 4747 . 4757) (nil fontified nil 4735 . 4747) (4735 . 4771)) nil (26819 3618 83863 0) 0 nil])
([nil nil ((#("_" 0 1 (face font-lock-builtin-face fontified t)) . -4754) (undo-tree-id0 . -1) (undo-tree-id1 . -1) (undo-tree-id2 . -1) 4755) nil (26819 3618 83861 0) 0 nil])
([nil nil ((4754 . 4755)) nil (26819 3618 83839 0) 0 nil])
([nil nil ((4780 . 4781) (t 26819 3618 0 0)) nil (26819 3778 745462 0) 0 nil])
([nil nil ((#("
		   (print \"GGGGG\")
		   (print row)" 0 1 (fontified t) 1 13 (fontified t) 13 20 (face font-lock-string-face fontified t) 20 22 (fontified t) 22 38 (fontified t)) . 4565) (undo-tree-id3 . -38) (undo-tree-id4 . -38) (undo-tree-id5 . -38)) nil (26819 3778 745458 0) 0 nil])
([nil nil ((#("data" 0 4 (face font-lock-builtin-face fontified t)) . -464) (undo-tree-id15 . -4) (undo-tree-id16 . -1) 468 (t 26993 53276 0 0)) nil (26996 56848 197957 0) 0 nil])
([nil nil ((464 . 468)) nil (26996 56848 197954 0) 0 nil])
([nil nil ((#("data" 0 4 (face font-lock-type-face fontified t)) . -38) (undo-tree-id0 . -4) (undo-tree-id1 . -3) (undo-tree-id2 . -3) (undo-tree-id3 . -3) (undo-tree-id4 . -3) (undo-tree-id5 . -3) (undo-tree-id6 . -3) (undo-tree-id7 . -4) (undo-tree-id8 . -4) (undo-tree-id9 . -4) (undo-tree-id10 . -4) (undo-tree-id11 . -4) (undo-tree-id12 . -4) (undo-tree-id13 . -4) (undo-tree-id14 . -4) 42) nil (26996 56848 197952 0) 0 nil])
([nil nil ((38 . 42)) nil (26996 56848 197924 0) 0 nil])
([nil nil ((4744 . 4745) (t 26996 56848 0 0)) nil (26996 58296 741415 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 7667 . 7668) (nil fontified nil 7662 . 7668) (nil fontified nil 7654 . 7662) (nil fontified nil 7653 . 7654) (nil fontified nil 7632 . 7653) (nil fontified nil 7599 . 7632) (nil fontified nil 7585 . 7599) (nil fontified nil 7562 . 7585) (nil fontified nil 7554 . 7562) (nil fontified nil 7553 . 7554) (nil fontified nil 7533 . 7553) (nil fontified nil 7500 . 7533) (nil fontified nil 7487 . 7500) (nil fontified nil 7433 . 7487) (nil fontified nil 7392 . 7433) (nil fontified nil 7386 . 7392) (nil fontified nil 7375 . 7386) (nil fontified nil 7374 . 7375) (nil fontified nil 7369 . 7374) (nil fontified nil 7368 . 7369) (nil fontified nil 7341 . 7368) (nil fontified nil 7337 . 7341) (nil fontified nil 7281 . 7337) (nil fontified nil 7213 . 7281) (nil fontified nil 7210 . 7213) (nil fontified nil 7178 . 7210) (nil fontified nil 7171 . 7178) (nil fontified nil 7151 . 7171) (nil fontified nil 7126 . 7151) (nil fontified nil 7123 . 7126) (nil fontified nil 7115 . 7123) (nil fontified nil 7112 . 7115) (nil fontified nil 7104 . 7112) (nil fontified nil 7101 . 7104) (nil fontified nil 7096 . 7101) (nil fontified nil 7091 . 7096) (nil fontified nil 7085 . 7091) (nil fontified nil 6998 . 7085) (nil fontified nil 6975 . 6998) (nil fontified nil 6972 . 6975) (nil fontified nil 6914 . 6972) (nil fontified nil 6905 . 6914) (nil fontified nil 6893 . 6905) (nil fontified nil 6864 . 6893) (nil fontified nil 6856 . 6864) (nil fontified nil 6852 . 6856) (nil fontified nil 6831 . 6852) (nil fontified nil 6821 . 6831) (nil fontified nil 6760 . 6821) (nil fontified nil 6733 . 6760) (nil fontified nil 6730 . 6733) (nil fontified nil 6717 . 6730) (nil fontified nil 6713 . 6717) (nil fontified nil 6591 . 6713) (nil fontified nil 6589 . 6591) (nil fontified nil 6562 . 6589) (nil fontified nil 6543 . 6562) (nil fontified nil 6440 . 6543) (nil fontified nil 6435 . 6440) (nil fontified nil 6406 . 6435) (nil fontified nil 6394 . 6406) (nil fontified nil 6365 . 6394) (nil fontified nil 6303 . 6365) (nil fontified nil 6300 . 6303) (nil fontified nil 6208 . 6300) (nil fontified nil 6204 . 6208) (nil fontified nil 6119 . 6204) (nil fontified nil 6115 . 6119) (nil fontified nil 6036 . 6115) (nil fontified nil 6033 . 6036) (nil fontified nil 5927 . 6033) (nil fontified nil 5923 . 5927) (nil fontified nil 5885 . 5923) (nil fontified nil 5880 . 5885) (nil fontified nil 5877 . 5880) (nil fontified nil 5862 . 5877) (nil fontified nil 5804 . 5862) (nil fontified nil 5799 . 5804) (nil fontified nil 5796 . 5799) (nil fontified nil 5783 . 5796) (nil fontified nil 5704 . 5783) (nil fontified nil 5700 . 5704) (nil fontified nil 5656 . 5700) (nil fontified nil 5650 . 5656) (nil fontified nil 5600 . 5650) (nil fontified nil 5590 . 5600) (nil fontified nil 5528 . 5590) (nil fontified nil 5519 . 5528) (nil fontified nil 5518 . 5519) (nil fontified nil 5506 . 5518) (nil fontified nil 5505 . 5506) (nil fontified nil 5497 . 5505) (nil fontified nil 5475 . 5497) (nil fontified nil 5466 . 5475) (nil fontified nil 5465 . 5466) (nil fontified nil 5451 . 5465) (nil fontified nil 5450 . 5451) (nil fontified nil 5442 . 5450) (nil fontified nil 5416 . 5442) (nil fontified nil 5407 . 5416) (nil fontified nil 5406 . 5407) (nil fontified nil 5393 . 5406) (nil fontified nil 5392 . 5393) (nil fontified nil 5384 . 5392) (nil fontified nil 5364 . 5384) (nil fontified nil 5332 . 5364) (nil fontified nil 5299 . 5332) (nil fontified nil 5297 . 5299) (nil fontified nil 5262 . 5297) (nil fontified nil 5259 . 5262) (nil fontified nil 5249 . 5259) (nil fontified nil 5245 . 5249) (nil fontified nil 5235 . 5245) (nil fontified nil 5220 . 5235) (nil fontified nil 5219 . 5220) (nil fontified nil 5214 . 5219) (nil fontified nil 5191 . 5214) (nil fontified nil 5186 . 5191) (nil fontified nil 5171 . 5186) (nil fontified nil 5165 . 5171) (nil fontified nil 5127 . 5165) (nil fontified nil 5122 . 5127) (nil fontified nil 5114 . 5122) (nil fontified nil 5101 . 5114) (nil fontified nil 5063 . 5101) (nil fontified nil 5058 . 5063) (nil fontified nil 5055 . 5058) (nil fontified nil 5037 . 5055) (nil fontified nil 4976 . 5037) (nil fontified nil 4973 . 4976) (nil fontified nil 4963 . 4973) (nil fontified nil 4951 . 4963) (nil fontified nil 4950 . 4951) (nil fontified nil 4945 . 4950) (nil fontified nil 4944 . 4945) (nil fontified nil 4866 . 4944) (nil fontified nil 4861 . 4866) (nil fontified nil 4833 . 4861) (nil fontified nil 4828 . 4833) (nil fontified nil 4750 . 4828) (nil fontified nil 4745 . 4750) (4745 . 7668)) nil (26996 58296 741410 0) 0 nil])
([nil nil ((434 . 437) (#("        " 0 8 (fontified nil)) . -415) (441 . 442)) nil (26996 58296 741401 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 467 . 468) (nil fontified nil 456 . 468) (nil fontified nil 455 . 456) (nil fontified nil 437 . 455) (437 . 468)) nil (26996 58296 741400 0) 0 nil])
([nil nil ((#("core" 0 4 (face font-lock-builtin-face fontified t)) . -491) (undo-tree-id15 . -4) (undo-tree-id16 . -2) 495) nil (26996 58296 741399 0) 0 nil])
([nil nil ((491 . 495)) nil (26996 58296 741397 0) 0 nil])
([nil nil ((#("core" 0 4 (face font-lock-type-face fontified t)) . -38) (undo-tree-id0 . -4) (undo-tree-id1 . -2) (undo-tree-id2 . -2) (undo-tree-id3 . -2) (undo-tree-id4 . -2) (undo-tree-id5 . -2) (undo-tree-id6 . -2) (undo-tree-id7 . -4) (undo-tree-id8 . -4) (undo-tree-id9 . -4) (undo-tree-id10 . -4) (undo-tree-id11 . -4) (undo-tree-id12 . -4) (undo-tree-id13 . -4) (undo-tree-id14 . -4) 42) nil (26996 58296 741395 0) 0 nil])
([nil nil ((38 . 42)) nil (26996 58296 741366 0) 0 nil])
([nil nil ((323 . 326) (t 26996 58296 0 0)) nil (26996 58556 839967 0) 0 nil])
([nil nil ((nil rear-nonsticky nil 371 . 372) (nil fontified nil 371 . 372) (nil fontified nil 363 . 371) (nil fontified nil 362 . 363) (nil fontified nil 340 . 362) (nil fontified nil 339 . 340) (nil fontified nil 327 . 339) (nil fontified nil 326 . 327) (326 . 372)) nil (26996 58556 839966 0) 0 nil])
([nil nil ((#("data.repo.query" 0 15 (face font-lock-builtin-face fontified t)) . -347) (undo-tree-id17 . -15) 362) nil (26996 58556 839965 0) 0 nil])
([nil nil ((347 . 350)) nil (26996 58556 839964 0) 0 nil])
([nil nil ((#("e" 0 1 (face font-lock-builtin-face fontified t)) . -349) (undo-tree-id16 . -1) 350) nil (26996 58556 839963 0) 0 nil])
([nil nil ((349 . 355)) nil (26996 58556 839962 0) 0 nil])
([nil nil ((340 . 362) (#(":lumen.core.mid" 0 15 (face font-lock-builtin-face fontified t)) . -340) (undo-tree-id12 . -7) (undo-tree-id13 . -15) (undo-tree-id14 . -7) (undo-tree-id15 . -7) 355) nil (26996 58556 839961 0) 0 nil])
([nil nil ((362 . 363)) nil (26996 58556 839958 0) 0 nil])
([nil nil ((363 . 369)) nil (26996 58556 839958 0) 0 nil])
([nil nil ((363 . 376) (#(":defmi" 0 6 (face font-lock-builtin-face fontified t)) . -363) (undo-tree-id1 . -6) (undo-tree-id2 . -2) (undo-tree-id3 . -2) (undo-tree-id4 . -3) (undo-tree-id5 . -3) (undo-tree-id6 . -4) (undo-tree-id7 . -4) (undo-tree-id8 . -5) (undo-tree-id9 . -5) (undo-tree-id10 . -6) (undo-tree-id11 . -6) 369) nil (26996 58556 839956 0) 0 nil])
([nil nil ((#(" :select" 0 1 (fontified t) 1 8 (face font-lock-builtin-face fontified t)) . 376) (undo-tree-id0 . -8)) nil (26996 58556 839947 0) 0 nil])
([nil nil ((#("*" 0 1 (face font-lock-builtin-face fontified t)) . 376)) nil (26996 58556 839933 0) 0 nil])
([nil nil ((#("defmigration" 0 12 (face font-lock-builtin-face fontified t)) . -364) (undo-tree-id64 . -12) (undo-tree-id65 . -12) (undo-tree-id66 . -12) (undo-tree-id67 . -12) (undo-tree-id68 . -12) (undo-tree-id69 . -12) (undo-tree-id70 . -5) (undo-tree-id71 . -5) (undo-tree-id72 . -5) (undo-tree-id73 . -5) (undo-tree-id74 . -5) (undo-tree-id75 . -5) (undo-tree-id76 . -12) (undo-tree-id77 . -12) (undo-tree-id78 . -12) (undo-tree-id79 . -12) (undo-tree-id80 . -12) (undo-tree-id81 . -12) (undo-tree-id82 . -12) (undo-tree-id83 . -12) 376 (t 26996 58556 0 0)) nil (26996 58565 810484 0) 0 nil])
([nil nil ((364 . 371)) nil (26996 58565 810472 0) 0 nil])
([nil nil ((363 . 377) (#(":defmidd" 0 8 (face font-lock-builtin-face fontified t)) . -363) (undo-tree-id18 . -1) (undo-tree-id19 . -1) (undo-tree-id20 . -1) (undo-tree-id21 . -1) (undo-tree-id22 . -1) (undo-tree-id23 . -1) (undo-tree-id24 . -8) (undo-tree-id25 . -1) (undo-tree-id26 . -1) (undo-tree-id27 . -1) (undo-tree-id28 . -1) (undo-tree-id29 . -1) (undo-tree-id30 . -1) (undo-tree-id31 . -1) (undo-tree-id32 . -1) (undo-tree-id33 . -1) (undo-tree-id34 . -1) (undo-tree-id35 . -1) (undo-tree-id36 . -1) (undo-tree-id37 . -1) (undo-tree-id38 . -1) (undo-tree-id39 . -1) (undo-tree-id40 . -1) (undo-tree-id41 . -1) (undo-tree-id42 . -1) (undo-tree-id43 . -1) (undo-tree-id44 . -1) (undo-tree-id45 . -1) (undo-tree-id46 . -1) (undo-tree-id47 . -1) (undo-tree-id48 . -2) (undo-tree-id49 . -2) (undo-tree-id50 . -2) (undo-tree-id51 . -2) (undo-tree-id52 . -3) (undo-tree-id53 . -3) (undo-tree-id54 . -4) (undo-tree-id55 . -4) (undo-tree-id56 . -5) (undo-tree-id57 . -5) (undo-tree-id58 . -6) (undo-tree-id59 . -6) (undo-tree-id60 . -7) (undo-tree-id61 . -7) (undo-tree-id62 . -8) (undo-tree-id63 . -8) 371) nil (26996 58565 810467 0) 0 nil])
([nil nil ((#("lumen.data.tenant:" 0 18 (fontified t)) . -5612) (undo-tree-id84 . -18) (undo-tree-id85 . -18) (undo-tree-id86 . -18) 5630 (t 26996 58565 0 0)) nil (26996 58657 523467 0) 0 nil])
([nil nil ((#("lumen.data.tenant:" 0 18 (fontified t)) . -6545) (undo-tree-id6 . -18) (undo-tree-id7 . -18) (undo-tree-id8 . -18) (undo-tree-id9 . -18) (undo-tree-id10 . -18) (undo-tree-id11 . -18) (undo-tree-id12 . -18) 6563 (t 26996 58657 0 0)) nil (26996 62368 632055 0) 0 nil])
([nil nil ((#("lumen.data.tenant:" 0 11 (fontified t) 11 18 (fontified t)) . -6029) (undo-tree-id3 . -18) (undo-tree-id4 . -18) (undo-tree-id5 . -18) 6047) nil (26996 62368 632048 0) 0 nil])
([nil nil ((#("lumen.data.tenant:" 0 18 (fontified t)) . -6091) (undo-tree-id0 . -18) (undo-tree-id1 . -18) (undo-tree-id2 . -18) 6109) nil (26996 62584 459289 0) 0 nil])
([nil nil ((#("middleware" 0 10 (face font-lock-builtin-face fontified t)) . -352) (undo-tree-id3 . -10) 362 (t 26996 62622 0 0)) nil (26996 63908 591256 0) 0 nil] [nil nil ((nil rear-nonsticky (face) 5436 . 5437) (nil fontified nil 5415 . 5437) (5415 . 5437)) ((#("LUMEN.CORE.MIDDLEWARE:" 0 21 (fontified nil rear-nonsticky (face) slime-repl-output t) 21 22 (fontified nil rear-nonsticky (face) slime-repl-output t)) . 5415) (undo-tree-id53 . -22) (undo-tree-id54 . -22) (undo-tree-id55 . -22) (undo-tree-id56 . -22) (undo-tree-id57 . -22) (nil rear-nonsticky t 5436 . 5437) (t 26996 62570 0 0)) (26996 62570 871313 0) 0 nil] [nil nil ((#("(with-slots (require-host allow-headers resolver-fn) mw
    (labels ((fallback-from-headers ()
               (let* ((h (lumen.core.http:req-headers req))
                      (tid (cdr (assoc \"x-tenant-id\" h :test #'string-equal)))
                      (tcd (cdr (assoc \"x-tenant-code\" h :test #'string-equal))))
                 (cond
                   (tid (values tid (tenant-code-by-id tid)))
                   (tcd (let ((tid2 (tenant-id-by-code tcd)))
                          (when tid2 (values tid2 tcd))))
                   (t (values nil nil))))))
      
      (let* ((host-raw (%host-header req))
             (host (%normalize-host host-raw))
             ;; On utilise funcall pour permettre l'injection de mock en test
             (tid (and host (handler-case (funcall resolver-fn host) (error () nil))))
             (code (and tid (tenant-code-by-id tid))))
        
        (multiple-value-bind (tid2 code2)
            (if tid
                (values tid code)
                (and allow-headers (fallback-from-headers)))
          
          (cond
            ;; Cas Succès : Tenant Trouvé
            (tid2
             (lumen.core.http:ctx-set! req :tenant-id tid2)
             (when code2 (lumen.core.http:ctx-set! req :tenant-code code2))
             (funcall next req))
            
            ;; Cas Échec Strict : 404
            (require-host
             (lumen.core.http:respond-json 
              '((:error . ((:type . \"tenant\") (:message . \"Unknown tenant for host\")))) 
              :status 404))
            
            ;; Cas Échec Permissif : On continue (Mode \"Public\" ou \"Admin global\")
            (t 
             (funcall next req)))))))" 0 1 (fontified t) 1 11 (face font-lock-keyword-face fontified t) 11 61 (fontified t) 61 67 (face font-lock-keyword-face fontified t) 67 111 (fontified t) 111 115 (face font-lock-keyword-face fontified t) 115 194 (fontified t) 194 207 (face font-lock-string-face fontified t) 207 210 (fontified t) 210 215 (face font-lock-builtin-face fontified t) 215 273 (fontified t) 273 288 (face font-lock-string-face fontified t) 288 291 (fontified t) 291 296 (face font-lock-builtin-face fontified t) 296 334 (fontified t) 334 338 (face font-lock-keyword-face fontified t) 338 339 (fontified t) 339 376 (fontified t) 376 401 (fontified t) 401 426 (fontified t) 426 429 (face font-lock-keyword-face fontified t) 429 463 (fontified t) 463 490 (fontified t) 490 494 (face font-lock-keyword-face fontified t) 494 579 (fontified t) 579 583 (face font-lock-keyword-face fontified t) 583 675 (fontified t) 675 678 (face font-lock-comment-delimiter-face fontified t) 678 740 (face font-lock-comment-face fontified t) 740 769 (fontified t) 769 781 (face font-lock-keyword-face fontified t) 781 810 (fontified t) 810 815 (face font-lock-warning-face fontified t) 815 827 (fontified t) 827 882 (fontified t) 882 900 (fontified t) 900 919 (face font-lock-keyword-face fontified t) 919 946 (fontified t) 946 948 (face font-lock-keyword-face fontified t) 948 1070 (fontified t) 1070 1074 (face font-lock-keyword-face fontified t) 1074 1087 (fontified t) 1087 1090 (face font-lock-comment-delimiter-face fontified t) 1090 1117 (face font-lock-comment-face fontified t) 1117 1178 (fontified t) 1178 1188 (face font-lock-builtin-face fontified t) 1188 1209 (fontified t) 1209 1213 (face font-lock-keyword-face fontified t) 1213 1250 (fontified t) 1250 1262 (face font-lock-builtin-face fontified t) 1262 1329 (fontified t) 1329 1332 (face font-lock-comment-delimiter-face fontified t) 1332 1355 (face font-lock-comment-face fontified t) 1355 1442 (fontified t) 1442 1448 (face font-lock-builtin-face fontified t) 1448 1453 (fontified t) 1453 1458 (face font-lock-builtin-face fontified t) 1458 1461 (fontified t) 1461 1469 (face font-lock-string-face fontified t) 1469 1472 (fontified t) 1472 1480 (face font-lock-builtin-face fontified t) 1480 1483 (fontified t) 1483 1508 (face font-lock-string-face fontified t) 1508 1528 (fontified t) 1528 1535 (face font-lock-builtin-face fontified t) 1535 1567 (fontified t) 1567 1570 (face font-lock-comment-delimiter-face fontified t) 1570 1638 (face font-lock-comment-face fontified t) 1638 1691 (fontified t)) . 5653) (undo-tree-id13 . -682) (undo-tree-id14 . -94) (undo-tree-id15 . -69) (undo-tree-id16 . -564) (undo-tree-id17 . -69) (undo-tree-id18 . -564) (undo-tree-id19 . -430) (undo-tree-id20 . -564) (undo-tree-id21 . -1271) (undo-tree-id22 . -856) (undo-tree-id23 . -438) (undo-tree-id24 . -881) (undo-tree-id25 . -635) (undo-tree-id26 . -596) (undo-tree-id27 . -438) (undo-tree-id28 . -376) (undo-tree-id29 . -1541) (undo-tree-id30 . -234) (undo-tree-id31 . -234) (undo-tree-id32 . -234) (undo-tree-id33 . -234) (undo-tree-id34 . -234) (undo-tree-id35 . -234) (undo-tree-id36 . -234) (undo-tree-id37 . -234) (undo-tree-id38 . -234) (undo-tree-id39 . -953) (undo-tree-id40 . -234) (undo-tree-id41 . -1691) (undo-tree-id42 . -1691) (undo-tree-id43 . -1691) (undo-tree-id44 . -393) (undo-tree-id45 . -1654) (undo-tree-id46 . -1691) (undo-tree-id47 . -1691) (undo-tree-id48 . -1691) (undo-tree-id49 . -1691) (undo-tree-id50 . -1691) (undo-tree-id51 . -1691) (undo-tree-id52 . -1691) 7344 (t 26996 62368 0 0)) ((5653 . 7344) (t 26996 62537 0 0)) (26996 62537 657324 0) 0 nil])
([nil nil ((352 . 355)) nil (26996 63908 591254 0) 0 nil])
nil
nil
([nil current ((340 . 360) (#(":lumen.core.pip" 0 15 (face font-lock-builtin-face fontified t)) . -340) (undo-tree-id0 . -12) (undo-tree-id1 . -15) (undo-tree-id2 . -12) 355) nil (26996 63908 591251 0) 0 nil])
nil
